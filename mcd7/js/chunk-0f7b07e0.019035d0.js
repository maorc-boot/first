(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f7b07e0"],{"1dda":function(e,t,a){"use strict";a("ccee")},"271a":function(e,t,a){"use strict";var i=a("cb2d"),l=a("e330"),r=a("577e"),s=a("d6d6"),n=URLSearchParams,o=n.prototype,c=l(o.getAll),d=l(o.has),p=new n("a=1");!p.has("a",2)&&p.has("a",void 0)||i(o,"has",(function(e){var t=arguments.length,a=t<2?void 0:arguments[1];if(t&&void 0===a)return d(this,e);var i=c(this,e);s(t,1);var l=r(a),n=0;while(n<i.length)if(i[n++]===l)return!0;return!1}),{enumerable:!0,unsafe:!0})},"4ad1":function(e,t,a){},5494:function(e,t,a){"use strict";var i=a("83ab"),l=a("e330"),r=a("edd0"),s=URLSearchParams.prototype,n=l(s.forEach);i&&!("size"in s)&&r(s,"size",{get:function(){var e=0;return n(this,(function(){e++})),e},configurable:!0,enumerable:!0})},"56ba":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l}));const i=[{statusName:"草稿",status:0},{statusName:"审批中",status:1},{statusName:"审批通过",status:2},{statusName:"失效",status:3},{statusName:"审批驳回",status:4},{statusName:"直接使用",status:6}],l=[{label:"图片",value:0},{label:"文字",value:1},{label:"视频",value:2}]},"6d34":function(e,t,a){},"88a7":function(e,t,a){"use strict";var i=a("cb2d"),l=a("e330"),r=a("577e"),s=a("d6d6"),n=URLSearchParams,o=n.prototype,c=l(o.append),d=l(o["delete"]),p=l(o.forEach),u=l([].push),m=new n("a=1&a=2&b=3");m["delete"]("a",1),m["delete"]("b",void 0),m+""!=="a=2"&&i(o,"delete",(function(e){var t=arguments.length,a=t<2?void 0:arguments[1];if(t&&void 0===a)return d(this,e);var i=[];p(this,(function(e,t){u(i,{key:t,value:e})})),s(t,1);var l,n=r(e),o=r(a),m=0,h=0,v=!1,g=i.length;while(m<g)l=i[m++],v||l.key===n?(v=!0,d(this,l.key)):h++;while(h<g)l=i[h++],l.key===n&&l.value===o||c(this,l.key,l.value)}),{enumerable:!0,unsafe:!0})},"98b3":function(e,t,a){"use strict";a("6d34")},"9cb2":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"template-wrap-content"},[t("div",{staticClass:"top-edit-part"},[t("div",{staticClass:"search-input"},[t("label",[e._v("素材名称：")]),t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticStyle:{width:"180px"},attrs:{placeholder:"请输入素材名称",clearable:""},on:{input:e.throttleQueryChange,clear:e.queryChange},model:{value:e.query.materialName,callback:function(t){e.$set(e.query,"materialName","string"===typeof t?t.trim():t)},expression:"query.materialName"}})],1),t("div",{staticClass:"search-input"},[t("label",[e._v("产品名称：")]),t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticStyle:{width:"180px"},attrs:{placeholder:"请输入产品名称/编号",clearable:""},on:{input:e.throttleQueryChange,clear:e.queryChange},model:{value:e.query.planIdOrName,callback:function(t){e.$set(e.query,"planIdOrName","string"===typeof t?t.trim():t)},expression:"query.planIdOrName"}})],1),t("div",{staticClass:"search-input"},[t("label",[e._v("渠道：")]),t("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"请选择渠道",filterable:""},on:{change:e.queryChange},model:{value:e.query.channelId,callback:function(t){e.$set(e.query,"channelId",t)},expression:"query.channelId"}},e._l(e.channels,(function(e){return t("el-option",{key:e.channelId,attrs:{label:e.channelName,value:e.channelId}})})),1)],1),t("div",{staticClass:"search-input"},[t("label",[e._v("素材类型：")]),t("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"请选择"},on:{change:e.queryChange},model:{value:e.query.materialType,callback:function(t){e.$set(e.query,"materialType",t)},expression:"query.materialType"}},[t("el-option",{attrs:{value:"",label:"不限"}}),e._l(e.MATERIAL_TYPE,(function(e){return t("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}))],2)],1),t("div",{staticClass:"search-input"},[t("label",[e._v("状态：")]),t("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"请选择"},on:{change:e.queryChange},model:{value:e.query.materialStatus,callback:function(t){e.$set(e.query,"materialStatus",t)},expression:"query.materialStatus"}},[t("el-option",{attrs:{value:"",label:"不限"}}),e._l(e.APPROVE_STATUS,(function(e){return t("el-option",{key:e.status,attrs:{value:e.status,label:e.statusName}})}))],2)],1),t("div",{staticClass:"search-input"},[t("label",[e._v("日期：")]),t("el-date-picker",{staticStyle:{width:"215px"},attrs:{type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd"},on:{change:e.getDates},model:{value:e.queryTime,callback:function(t){e.queryTime=t},expression:"queryTime"}})],1)]),t("div",{staticClass:"operation"},[t("input",{ref:"uploadLink",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.importFile}}),t("el-button",{attrs:{type:"danger",loading:e.deleteLoading},on:{click:e.deleteDates}},[e._v("批量删除")]),t("el-button",{attrs:{type:"primary"},on:{click:e.downloadTemplate}},[e._v("下载模板")]),t("el-button",{attrs:{type:"primary",loading:e.uploadLoading},on:{click:e.importFile_}},[e._v("批量导入")]),t("el-button",{attrs:{type:"primary"},on:{click:e.exportData}},[e._v("导 出")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showAddEditDialog(null)}}},[e._v("新 增")])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tTable",staticClass:"template-table customTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",height:"100%"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"center",width:"45"}}),t("el-table-column",{attrs:{label:"序号",type:"index","header-align":"center",align:"center",width:"45"}}),t("el-table-column",{attrs:{prop:"materialName",label:"素材名称","header-align":"center",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"materialType",label:"类型",width:"50","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:a}){var i;return[t("span",[e._v(e._s(null===(i=e.MATERIAL_TYPE.find(e=>e.value==a.materialType))||void 0===i?void 0:i.label))])]}}])}),t("el-table-column",{attrs:{prop:"channelName",label:"所属渠道",width:"120","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{prop:"planName",label:"产品名称","header-align":"center",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"positionName",label:"所属运营位","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{prop:"targetUrl",label:"链接","header-align":"center",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.targetUrl?t("el-link",{attrs:{href:a.row.targetUrl,target:"_blank"}},[e._v(e._s(a.row.targetUrl))]):t("span",[e._v("-")])]}}])}),t("el-table-column",{attrs:{prop:"materialStatus",label:"状态","header-align":"center",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function({row:a}){var i;return[t("span",[e._v(e._s(null===(i=e.APPROVE_STATUS.find(e=>e.status==a.materialStatus))||void 0===i?void 0:i.statusName))])]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间","header-align":"center",align:"center",width:"90"}}),t("el-table-column",{attrs:{prop:"invalidDate",label:"失效时间",width:"90","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{label:"操作",width:"155",fixed:"right","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.preview(a.row)}}},[e._v("预览")]),0==a.row.materialStatus?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.openSubmitDialog(a.row)}}},[e._v("提交")]):e._e(),0==a.row.materialStatus||3==a.row.materialStatus||4==a.row.materialStatus?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.showAddEditDialog(a.row)}}},[e._v("修改")]):e._e(),0==a.row.materialStatus||3==a.row.materialStatus||4==a.row.materialStatus||6==a.row.materialStatus?t("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(t){return e.deleteRow(a.row.materialId)}}},[e._v("删除")]):e._e()]}}])})],1),t("el-pagination",{attrs:{"current-page":e.query.current,"page-sizes":[10,20,30,40],"page-size":e.query.size,"pager-count":5,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e.addEditDialog?t("el-dialog",{attrs:{title:e.addEditDialogTitle,visible:e.addEditDialog,width:"1000px",top:"8vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.addEditDialog=t}}},[t("AddEditForm",{ref:"addEditForm",attrs:{currentRow:e.currentRow}}),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addEditDialog=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:e.saveMaterial}},[e._v("保存")])],1)],1):e._e(),e.submitDialog?t("el-dialog",{attrs:{title:"选择审批人",visible:e.submitDialog,width:"400px","close-on-click-modal":!1},on:{"update:visible":function(t){e.submitDialog=t}}},[t("div",{staticClass:"approve-content"},[t("span",[e._v("审批人：")]),t("el-select",{on:{change:e.chooseApprover},model:{value:e.approverId,callback:function(t){e.approverId=t},expression:"approverId"}},e._l(e.approverList,(function(e){return t("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})})),1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.submitDialog=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:e.submit}},[e._v("提交")])],1)]):e._e()],1)},l=[],r=(a("88a7"),a("271a"),a("5494"),a("14d9"),a("0fea")),s=a("d212"),n=a("31b1"),o=a("f9ae"),c=a("56ba"),d=function(){var e,t=this,a=t._self._c;return a("div",[a("el-form",{ref:"form",attrs:{inline:!0,model:t.form,rules:t.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"素材名称：",prop:"materialName"}},[a("el-input",{attrs:{placeholder:"请输入素材名称"},model:{value:t.form.materialName,callback:function(e){t.$set(t.form,"materialName",e)},expression:"form.materialName"}})],1),a("el-form-item",{attrs:{label:"所属渠道：",prop:"channelId"}},[a("el-select",{attrs:{placeholder:"请选择渠道",filterable:""},on:{change:t.getAdivList},model:{value:t.form.channelId,callback:function(e){t.$set(t.form,"channelId",e)},expression:"form.channelId"}},t._l(t.channels,(function(e){return a("el-option",{key:e.channelId,attrs:{label:e.channelName,value:e.channelId}})})),1)],1),a("el-form-item",{attrs:{label:"所属运营位：",prop:"positionId"}},[a("el-select",{attrs:{placeholder:"请选择运营位",disabled:!t.form.channelId},on:{change:t.getSize},model:{value:t.form.positionId,callback:function(e){t.$set(t.form,"positionId",e)},expression:"form.positionId"}},t._l(t.adivList,(function(e){return a("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),a("el-form-item",{attrs:{label:"运营位尺寸：",prop:"materialPicSize"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.form.materialPicSize,callback:function(e){t.$set(t.form,"materialPicSize",e)},expression:"form.materialPicSize"}})],1),"968"!=t.form.channelId?a("el-form-item",{attrs:{label:"产品名称：",prop:"planName"}},[a("el-input",{attrs:{placeholder:"请选择产品"},on:{focus:t.showPlanDialog},model:{value:t.form.planName,callback:function(e){t.$set(t.form,"planName",e)},expression:"form.planName"}})],1):t._e(),"968"!=t.form.channelId?a("el-form-item",{attrs:{label:"素材失效时间：",prop:"invalidDate"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"请选择日期（年月日）",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.form.invalidDate,callback:function(e){t.$set(t.form,"invalidDate",e)},expression:"form.invalidDate"}})],1):t._e(),a("el-form-item",{staticClass:"el-form-item-row",attrs:{label:"类型：",prop:"materialType"}},[a("el-radio-group",{model:{value:t.form.materialType,callback:function(e){t.$set(t.form,"materialType",e)},expression:"form.materialType"}},t._l(t.MATERIAL_TYPE,(function(e){return a("el-radio",{attrs:{label:e.value}},[t._v(t._s(e.label))])})),1),a("input",{ref:"uploadRef",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:t.getFile}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==t.form.materialType,expression:"form.materialType == 0"}],staticClass:"el-form-item-row",attrs:{label:"图片：",prop:"pic"}},[a("div",{staticClass:"img-content"},[a("el-button",{attrs:{type:"primary",loading:t.uploadLoading},on:{click:t.upload}},[t._v("上传"),a("i",{staticClass:"el-icon-upload el-icon--right"})]),t.picUrl?a("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{fit:"contain",src:t.picUrl,"preview-src-list":[t.picUrl]}}):t._e(),t.picUrl?a("i",{staticClass:"el-icon-close",staticStyle:{color:"red"},on:{click:t.clearFile}}):a("span",{staticStyle:{"margin-left":"10px"}},[t._v("(最大5M)")]),t.fileLoading?a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.fileLoading,expression:"fileLoading"}],staticClass:"loading",attrs:{"element-loading-text":"资源加载中","element-loading-spinner":"el-icon-loading"}}):t._e()],1)]),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==t.form.materialType,expression:"form.materialType == 1"}],staticClass:"el-form-item-row",attrs:{label:"营销话术：",prop:"content"}},[a("el-input",{staticStyle:{"min-width":"30vw"},attrs:{type:"textarea",rows:1},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==t.form.materialType,expression:"form.materialType == 2"}],staticClass:"el-form-item-row",attrs:{label:"视频：",prop:"video"}},[a("div",{staticClass:"img-content"},[a("el-button",{attrs:{type:"primary",loading:t.uploadLoading},on:{click:t.upload}},[t._v("上传"),a("i",{staticClass:"el-icon-upload el-icon--right"})]),2==(null===(e=t.form)||void 0===e?void 0:e.materialType)&&t.showProgress?[a("el-progress",{staticClass:"upload-progress",attrs:{percentage:t.progress,"stroke-width":2,status:t.uploadStatus,"text-inside":""}}),a("span",[t._v(t._s(t.progress+"%"))])]:t._e(),t.videoUrl?a("video",{attrs:{id:"video",src:t.videoUrl,controls:""}}):t._e(),t.videoUrl?a("i",{staticClass:"el-icon-close",staticStyle:{color:"red"},on:{click:t.clearFile}}):t._e(),t.fileLoading?a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.fileLoading,expression:"fileLoading"}],staticClass:"loading",attrs:{"element-loading-text":"资源加载中","element-loading-spinner":"el-icon-loading"}}):t._e()],2)]),void 0,a("el-form-item",{staticClass:"el-form-item-row",attrs:{label:"链接：",prop:"targetUrl"}},[a("div",{staticClass:"url-content"},[a("el-input",{model:{value:t.form.targetUrl,callback:function(e){t.$set(t.form,"targetUrl",e)},expression:"form.targetUrl"}}),"968"!=t.form.channelId?a("el-button",{attrs:{type:"text",disabled:!t.form.planId},on:{click:function(e){t.linkVisible=!0}}},[t._v("链接库")]):t._e()],1)]),a("el-form-item",{staticClass:"el-form-item-row",attrs:{label:"描述：",prop:"description"}},[a("el-input",{staticStyle:{"min-width":"30vw"},attrs:{type:"textarea",maxlength:"40","show-word-limit":"",rows:3},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],2),t.planVisible?a("el-dialog",{attrs:{title:t.planTitle,visible:t.planVisible,"close-on-click-modal":!1,"append-to-body":"",top:"6vh",width:"75%"},on:{"update:visible":function(e){t.planVisible=e}}},[a("PlanTable",{attrs:{currentProduct:t.currentProduct},on:{select:t.selectProduct}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.planVisible=!1}}},[t._v("确定")])],1)],1):t._e(),a("el-dialog",{attrs:{title:"链接库",visible:t.linkVisible,"close-on-click-modal":!1,"append-to-body":"",top:"6vh",width:"75%"},on:{"update:visible":function(e){t.linkVisible=e}}},[t.linkVisible?a("LinkLib",{attrs:{planId:t.form.planId,url:t.form.targetUrl},on:{selectLink:t.selectLink}}):t._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.linkVisible=!1}}},[t._v("确定")])],1)],1)],1)},p=[],u=(a("d9e2"),a("7b5c")),m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"template-wrap-content"},[t("div",{staticClass:"top-edit-part"},[t("div",{staticClass:"search-input"},[t("label",[e._v("链接编号：")]),t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticStyle:{width:"150px"},attrs:{placeholder:"请输入链接编号",clearable:""},model:{value:e.query_.linkId,callback:function(t){e.$set(e.query_,"linkId","string"===typeof t?t.trim():t)},expression:"query_.linkId"}})],1),t("div",{staticClass:"search-input"},[t("label",[e._v("链接名称：")]),t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticStyle:{width:"150px"},attrs:{placeholder:"请输入链接名称",clearable:""},model:{value:e.query_.linkName,callback:function(t){e.$set(e.query_,"linkName","string"===typeof t?t.trim():t)},expression:"query_.linkName"}})],1),t("div",{staticClass:"search-input"},[t("label",[e._v("链接地址：")]),t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticStyle:{width:"150px"},attrs:{placeholder:"请输入链接地址",clearable:""},model:{value:e.query_.linkUrl,callback:function(t){e.$set(e.query_,"linkUrl","string"===typeof t?t.trim():t)},expression:"query_.linkUrl"}})],1),t("div",{staticClass:"search-input"},[t("label",[e._v("创建人：")]),t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticStyle:{width:"150px"},attrs:{placeholder:"请输入创建人",clearable:""},model:{value:e.query_.linkCreator,callback:function(t){e.$set(e.query_,"linkCreator","string"===typeof t?t.trim():t)},expression:"query_.linkCreator"}})],1),t("div",{staticClass:"search-input"},[t("label",[e._v("创建时间：")]),t("el-date-picker",{staticStyle:{width:"250px"},attrs:{type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd"},on:{change:e.getDates},model:{value:e.queryTime,callback:function(t){e.queryTime=t},expression:"queryTime"}})],1),t("div",[t("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.searchData}},[e._v("查询")]),t("el-button",{attrs:{type:"success"},on:{click:e.reset}},[e._v("重置")])],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tTable",staticClass:"template-table customTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",height:"100%"}},[t("el-table-column",{attrs:{label:"序号",type:"index","header-align":"center",align:"center",width:"60"}}),t("el-table-column",{attrs:{prop:"id",label:"链接编号",width:"140","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{prop:"name",label:"链接名称",width:"150","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{prop:"url",label:"链接地址",width:"200","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{prop:"description",label:"说明",width:"150","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{prop:"planId",label:"关联产品ID",width:"150","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{prop:"planName",label:"关联产品名称",width:"150","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{prop:"campSize",label:"关联活动","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{prop:"creator",label:"创建人","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{prop:"createDate",label:"创建时间",width:"90","header-align":"center",align:"center"}}),t("el-table-column",{attrs:{label:"操作",width:"90",fixed:"right","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.url!=e.url?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.selectLink(a.row.url)}}},[e._v("选择")]):t("span",{staticStyle:{color:"#ccc"}},[e._v("选择")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.query.pageNum,"page-sizes":[10,20,30,40],"page-size":e.query.pageSize,"pager-count":5,layout:"total, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},h=[],v=a("aa39"),g={props:["url","planId"],data(){return{loading:!1,query:{planId:this.planId||void 0,aswitch:"1",linkId:"",linkName:"",linkUrl:"",linkCreator:"",createDateS:"",createDateE:"",pageNum:1,pageSize:10},query_:{linkId:"",linkName:"",linkUrl:"",linkCreator:"",createDateS:"",createDateE:""},queryTime:null,total:0,tableData:[]}},methods:{searchData(){this.query.pageNum=1,this.query={...this.query,...this.query_},this.getTableData()},async getTableData(){try{this.loading=!0;const{data:e}=await Object(r["i"])(v["a"].linkLib.searchAllLink,this.query);this.tableData=e.list,this.total=e.totalSize}catch(e){}finally{this.loading=!1}},getDates(){this.queryTime?(this.query_.createDateS=this.queryTime[0],this.query_.createDateE=this.queryTime[1]):(this.query_.createDateS="",this.query_.createDateE="")},reset(){this.queryTime=null,this.query_.linkId="",this.query_.linkName="",this.query_.linkUrl="",this.query_.linkCreator="",this.query_.createDateS="",this.query_.createDateE="",this.query={...this.query,...this.query_},this.getTableData()},handleSizeChange(e){this.query.pageNum=1,this.query.pageSize=e,this.getTableData()},handleCurrentChange(e){this.query.pageNum=e,this.getTableData()},selectLink(e){this.$emit("selectLink",e)}},mounted(){this.getTableData()}},f=g,y=(a("1dda"),a("2877")),b=Object(y["a"])(f,m,h,!1,null,"b3793cda",null),w=b.exports,k={props:{currentRow:{type:Object,default:()=>({})}},components:{PlanTable:u["a"],LinkLib:w},data(){return{MATERIAL_TYPE:c["b"],form:{materialId:"",materialStatus:0,onlineStatus:0,excellence:0,materialName:"",planId:"",planName:"",channelId:"",positionId:"",materialPicSize:"",invalidDate:"",materialType:0,resourceName:"",resourceUrl:"",pic:"",video:"",content:"",targetUrl:"",visitUrl:"",description:""},rules:{materialName:[{required:!0,message:"请输入名称",trigger:"blur"}],planName:[{required:!0,message:"请输入产品名称",trigger:"change"}],channelId:[{required:!0,message:"请选择渠道",trigger:"change"}],positionId:[{required:!0,message:"请选择运营位"}],materialPicSize:[{required:!0,message:"请选择运营尺寸",trigger:"blur"}],invalidDate:[{required:!0,message:"请选择素材失效日期"}],materialType:[{required:!0,message:"请选择类型",trigger:"change"}],pic:[{required:!0,validator:this.validatePic}],video:[{required:!0,validator:this.validateVideo}],content:[{required:!0,validator:this.validateText,trigger:"blur"}],targetUrl:[{required:this.targetUrlRequired,message:"请输入链接",trigger:"blur"}]},channels:[],adivList:[],planVisible:!1,planTitle:"",currentProduct:{},linkVisible:!1,picUrl:"",videoUrl:"",uploadLoading:!1,showProgress:!1,progress:0,uploadStatus:null,fileLoading:!1}},computed:{targetUrlRequired(){return"968"!=this.form.channelId}},methods:{validatePic(e,t,a){0!=this.form.materialType||this.picUrl?a():a(new Error("请上传图片"))},validateText(e,t,a){""===t&&1==this.form.materialType?a(new Error("请输入营销话术")):a()},validateVideo(e,t,a){2!=this.form.materialType||this.videoUrl?a():a(new Error("请上传视频"))},async getMaterialDetail(){this.form={...this.form,...Object(o["d"])(this.currentRow)};try{const{adivInfoList:e}=await Object(r["i"])(s["a"].effectAppraisal.queryPosition,{channelId:this.form.channelId});this.adivList=e}catch{}if(this.form.resourceUrl)try{this.fileLoading=!0;const{data:e}=await Object(r["b"])(s["a"].effectAppraisal.loadImage,{materialId:this.form.materialId}),t=new Blob([e],{type:e.type});let a=URL.createObjectURL(t);0==this.form.materialType?this.picUrl=a:2==this.form.materialType&&(this.videoUrl=a)}catch(e){this.picUrl="",this.videoUrl=""}finally{this.fileLoading=!1}},async getChannels(){try{const{channelNameAndIdList:e}=await Object(r["i"])(s["a"].effectAppraisal.queryChannel);this.channels=e}catch(e){}},async getAdivList(){this.adivList=[],this.form.positionId="",this.form.materialPicSize="";try{const{adivInfoList:e}=await Object(r["i"])(s["a"].effectAppraisal.queryPosition,{channelId:this.form.channelId});this.adivList=e}catch(e){}},getSize(e){let t=this.adivList.find(t=>t.adivId===e);this.form.materialPicSize=t?t.adivSize:"",this.form.materialPicSize||(this.form.materialPicSize="无")},showPlanDialog(){this.form.planId?(this.planTitle="当前产品名称："+this.form.planName,this.currentProduct={planId:this.form.planId,planName:this.form.planName}):(this.planTitle="请选择产品",this.currentProduct={}),this.planVisible=!0},selectProduct(e){this.currentProduct=e,this.planTitle="当前产品："+e.planName,this.form.planId=e.planId,this.form.planName=e.planName},getFile({target:e}){let t=e.files[0],a=URL.createObjectURL(t);if(0==this.form.materialType){if(this.form.materialPicSize.includes("×")||this.form.materialPicSize.includes("*")){let e=new Image,i=this.form.materialPicSize;i.includes("*")&&(i=i.replace("*","×"));let l=i.split("×")[0].trim(),r=i.split("×")[1].trim();return e.src=a,void(e.onload=()=>{if(e.width!=l||e.height!=r){this.picUrl="",this.$refs["uploadRef"].value=null;let t=`您上传的图片尺寸与运营位尺寸不一致!</br>\n\t\t\t\t\t\t\t\t运营位尺寸: <span style="color: #67C23A">${i}</span></br>\n\t\t\t\t\t\t\t\t您上传图片尺寸: <span style="color: red">${e.width+"×"+e.height}</span>`;this.$refs["uploadRef"].value=null,this.$alert(t,"提示",{confirmButtonText:"确定",type:"warning",customClass:"errorPrompt",dangerouslyUseHTMLString:!0})}else this.uploadPic(t,a)})}if(!/image\/\w+/.test(t.type))return this.$refs["uploadRef"].value=null,void this.$alert("请上传 gif, jpeg, jpg, png 类型的图片!","提示",{confirmButtonText:"确定",type:"warning",customClass:"errorPrompt"});if(t.size>5243904)return this.$refs["uploadRef"].value=null,void this.$alert("图片大小最大不能超过5M!","提示",{confirmButtonText:"确定",type:"warning",customClass:"errorPrompt"});this.uploadPic(t,a)}else{let e=["mp4","avi","rmvb","rm","flv","3gp"];if(!e.includes(t.name.substring(t.name.lastIndexOf(".")+1))&&!/video\/\w+/.test(t.type))return this.$refs["uploadRef"].value=null,void this.$alert("请上传视频文件格式的文件!","提示",{confirmButtonText:"确定",type:"warning",customClass:"errorPrompt"});this.uploadVideo(t,a)}},async uploadPic(e,t){this.uploadLoading=!0;try{let a=new FormData;a.append("file",e);const{resourceUrl:i,resourceName:l}=await Object(r["j"])(s["a"].effectAppraisal.uploadMaterialPicture,a);this.form.pic=i,this.$message.success("图片上传成功"),this.picUrl=t,this.form.resourceName=l}catch(a){this.picUrl=""}finally{this.uploadLoading=!1}},async uploadVideo(e,t){this.uploadLoading=!0,this.showProgress=!0,this.progress=0,this.uploadStatus=null;try{let a=new FormData;a.append("file",e);const{resourceUrl:i,resourceName:l}=await Object(r["j"])(s["a"].effectAppraisal.uploadMaterialVideo,a,this.uploadProgressEvent);this.form.video=i,this.form.resourceName=l,this.$message.success("视频上传成功"),this.videoUrl=t,this.showProgress=!1}catch(a){this.videoUrl="",this.uploadStatus="exception",setTimeout(()=>{this.showProgress=!1},1e3)}finally{this.uploadLoading=!1}},upload(){if(0==this.form.materialType&&!this.form.materialPicSize)return this.$alert("请先选择运营位尺寸!","提示",{confirmButtonText:"确定",type:"warning",customClass:"errorPrompt"});this.$refs["uploadRef"].value=null,this.$refs["uploadRef"].click()},clearFile(){0==this.form.materialType?this.picUrl="":this.videoUrl=""},uploadProgressEvent(e){this.progress=Math.floor(100*e.loaded/e.total)},selectLink(e){this.form.targetUrl=e},async confirm(){return"968"===this.form.channelId&&this.form.targetUrl&&!Object(o["e"])(this.form.targetUrl)?(this.$message.error("请输入正确的链接格式！"),Promise.reject(!1)):new Promise((e,t)=>{this.$refs["form"].validate(a=>{if(!a)return t(!1);let i={...this.form};return i.resourceName=this.form.attachmentName,this.currentRow.materialId||(i.visitUrl=i.targetUrl,0==i.materialType&&(i.resourceUrl=i.pic),2==i.materialType&&(i.resourceUrl=i.video)),"无"==this.form.materialPicSize&&(this.copyForm.materialPicSize=""),delete i.pic,delete i.video,e(i)})})}},mounted(){this.getChannels(),this.currentRow.materialId&&this.getMaterialDetail()}},q=k,I=(a("98b3"),Object(y["a"])(q,d,p,!1,null,"28f1ca84",null)),D=I.exports,T={name:"MaterialManage",components:{AddEditForm:D},data(){return{APPROVE_STATUS:c["a"],MATERIAL_TYPE:c["b"],loading:!1,uploadLoading:!1,saveLoading:!1,deleteLoading:!1,query:{materialName:"",materialType:"",planIdOrName:"",channelId:"",materialStatus:"",startDate:"",endDate:"",current:1,size:10},queryTime:null,channels:[],total:0,tableData:[],multipleSelection:[],currentRow:{},addEditDialog:!1,addEditDialogTitle:"",submitDialog:!1,approverList:[],berv:"",processId:"",nodeId:"",nextNodesApprover:null,approverId:""}},watch:{submitDialog(e){!e&&(this.approverId="")}},methods:{async getChannels(){try{const{channelNameAndIdList:e}=await Object(r["i"])(s["a"].effectAppraisal.queryChannel);this.channels=e,this.channels.unshift({channelId:"",channelName:"不限"})}catch(e){this.channels.unshift({channelId:"",channelName:"不限"})}},async getTableData(){try{this.loading=!0,this.tableData=[];const{records:e,total:t}=await Object(r["i"])(s["a"].effectAppraisal.queryMaterialPageList,this.query);this.tableData=e,this.total=t,this.$forceUpdate()}catch(e){}finally{this.loading=!1}},getDates(){this.queryTime?(this.query.startDate=this.queryTime[0],this.query.endDate=this.queryTime[1]):(this.query.startDate="",this.query.endDate=""),this.query.current=1,this.getTableData()},queryChange(){this.query.current=1,this.getTableData()},throttleQueryChange:Object(o["a"])((function(){this.queryChange()})),deleteDates(){0!==this.multipleSelection.length?this.$confirm("此操作将永久删除选择的素材, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{this.deleteLoading=!0;const e=this.multipleSelection.map(e=>e.materialId);try{await Object(r["i"])(s["a"].effectAppraisal.batchDeleteMaterial,{materialIds:e});this.$message.success("删除成功"),this.getTableData()}catch(t){}finally{this.deleteLoading=!1}}).catch(()=>{this.$message.info("已取消删除")}):this.$message.warning("请选择要删除的数据")},downloadTemplate(){Object(r["b"])(s["a"].effectAppraisal.materialImportTemplateDownload).then(({data:e})=>{const t=new Blob([e],{type:e.type}),a="素材模板.xls",i=document.createElement("a");i.download=a,i.style.display="none",i.href=URL.createObjectURL(t),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i)})},importFile_(){this.$refs.uploadLink.files.length>0&&(this.$refs.uploadLink.value=null),this.$refs.uploadLink.click()},importFile(e){let t=e.target.files[0];if(!t)return;let a=new FormData;a.append("uploadMaterialsFile",t),this.uploadLoading=!0,Object(r["j"])(s["a"].effectAppraisal.uploadMaterialsFile,a).then(e=>{this.uploadLoading=!1,!1!==e.data?(this.$message({message:"导入成功",type:"success"}),this.getTableData()):this.$message.error("导入失败")}).catch(e=>{this.uploadLoading=!1})},async exportData(){try{const e=await Object(r["b"])(s["a"].effectAppraisal.exportMaterialsFile,this.query),t=new Blob([e.data],{type:e.type}),a="素材.xls",i=document.createElement("a");i.download=a,i.style.display="none",i.href=URL.createObjectURL(t),document.body.appendChild(i),i.click(),URL.revokeObjectURL(i.href),document.body.removeChild(i)}catch(e){this.$message.error("导出失败")}},handleSizeChange(e){this.query.current=1,this.query.size=e,this.getTableData()},handleCurrentChange(e){this.query.current=e,this.getTableData()},handleSelectionChange(e){this.multipleSelection=e},deleteRow(e){this.$confirm("此操作将永久删除该素材, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await Object(r["i"])(s["a"].effectAppraisal.deleteMaterial,{materialId:e});this.$message({message:"删除成功",type:"success"}),this.getTableData()}catch(t){}}).catch(()=>{})},preview(e){this.$router.push({path:"/ProductPolicy/materialDetail",query:{materialId:e.materialId}})},async openSubmitDialog(e){this.submitDialog=!0,this.currentRow=e;try{const{processId:e,berv:t}=await Object(r["i"])(n["a"].channel.getTemplateData+"?systemId=MATERIAL");this.berv=t,this.processId=e;const{nextNodesApprover:a,nodeId:i}=await Object(r["i"])(n["a"].channel.getNextApprovers,{processId:e,berv:t,nodeId:"",triggerParm:{channelId:this.currentRow.channelId}});this.nodeId=i,this.nextNodesApprover=a,this.approverList=a[0].approverUser}catch(t){}},chooseApprover(e){this.$set(this.nextNodesApprover[0],"approverUser",this.nextNodesApprover[0].approverUser.filter(t=>t.userId==e))},async submit(){if(""!==this.approverId){this.saveLoading=!0;try{await Object(r["i"])(n["a"].channel.subMaterialApprove,{berv:this.berv,processId:this.processId,nodeId:this.nodeId,businessId:this.currentRow.materialId,approvalType:"MATERIAL",channelId:this.currentRow.channelId,nextNodesApprover:this.nextNodesApprover});this.$message({message:"提交成功",type:"success"}),this.submitDialog=!1,this.getTableData()}catch(e){}finally{this.saveLoading=!1}}else this.$message({message:"请选择审批人",type:"warning"})},showAddEditDialog(e){this.addEditDialog=!0,this.currentRow=e||{},this.addEditDialogTitle=e?"编辑素材: "+e.materialName:"新增素材"},async saveMaterial(){this.saveLoading=!0;try{const e=await this.$refs["addEditForm"].confirm(),t=await Object(r["i"])(s["a"].effectAppraisal.saveOrUpdateMaterial,e);this.addEditDialog=!1,this.$message({message:t.message,type:"success"}),this.getTableData()}catch{}finally{this.saveLoading=!1}}},mounted(){this.getChannels(),this.getTableData()}},x=T,C=(a("cc85"),Object(y["a"])(x,i,l,!1,null,"a0de10a8",null));t["default"]=C.exports},aa39:function(e,t,a){"use strict";const i="/plan-svc/action";t["a"]={productLib:{},linkLib:{downloadLinkTemplate:i+"/link/linkManage/downloadLinkTemplate",getLinkId:i+"/link/linkManage/getLinkId",getShortUrl:i+"/link/linkManage/getShortUrl",saveOrUpdateLink:i+"/link/linkManage/saveOrUpdateLink",searchAllLink:i+"/link/linkManage/searchAllLink",searchCampsByUrl:i+"/link/linkManage/searchCampsByUrl",uploadBatchLinkFiles:i+"/link/linkManage/uploadBatchLinkFiles",deleteLink:i+"/link/linkManage/deleteLink"}}},cc85:function(e,t,a){"use strict";a("4ad1")},ccee:function(e,t,a){},d212:function(e,t,a){"use strict";const i="/mcd-eval/action",l="/plan-svc/api",r="/element-svc/api";t["a"]={effectAppraisal:{queryActServiceTypeInfo:i+"/effectEvaluate/activity/queryActServiceTypeInfo.do",queryUserCityInfo:i+"/effectEvaluate/activity/queryUserCityInfo.do",queryChannelInfo:i+"/effectEvaluate/activity/queryChannelInfo.do",queryPlanTypeInfo:i+"/effectEvaluate/activity/queryPlanTypeInfo.do",queryActServiceTypeIndicatorInfo:i+"/effectEvaluate/activity/queryActServiceTypeIndicatorInfo.do",saveViewIndicatorInfo:i+"/effectEvaluate/activity/saveViewIndicatorInfo.do",listCampInfo:i+"/effectEvaluate/activity/listCampInfo.do",listPlanInfo:i+"/effectEvaluate/product/listPlanInfo.do",channelOrSceneAppraise:i+"/appraisal/channelOrSceneAppraise.do",pagelist:l+"/singleUser/pagelist",queryPage:"/eval-svc/eval5g/queryPage",export:"/eval-svc/eval5g/export",queryPageCloud:"/eval-svc/eval/5gcloud/queryPage",export5gCloudEvalListData:"/eval-svc/eval/5gcloud/export5gCloudEvalListData",exportIvr:"/eval-svc/reportIvr/export",queryPageIvr:"/eval-svc/reportIvr/queryPage",querySystemUsageCityList:l+"/action/systemUsage/querySystemUsageCityList",querySystemUsageDeptList:l+"/action/systemUsage/querySystemUsageDeptList",querySystemUsagePersonageList:l+"/action/systemUsage/querySystemUsagePersonageList",getUsageCityDetailList:l+"/action/systemUsage/getUsageCityDetailList",getUsageDeptDetailList:l+"/action/systemUsage/getUsageDeptDetailList",getUsagePersonageDetailList:l+"/action/systemUsage/getUsagePersonageDetailList",exportReport:"/eval-svc/report/export",queryPageReport:"/eval-svc/report/queryPage",batchDeleteMaterial:r+"/mcdDimMaterial/jx/batchDeleteMaterial",deleteMaterial:r+"/mcdDimMaterial/jx/deleteMaterial",getIntelligentMatchingMaterialList:r+"/mcdDimMaterial/jx/getIntelligentMatchingMaterialList",getMaterial:r+"/mcdDimMaterial/jx/getMaterial",loadImage:r+"/mcdDimMaterial/jx/loadImage",materialImportTemplateDownload:r+"/mcdDimMaterial/jx/materialImportTemplateDownload",queryChannel:r+"/mcdDimMaterial/jx/queryChannel",queryContact:r+"/mcdDimMaterial/jx/queryContact",queryMaterialPageList:r+"/mcdDimMaterial/jx/queryMaterialPageList",queryPosition:r+"/mcdDimMaterial/jx/queryPosition",removeMaterialById:r+"/mcdDimMaterial/jx/removeMaterialById",saveOrUpdateMaterial:r+"/mcdDimMaterial/jx/saveOrUpdateMaterial",updateMaterialStatus:r+"/mcdDimMaterial/jx/updateMaterialStatus",uploadMaterialPicture:r+"/mcdDimMaterial/jx/uploadMaterialPicture",uploadMaterialsFile:r+"/mcdDimMaterial/jx/uploadMaterialsFile",uploadMaterialVideo:r+"/mcdDimMaterial/jx/uploadMaterialVideo",exportMaterialsFile:r+"/mcdDimMaterial/jx/exportMaterialsFile",queryChart:"/eval-svc/home/eval/queryChart",monthEffect:"/eval-svc/home/eval/month/effect",dayEffect:"/eval-svc/home/eval/day/effect",getTacticsListByCityId:"/eval-svc/home/eval/getTacticsListByCityId",queryChannelRadarMap:"/eval-svc/eval/queryChannelRadarMap",queryMonitor:"/plan-svc/api/monitor/queryMonitor",getCaliberInfo:"/plan-svc/api/kpi/getCaliberInfo",updateCaliberInfo:"/plan-svc/api/kpi/updateCaliberInfo",queryChannelEval:"/eval-svc/evaluate/channel/jx/list",exportChannelEval:"/eval-svc/evaluate/channel/jx/exportChannelEval",campEval:"/eval-svc/eval/campEval",exportActivityEval:"/eval-svc/eval/export",exportEffectEval:"/eval-svc/effect/eval/exportEffectEval",getDetailByDrillDownType:"/eval-svc/effect/eval/getDetailByDrillDownType",queryEffectEvalAllCount:"/eval-svc/effect/eval/queryEffectEvalAllCount",gridExport:"/eval-svc/smart/grid/eval/export",gridEval:"/eval-svc/smart/grid/eval/gridEval",exportSmsSendHistory:"/plan-svc/mcd/sms/send/exportSmsSendHistory",querySmsSendHistory:"/plan-svc/mcd/sms/send/querySmsSendHistory",querySmsSendMonitory:"/plan-svc/mcd/sms/send/querySmsSendMonitory",smsSendHistoryTask:"/plan-svc/mcd/sms/send/smsSendHistoryTask",smsSendMonitorTask:"/plan-svc/mcd/sms/send/smsSendMonitorTask",smsSendTaskPause:"/plan-svc/mcd/sms/send/smsSendTaskPause",queryTask:"/plan-svc/mcd-camp-import-task/queryTask",batchImportCamp:"/plan-svc/mcd-camp-import-task/batchImportCamp",successRate:"/eval-svc/eval/home/successRate",sucess:"/eval-svc/eval/home/sucess",total:"/eval-svc/eval/home/total",dw88Camp:"/eval-svc/mcd/onlinel/report/dw88Camp",dwHeigh88City:"/eval-svc/mcd/onlinel/report/dwHeigh88City",getDateTime:"/eval-svc/mcd/onlinel/report/getDateTime",onlineReportDataExport:"/eval-svc/mcd/onlinel/report/onlineReportDataExport",stCamp85CityDm:"/eval-svc/mcd/onlinel/report/stCamp85CityDm",stCamp85HdDm:"/eval-svc/mcd/onlinel/report/stCamp85HdDm",stCamp86CityDm:"/eval-svc/mcd/onlinel/report/stCamp86CityDm",stCamp86HdDm:"/eval-svc/mcd/onlinel/report/stCamp86HdDm",qryTermEval:"/mkt-term-svc/api/qryTermEval"}}},d6d6:function(e,t,a){"use strict";var i=TypeError;e.exports=function(e,t){if(e<t)throw new i("Not enough arguments");return e}},edd0:function(e,t,a){"use strict";var i=a("13d2"),l=a("9bf2");e.exports=function(e,t,a){return a.get&&i(a.get,t,{getter:!0}),a.set&&i(a.set,t,{setter:!0}),l.f(e,t,a)}}}]);