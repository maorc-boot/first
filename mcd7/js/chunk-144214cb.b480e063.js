(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-144214cb"],{"0d30":function(e,a,t){"use strict";t("49eb")},"49eb":function(e,a,t){},f6dc:function(e,a,t){"use strict";t.r(a);var l=function(){var e=this,a=e._self._c;e._self._setupProxy;return a("el-dialog",{ref:"addMarketingRef",attrs:{visible:e.visible,title:"添加策略",width:"800px",top:"10vh","append-to-body":"","close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(a){e.visible=a}}},[a("main",{staticClass:"add-marketing"},[a("div",{staticClass:"add-marketing__keyword"},[a("div",{staticClass:"add-marketing__keyword__title"},[e._v("策略编码或名称：")]),a("el-input",{staticClass:"input-search",staticStyle:{width:"40%"},attrs:{placeholder:"请输入策略编号或名称"},model:{value:e.queryForm.keyWords,callback:function(a){e.$set(e.queryForm,"keyWords","string"===typeof a?a.trim():a)},expression:"queryForm.keyWords"}},[a("i",{staticClass:"el-input__icon el-icon-search cursor-pointer",attrs:{slot:"suffix"},on:{click:function(a){return e.getTableData()}},slot:"suffix"})])],1),a("div",{staticClass:"add-marketing__form"},[a("query-form-cell",{attrs:{list:e.QueryFormCell,"default-size-form":e.sizeForm},on:{queryForm:e.QuerySelect}})],1),a("div",{staticClass:"add-marketing__table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-key":"campsegId",height:"320px"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"序号",width:"60",type:"index"}}),a("el-table-column",{attrs:{prop:"nameAndCode",label:"策略编码及名称","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"validityPeriod",label:"执行周期",width:"180"}}),a("el-table-column",{attrs:{prop:"campsegStatName",label:"策略状态",width:"80"}})],1),a("div",{staticClass:"pager"},[a("el-pagination",{attrs:{"current-page":e.pageData.currentPage,"page-sizes":e.pageData.pageSizeList,"page-size":e.pageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pageData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),a("div",{staticClass:"add-marketing__footer"},[a("el-button",{attrs:{type:"primary",loading:e.checkLoading},on:{click:e.addMarketing}},[e._v("添加")])],1)])])},n=[],i=t("2b0e"),r=t("4e3f"),o=t("0fea"),s=t("4ddc");function c(e){const a=Object(i["ref"])([]),t=Object(i["ref"])(!1),l=Object(i["ref"])([]),n=Object(i["ref"])({currentPage:1,pageSize:10,pageSizeList:[10,20,30,40],total:0}),r=window.sessionStorage.getItem("userId");function c(){t.value=!0,Object(o["i"])("/preview-svc-group/api/fivePeriod/preview/queryCampsegList",{...e.value,userId:r,current:n.value.currentPage,size:n.value.pageSize}).then(e=>{a.value=e.records.map(e=>({...e,validityPeriod:Object(s["f"])(e.startDate,e.endDate),nameAndCode:Object(s["c"])(e.campsegId,e.campsegName)})),n.value.total=e.total}).finally(()=>{t.value=!1})}function d(e){l.value=e}function u(e){n.value.pageSize=e,c()}function g(e){n.value.currentPage=e,c()}return{tableData:a,tableLoading:t,multipleSelection:l,pageData:n,getTableData:c,handleSelectionChange:d,handleSizeChange:u,handleCurrentChange:g}}var d=t("5c96"),u=Object(i["defineComponent"])({name:"AddMarketing",components:{QueryFormCell:r["a"]},props:{currData:{type:Array,default:()=>[]}},setup(e,{emit:a}){const t=Object(i["ref"])(!1),l=Object(i["ref"])(null),n=Object(s["e"])({elementRef:l,reduce:450,minHeight:100});Object(i["onMounted"])(()=>{t.value=!0,v()});const r=Object(i["ref"])({keyWords:"",campsegStatId:"",excludeCampsegIds:e.currData.map(e=>e.campsegId).join(",")}),o=Object(i["ref"])([{label:"策略状态",values:[{label:"不限",value:""},{label:"草稿",value:"20"},{label:"预演完成",value:"32"}],isDate:!1}]),u=Object(i["ref"])({radioModel:[""]});function g(e){r.value.campsegStatId=e.value,v()}const{tableData:p,tableLoading:b,multipleSelection:m,pageData:f,getTableData:v,handleSelectionChange:h,handleSizeChange:y,handleCurrentChange:C}=c(r),k=Object(i["ref"])(!1);async function w(){if(0===m.value.length)return void d["Message"].warning("最少选择一个策略");const l=e.currData.length;if(l+m.value.length>15)return void d["Message"].warning("参与预演的活动数量不能超过15条");const n=m.value.map(e=>e.campsegId).join(",");k.value=!0;const i=await Object(s["a"])(n);k.value=!1,i||(a("addMarketing",m.value),t.value=!1)}function S(e){e(),setTimeout(()=>{a("addMarketing")},200)}return{visible:t,addMarketingRef:l,queryForm:r,QueryFormCell:o,sizeForm:u,QuerySelect:g,tableHeight:n,tableData:p,tableLoading:b,multipleSelection:m,pageData:f,getTableData:v,handleSelectionChange:h,handleSizeChange:y,handleCurrentChange:C,addMarketing:w,checkLoading:k,handleClose:S}}}),g=u,p=(t("0d30"),t("2877")),b=Object(p["a"])(g,l,n,!1,null,"1bfd47b8",null);a["default"]=b.exports}}]);