(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23b188ea"],{"5aa6":function(t,e,a){},"5d9c":function(t,e,a){"use strict";a("a432")},"7f68":function(t,e,a){"use strict";a("d912")},a229:function(t,e,a){"use strict";a("5aa6")},a432:function(t,e,a){},d912:function(t,e,a){},e05e:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"MaterHome"},[e("div",{staticClass:"search_box"},[e("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticClass:"input-search",attrs:{placeholder:"请输入触点名称"},model:{value:t.queryFrom.keywords,callback:function(e){t.$set(t.queryFrom,"keywords","string"===typeof e?e.trim():e)},expression:"queryFrom.keywords"}},[e("i",{staticClass:"el-input__icon el-icon-search cursor-pointer",attrs:{slot:"suffix"},on:{click:function(e){return t.QueryKeyWords()}},slot:"suffix"})]),e("div",{staticClass:"btn_box"},[e("el-button",{attrs:{type:"success"},on:{click:t.MaterAdd}},[t._v("新建")])],1)],1),e("div",{staticClass:"selech-panel"},[e("div",{staticClass:"buttons-container"},[e("div",[e("div",{staticStyle:{padding:"20px 0 0 20px","margin-bottom":"-10px",background:"#F7F7F7",display:"flex","align-items":"center"}},[e("label",{staticStyle:{width:"100px"}},[t._v("免打扰时间段：")]),e("span",[e("el-time-picker",{staticStyle:{width:"180px"},attrs:{size:"mini","is-range":"","range-separator":"至","start-placeholder":"","end-placeholder":"",format:"HH:mm","value-format":"HH:mm"},on:{change:function(e){return t.timeChange("contactAvoidTimeStart",e)}},model:{value:t.contactAvoidTimeStart,callback:function(e){t.contactAvoidTimeStart=e},expression:"contactAvoidTimeStart"}})],1),e("span",{staticStyle:{padding:"10px"}},[t._v("-")]),e("span",[e("el-time-picker",{staticStyle:{width:"180px"},attrs:{size:"mini","is-range":"","range-separator":"至","start-placeholder":"","end-placeholder":"",format:"HH:mm","value-format":"HH:mm"},on:{change:function(e){return t.timeChange("contactAvoidTimeEnd",e)}},model:{value:t.contactAvoidTimeEnd,callback:function(e){t.contactAvoidTimeEnd=e},expression:"contactAvoidTimeEnd"}})],1)]),e("query-form-cell",{attrs:{defaultSizeForm:t.sizeForm,list:t.QueryFormCell},on:{queryForm:t.QuerySelect,emptyFrom:t.emptyFrom}})],1)])]),e("div",{staticClass:"table"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"cell-style":t.cellStyle}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),e("el-table-column",{attrs:{label:"触点来源",width:"180"},scopedSlots:t._u([{key:"default",fn:function({row:{contactSource:a}}){var o;return[e("span",[t._v(t._s(null===(o=t.contactSourceType.find(({value:t})=>t==a+""))||void 0===o?void 0:o.label))])]}}])}),e("el-table-column",{attrs:{prop:"contactName",label:"触点名称"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{on:{click:function(e){return t.detailClick(a.row)}}},[t._v(t._s(a.row.contactName))])]}}])}),e("el-table-column",{attrs:{label:"触点类型"},scopedSlots:t._u([{key:"default",fn:function(a){return[0===a.row.contactType?e("span",[t._v("电子渠道")]):e("span",[t._v("实体渠道")])]}}])}),e("el-table-column",{attrs:{label:"触点客户类型"},scopedSlots:t._u([{key:"default",fn:function({row:{contactCustType:a}}){var o;return[e("span",[t._v(t._s(null===(o=t.contactCustType.find(({value:t})=>t==a+""))||void 0===o?void 0:o.label))])]}}])}),e("el-table-column",{attrs:{label:"执行交互流程"},scopedSlots:t._u([{key:"default",fn:function({row:{contactExecFlow:a}}){var o;return[e("span",[t._v(t._s(null===(o=t.contactCustExecFlow.find(({value:t})=>t==a+""))||void 0===o?void 0:o.label))])]}}])}),e("el-table-column",{attrs:{prop:"isScheduled",label:"是否可排期"},scopedSlots:t._u([{key:"default",fn:function(a){return[0===a.row.isScheduled?e("span",[t._v("否")]):e("span",[t._v("是")])]}}])}),e("el-table-column",{attrs:{prop:"channelName",label:"归属渠道"}}),e("el-table-column",{attrs:{prop:"description",label:"备注"}}),e("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-link",{staticClass:"text-sm mr-16",attrs:{type:"primary",underline:!1},on:{click:function(e){return t.browse(a.row,a.$index)}}},[t._v("修改 ")]),e("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-warning",iconColor:"#FAAD14",title:"确定删除？","cancel-button-type":"Primary"},on:{confirm:function(e){return t.DeleteContact(a.row,a.$index)}}},[e("el-link",{staticClass:"cursor-pointer text-sm",attrs:{slot:"reference",type:"danger",underline:!1},slot:"reference"},[t._v(" 删除")])],1)]}}])})],1)],1),e("div",{staticClass:"pager"},[e("el-pagination",{attrs:{"current-page":t.pageData.currentPage,"page-sizes":t.pageData.pageSizeList,"page-size":t.pageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.pageData.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),e("contact-dialog",{ref:"Dialog",attrs:{contactCustType:t.contactCustType,contactCustExecFlow:t.contactCustExecFlow,contactSourceType:t.contactSourceType},on:{update:t.getMaterData}}),e("delete-dialog",{ref:"Delete",attrs:{name:t.DeleteName,id:t.DeleteId,title:"触点"},on:{Dlete:t.DeleteData}}),e("head-name-dialog",{ref:"hDialog",attrs:{headNameList:t.contNameList,contactCustType:t.contactCustType,contactCustExecFlow:t.contactCustExecFlow,contactSourceType:t.contactSourceType}})],1)},l=[],c=a("38c8"),n=function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{attrs:{title:t.isTitle,visible:t.dialogVisible,width:"680px",top:"6vh","append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e},close:function(e){return t.closeDialog()}}},[e("div",{staticClass:"Contact-mtp"},[e("el-form",{ref:"ContactData",attrs:{model:t.ContactData,"label-width":"150px",rules:t.ContactRule}},[e("el-form-item",{attrs:{label:"触点来源：",prop:"contactSource"}},[e("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择"},model:{value:t.ContactData.contactSource,callback:function(e){t.$set(t.ContactData,"contactSource",e)},expression:"ContactData.contactSource"}},t._l(t.contactSourceType,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"触点名称：",prop:"contactName"}},[e("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],model:{value:t.ContactData.contactName,callback:function(e){t.$set(t.ContactData,"contactName",e)},expression:"ContactData.contactName"}})],1),e("el-form-item",{attrs:{label:"触点类型：",prop:"contactType"}},[e("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择"},model:{value:t.ContactData.contactType,callback:function(e){t.$set(t.ContactData,"contactType",e)},expression:"ContactData.contactType"}},[e("el-option",{attrs:{value:0,label:"电子渠道"}},[t._v(" 电子渠道 ")]),e("el-option",{attrs:{value:1,label:"实体渠道"}},[t._v(" 实体渠道 ")])],1)],1),e("el-form-item",{attrs:{label:"触点客户类型：",prop:"contactCustType"}},[e("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择"},model:{value:t.ContactData.contactCustType,callback:function(e){t.$set(t.ContactData,"contactCustType",e)},expression:"ContactData.contactCustType"}},t._l(t.contactCustType,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"执行交互流程：",prop:"contactExecFlow"}},[e("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择"},model:{value:t.ContactData.contactExecFlow,callback:function(e){t.$set(t.ContactData,"contactExecFlow",e)},expression:"ContactData.contactExecFlow"}},t._l(t.contactCustExecFlow,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"是否可排期：",prop:"isScheduled"}},[e("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择"},model:{value:t.ContactData.isScheduled,callback:function(e){t.$set(t.ContactData,"isScheduled",e)},expression:"ContactData.isScheduled"}},[e("el-option",{attrs:{value:1,label:"是"}},[t._v(" 是 ")]),e("el-option",{attrs:{value:0,label:"否"}},[t._v(" 否 ")])],1)],1),e("el-form-item",{attrs:{label:"归属渠道：",prop:"channelId"}},[e("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择"},model:{value:t.ContactData.channelId,callback:function(e){t.$set(t.ContactData,"channelId",e)},expression:"ContactData.channelId"}},t._l(t.ChannelData,(function(a){return e("el-option",{key:a.channelId,attrs:{label:a.channelName,value:a.channelId}},[t._v(" "+t._s(a.channelName)+" ")])})),1)],1),e("el-form-item",{attrs:{label:"信息安全：",prop:"contactCode"}},[e("el-input",{attrs:{disabled:""},model:{value:t.ContactData.contactCode,callback:function(e){t.$set(t.ContactData,"contactCode",e)},expression:"ContactData.contactCode"}})],1),e("el-form-item",{staticClass:"Description",attrs:{label:"触点描述：",prop:"description"}},[e("el-input",{attrs:{type:"textarea",maxlength:"500",placeholder:"您可以输入500个字"},model:{value:t.ContactData.description,callback:function(e){t.$set(t.ContactData,"description",e)},expression:"ContactData.description"}})],1)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.preservation}},[t._v("保 存")])],1)])],1)},i=[],s=a("0fea"),r=a("f9ae"),u=a("d39c"),d={name:"ContactDialog",props:["contactSourceType","contactCustType","contactCustExecFlow"],data(){return{dialogVisible:!1,ContactData:{},ChannelData:[],ContactRule:{contactName:[{required:!0,message:"请输入触点名称",trigger:"blur"},{min:1,max:20,message:"触点名称必须在20字符内",trigger:"blur"}],contactSource:[{required:!0,message:"请选择触点来源",trigger:"blur"}],contactType:[{required:!0,message:"请选择触点类型",trigger:"blur"}],contactCustType:[{required:!0,message:"请选择触点客户类型",trigger:"blur"}],contactExecFlow:[{required:!0,message:"请选择执行交互流程",trigger:"blur"}],isScheduled:[{required:!0,message:"请选择是否可排期",trigger:"blur"}],channelId:[{required:!0,message:"请选择归属渠道",trigger:"blur"}],description:[{max:5e3,message:"备注最多输入500个字",trigger:"blur"}]},ismodify:!1,isTitle:""}},created(){this.getChannels()},methods:{closeDialog(){this.dialogVisible=!1},async getChannels(){await Object(s["i"])(u["a"].seapi.listAllChannelName).then(t=>{this.ChannelData=[...t.channelNameAndIdList]})},ShowPopup(t,e){switch(t){case"modify":this.ismodify=!0,this.getInfo(e.contactId),this.isTitle="修改触点";break;case"MaterAdd":this.ismodify=!1,this.ContactData={},this.isTitle="新增触点";break}this.dialogVisible=!0},async getInfo(t){await Object(s["i"])(u["a"].seapi.queryContactDetailById,{contactId:t}).then(t=>{this.ContactData=t;let e=["contactSource","contactCustType","contactExecFlow"];for(let a in this.ContactData)e.includes(a)&&(this.ContactData[a]=this.ContactData[a].toString())})},preservation:Object(r["a"])((function(){this.$refs["ContactData"].validate(async t=>{t?await Object(s["i"])(u["a"].seapi.validateContactName,this.ContactData).then(t=>{!0===t?this.saveOrUpdateContact():this.$alert("触点名称重复","校验失败",{confirmButtonText:"确定",customClass:"errorPrompt"})}):this.$alert("请填写必填项","校验失败",{confirmButtonText:"确定",customClass:"errorPrompt"})})})),async saveOrUpdateContact(){await Object(s["i"])(u["a"].seapi.saveOrUpdateContact,this.ContactData).then(t=>{t&&(this.$message.success("操作成功"),this.dialogVisible=!1,this.$emit("update"))})}}},p=d,m=(a("a229"),a("7f68"),a("2877")),h=Object(m["a"])(p,n,i,!1,null,"18e54ea2",null),y=h.exports,g=a("ccbf"),b=a("4e3f"),f=a("5e05"),C=a("b893"),D={name:"ContactManage",components:{ContactDialog:y,DeleteDialog:c["a"],QueryFormCell:b["a"],HeadNameDialog:g["a"]},data(){return{tableData:[],LabelData:[],contactAvoidTimeStart:null,contactAvoidTimeEnd:null,QueryList:[{label:"创建时间",values:[{label:"不限",value:""},{label:"近一周",value:"-7"},{label:"近一个月",value:"-30"}],isDate:!0,dateType:"daterange",leftCol:5,rightCol:19},{label:"触点来源",values:[{label:"不限",value:""}],isDate:!1},{label:"归属渠道",values:[{label:"不限",value:""}],isDate:!1},{label:"触点类型",values:[{label:"不限",value:""},{label:"电子渠道",value:0},{label:"实体渠道",value:1}],isDate:!1}],sizeForm:{radioModel:["","","",""],dateModel:[[]]},queryFrom:{channelId:null,contactType:null,contactSource:null,endDate:null,startDate:null,keywords:null,contactAvoidTimeEnd:null,contactAvoidTimeStart:null},pageData:{currentPage:1,pageSize:10,pageSizeList:[10,20,30,40],total:0},channelData:[],defaultIndex:1,DeleteName:"",DeleteId:"",iop_token:"18129546139b0475209a33591482d519",contNameList:{},iscontNameDialog:!1,contactSourceType:[],contactCustType:[],contactCustExecFlow:[]}},computed:{QueryFormCell(){let t=[...this.QueryList],e=[...this.channelData],a=e.map(t=>({label:t.channelName,value:t.channelId}));return t[2].values=[...t[2].values,...a],t}},created(){this.getEnum(),this.getChannels()},methods:{async getEnum(){function t(t){return t.map(t=>({label:t.enumValue,value:t.enumKey}))}const e=await Object(s["i"])(f["a"].common.getSysEnum,{enumType:"mcd_contact_source"});this.contactSourceType=t(e),this.$set(this.QueryList[1],"values",[...this.QueryList[1].values,...this.contactSourceType]);const a=await Object(s["i"])(f["a"].common.getSysEnum,{enumType:"mcd_contact_cust_type"});this.contactCustType=t(a);const o=await Object(s["i"])(f["a"].common.getSysEnum,{enumType:"mcd_contact_exec_flow"});this.contactCustExecFlow=t(o),this.getMaterData()},async getMaterData(){await Object(s["i"])(u["a"].seapi.queryIopContactList,{...this.queryFrom,current:this.pageData.currentPage,size:this.pageData.pageSize}).then(t=>{this.tableData=t.records,this.pageData.total=t.total})},async getChannels(){await Object(s["i"])(u["a"].seapi.listAllChannelName).then(t=>{this.channelData=t.channelNameAndIdList})},timeChange(t,e){this.queryFrom[t]=e?e.join(","):"",this.getMaterData()},async DeleteData(t){await Object(s["i"])(u["a"].seapi.deleteContactById,{contactId:t}).then(t=>{t&&(this.$message.success("删除触点成功"),this.pageData.currentPage=1,this.getMaterData())})},cellStyle(t){return"触点名称"===t.column.label?"color:#0080CC;cursor: pointer;":0},browse(t){this.$refs["Dialog"].ShowPopup("modify",t)},QueryKeyWords(){this.pageData.currentPage=1,this.getMaterData()},emptyFrom(){this.queryFrom.touchPointDate="",this.queryFrom.startDate="",this.queryFrom.endDate="",this.QueryKeyWords()},QuerySelect(t){this.pageData.currentPage=1,t.value.constructor===Array?(this.queryFrom.startDate=t.form.dateModel[0][0],this.queryFrom.endDate=t.form.dateModel[0][1],this.queryFrom.touchPointDate=t.form.dateModel[0].join(","),t.form.radioModel[0]="",this.$forceUpdate()):""!==t.form.radioModel[0]?this.queryFrom.touchPointDate=Object(C["a"])(t.form.radioModel[0]).join(","):this.queryFrom.touchPointDate=" , ";let e=this.queryFrom.touchPointDate.split(",");this.queryFrom.startDate=e[0],this.queryFrom.endDate=e[1],this.$forceUpdate(),this.queryFrom.contactSource=t.form.radioModel[1],this.queryFrom.channelId=t.form.radioModel[2],this.queryFrom.contactType=t.form.radioModel[3],this.getMaterData()},MaterAdd(){this.$refs["Dialog"].ShowPopup("MaterAdd")},DeleteContact(t,e){this.DeleteName=t.contactName,this.DeleteId=t.contactId,this.$refs["Delete"].showDelete()},handleSizeChange(t){this.pageData.pageSize=t,this.getMaterData()},handleCurrentChange(t){this.pageData.currentPage=t,this.getMaterData()},contNameDialog(t,e){this.iscontNameDialog=!1,this.$refs["hDialog"].ShowPopup("cont"),"触点名称"===e.label&&(this.iscontNameDialog=!0,this.contNameList=t)},detailClick(t){this.iscontNameDialog=!0,this.contNameList=t,this.$refs["hDialog"].ShowPopup("cont")},closeDialog(){this.iscontNameDialog=!1}}},v=D,S=(a("5d9c"),Object(m["a"])(v,o,l,!1,null,"c4833380",null));e["default"]=S.exports}}]);