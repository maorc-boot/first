(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b5430fb"],{"0838":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"select-customer-layout"},[t("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"选客群",name:"customer"}},[t("SelectView",{attrs:{title:"已选客群",option:{label:"customGroupName",value:"customGroupId"},list:e.form.selectCustomerList}}),t("BatchImportProduct",{attrs:{type:"customer"},on:{uploadSuccess:e.uploadSuccess}}),t("CustomerList",{attrs:{isValidateNotComplete:!0,multiple:!e.modify,selectList:e.form.selectCustomerList},on:{select:e.selectCustomer}}),t("el-table",{attrs:{border:"",data:e.form.selectCustomerList}},[t("el-table-column",{attrs:{label:"序号",type:"index",width:"45",align:"center"}}),t("el-table-column",{attrs:{label:"客群id",prop:"customGroupId"}}),t("el-table-column",{attrs:{label:"客群名称",prop:"customGroupName"}}),t("el-table-column",{attrs:{label:"规则计算"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[a.ruleLoading?t("el-tag",{attrs:{type:"primary"}},[t("i",{staticClass:"el-icon-loading"}),e._v("正在计算 ")]):a.finalExpression?t("el-tag",{attrs:{type:"success"}},[e._v(" 计算完成 ")]):a.finalExpression?e._e():t("el-tag",{attrs:{type:"danger"}},[e._v(" 不支持该客群 ")])]}}])})],1)],1)],1),t("div",{staticClass:"select-customer_bottom__button"},[t("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.save}},[e._v("确定")]),t("el-button",{attrs:{size:"medium"},on:{click:e.cancel}},[e._v("取消")])],1)],1)},s=[],l=(a("14d9"),a("0fea")),r=a("afd9"),o=a("82be"),i={components:{SelectView:()=>a.e("chunk-67a56326").then(a.bind(null,"dec5")),CustomerList:()=>a.e("chunk-3839fbc3").then(a.bind(null,"67a1")),BatchImportProduct:()=>a.e("chunk-15a5ac08").then(a.bind(null,"b573"))},props:{node:{type:Object,default:()=>({})},modify:{type:Boolean,default:!1}},data(){return{activeName:"customer",form:{selectCustomerList:[]},productNodeList:[],rules:{attrType:[{required:!0,message:"请选择客群",trigger:"change"}]}}},methods:{uploadSuccess(e){e.forEach(e=>{this.form.selectCustomerList.some(t=>t.customGroupId===e.customGroupId)||(e.ruleLoading=!1,this.form.selectCustomerList.push(e))})},selectCustomer(e,t){this.form.selectCustomerList=e;const{type:a,current:n}=t;"add"===a&&(n.finalExpression||this.getCustomerExpression(n))},async getCustomerExpression(e){const t=Object(o["e"])([],{customerInfo:{columnNum:e.columnNum}});try{e.ruleLoading=!0;const{finalExpression:a}=await Object(l["i"])(r["a"].getTargetUserCount,t);e.finalExpression=a}catch(a){}finally{e.ruleLoading=!1,this.$forceUpdate()}},async save(){if(0===this.form.selectCustomerList.length)return this.$message.error("请选择客群");if(this.form.selectCustomerList.some(e=>e.ruleLoading))return this.$message.error("客群规则表达式正在计算中，请稍后");if(this.modify){const e=this.form.selectCustomerList[0];if(!e.finalExpression)return this.$message.error("所选客群不支持AI测算");this.$emit("save","customer",{customerInfo:this.form.selectCustomerList[0]})}else{let e=JSON.parse(JSON.stringify(this.form.selectCustomerList));if(e=e.filter(e=>e.finalExpression),0===e.length)return this.$message.error("所选客群不支持AI测算");this.$emit("save","customer",{customerList:e})}},cancel(){this.$emit("cancel")}},created(){if(this.modify){const{customerInfo:e}=this.node.businessData;this.form.selectCustomerList=[e]}}},u=i,c=(a("5b6d"),a("2877")),p=Object(c["a"])(u,n,s,!1,null,"80954296",null);t["default"]=p.exports},3385:function(e,t,a){},"5b6d":function(e,t,a){"use strict";a("3385")},"82be":function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return p})),a.d(t,"f",(function(){return m})),a.d(t,"d",(function(){return d}));a("d9e2"),a("14d9");var n=a("c1df"),s=a.n(n);const l=[{label:"=",value:"="},{label:">",value:">"},{label:"<",value:"<"},{label:">=",value:">="},{label:"<=",value:"<="},{label:"( ) 介于，左右不包括",value:"()"},{label:"( ] 介于，左不包括右包括",value:"(]"},{label:"[ ) 介于，左包括右不包括",value:"[)"},{label:"[ ] 介于，左右都包括",value:"[]"}],r=[{label:"等于",value:"="},{label:"不等于",value:"!="}],o={up:"提升",down:"降低",any:"任何变化",exact:"变成","=":"等于:","!=":"不等于:",">":"大于:","<":"小于:",">=":"大于等于:","<=":"小于等于:","[]":"介于:","()":"介于:","(]":"介于:","[)":"介于:",IN:"包含:",LK:"LIKE:"},i=sessionStorage.getItem("userId"),u=sessionStorage.getItem("userNameCn");function c(e){const t=["=","!=",">","<",">=","<="],a=["[]","()","(]","[)"],n=function(e){return"number"===typeof e?e:e||""},s=function(e){return e.condition=e.condition||e.conditions,"e="===e.condition?"非规范值":t.indexOf(e.condition)>=0?o[e.condition]+n(e["stringVal"])+(n(e["remark"])||n(e["startValue"])?n(e["startValue"])+""+n(e["remark"]):""):a.indexOf(e.condition)>=0?e["remark"]?o[e.condition]+`${e["startValue"]}-${e["endValue"]}`+e["remark"]:o[e.condition]+e["startValue"]+"至"+e["endValue"]:o[e.condition]+n(e["stringVal"])+(n(e["remark"])?n(e["remark"]):"")};return s(e)}function p(e,t){var a;return{sign:"",requestNo:"",version:"",pageIndex:0,pageSize:0,customerVo:{treeDetails:[{id:1,parentId:0,type:"root",calType:"=",columnName:null,columnNum:+(null===(a=t.customerInfo)||void 0===a?void 0:a.columnNum)||0,selectedValues:["Y"],updateCycle:null},...e.map((e,t)=>{var a;return{id:t+2,parentId:t+1,type:"normal",isFission:0,calType:e.calType,columnName:e.columnName,columnNum:e.columnNum,selectedValues:e.selectedValues,numVal1:null!==(a=e.numVal1)&&void 0!==a?a:e.value,numVal2:e.numVal2,updateCycle:null}})]}}}function m(e,t){var a;return[{id:1,parentId:0,type:"root",calType:"=",columnName:null,columnNum:+(null===(a=t.customerInfo)||void 0===a?void 0:a.columnNum)||0,selectedValues:["Y"],updateCycle:null},...e.map((e,t)=>{var a;return{id:t+2,parentId:t+1,type:"normal",isFission:0,calType:e.calType,columnName:e.columnName,columnNum:e.columnNum,selectedValues:e.selectedValues,numVal1:null!==(a=e.numVal1)&&void 0!==a?a:e.value,numVal2:e.numVal2,updateCycle:null}})]}function d(e){const{crossJoin:t=!1,taskType:a,productList:n,channelId:l,ruleList:r,scoreRange:o,isManualPerfection:c=1,peopleCnt:p=null}=e;let m=[];if(!p&&!o||!p&&2!==o.length)throw this.$message.error("请正确填写客群规模或得分区间！"),new Error("参数异常");if(t||1===a){if(r.length)for(let s=0;s<n.length;s++)for(let e=0;e<r.length;e++)m.push({ruleList:[r[e]],planId:n[s].planId,priority:0,custgroupList:[]})}else m=n.map(e=>{const t={ruleList:r,planId:e.planId,priority:0,custgroupList:[]};return 0===r.length&&delete t.ruleList,t});const d=r.length?{prodCustGroupList:m}:{};return{isManualPerfection:c,resByAIReqVO:{taskType:0,channelId:l,coordinationSwitch:0,executeType:0,hotSwitch:0,marketGoal:"1,3",recommendGoal:0,recommendProdNum:-1,taskEffectTime:s()().format("yyyy-MM-DD"),taskFailTime:"2099-12-31",taskId:"",taskName:"task_"+Date.now()+parseInt(1e3*Math.random()),execFlag:"0",createUserId:i,createUserName:u,downshiftFilter:"1",...d,prodPriorityList:n.map(e=>({peopleCnt:p,planId:e.planId,priority:0,planDescribe:e.planDesc,limitScore:p?null:o[0],maxScore:p?null:o[1],recommendMode:1,presetCustName:""}))}}}},afd9:function(e,t,a){"use strict";t["a"]={search0:"/plan-svc/api/intellpushprism/column/search0",valuePage:"/plan-svc/api/intellpushprism/column/valuePage",getTargetUserCount:"/plan-svc/api/intellpushprism/column/getTargetUserCount",batchImportProduct:"/plan-svc/api/intellpushprism/batchImportProduct",batchImpPlanTmpDownload:"/plan-svc/api/intellpushprism/batchImpPlanTmpDownload",saveScene:"/plan-svc/api/intellpushprism/saveScene",batchImportCust:"/plan-svc/api/intellpushprism/batchImportCust",batchImpCustTmpDownload:"/plan-svc/api/intellpushprism/batchImpCustTmpDownload",batchImportLabel:"/plan-svc/api/intellpushprism/batchImportLabel",batchImpLabelTmpDownload:"/plan-svc/api/intellpushprism/batchImpLabelTmpDownload",queryScoreRangeBatch:"/plan-svc/api/intellpushprism/ai/queryScoreRangeBatch",downloadChanPromptFile:"/plan-svc/mcd/chan/prompt/downloadChanPromptFile",getInferenceResByAI:"/plan-svc/api/intellpushprism/ai/getInferenceResByAI",queryScoreRange:"/plan-svc/api/intellpushprism/ai/queryScoreRange",queryAICustLoseWeightRes:"/plan-svc/api/intellpushprism/ai/queryAICustLoseWeightRes",OperationWorkshop:{queryMyAttentionPlan:"/plan-svc/api/intellpushprism/ai/queryMyAttentionPlan",addMyAttentionPlan:"/plan-svc/api/intellpushprism/ai/addMyAttentionPlan",getCampEvalTop5ByPlan:"/plan-svc/api/intellpushprism/ai/getCampEvalTop5ByPlan",getAITagTop10ByPlan:"/plan-svc/api/intellpushprism/ai/getAITagTop10ByPlan",removeMyAttentionPlan:"/plan-svc/api/intellpushprism/ai/removeMyAttentionPlan"}}}}]);