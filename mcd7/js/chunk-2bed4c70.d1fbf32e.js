(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2bed4c70"],{"0022":function(e,t,a){"use strict";a("33b7")},"271a":function(e,t,a){"use strict";var r=a("cb2d"),i=a("e330"),o=a("577e"),s=a("d6d6"),l=URLSearchParams,n=l.prototype,d=i(n.getAll),c=i(n.has),u=new l("a=1");!u.has("a",2)&&u.has("a",void 0)||r(n,"has",(function(e){var t=arguments.length,a=t<2?void 0:arguments[1];if(t&&void 0===a)return c(this,e);var r=d(this,e);s(t,1);var i=o(a),l=0;while(l<r.length)if(r[l++]===i)return!0;return!1}),{enumerable:!0,unsafe:!0})},"33b7":function(e,t,a){},"3f4a":function(e,t,a){"use strict";a("48a0d")},"48a0d":function(e,t,a){},"50c9":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"avoid-bother-customer-wrap fe-m-24 fe-p-24 bg"},[t("div",{staticClass:"search_box"},[t("el-form",{ref:"queryForm",attrs:{model:e.queryFrom,"label-width":"100px"}},[t("el-row",{staticStyle:{display:"flex","flex-wrap":"wrap"}},[t("el-col",[t("el-form-item",{attrs:{label:"用户名称ID：","label-width":"100px"}},[t("el-input",{staticStyle:{width:"86%"},attrs:{placeholder:"请输入用户名或ID"},model:{value:e.queryFrom.userName,callback:function(t){e.$set(e.queryFrom,"userName",t)},expression:"queryFrom.userName"}})],1)],1),t("el-col",[t("el-form-item",{attrs:{label:"角色名称：","label-width":"100px"}},[t("el-input",{staticStyle:{width:"86%"},attrs:{placeholder:"请输入角色名"},model:{value:e.queryFrom.keyWords,callback:function(t){e.$set(e.queryFrom,"keyWords",t)},expression:"queryFrom.keyWords"}})],1)],1),t("el-col",[t("el-form-item",{attrs:{label:"创建时间：","label-width":"100px"}},[t("el-date-picker",{staticStyle:{width:"86%"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.queryFrom.date,callback:function(t){e.$set(e.queryFrom,"date",t)},expression:"queryFrom.date"}})],1)],1),t("el-col",[t("el-form-item",{attrs:{label:"地市：","label-width":"100px"}},[t("el-select",{staticStyle:{width:"86%"},attrs:{filterable:"",clearable:"",placeholder:"请选择"},on:{change:e.cityChange},model:{value:e.queryFrom.cityId,callback:function(t){e.$set(e.queryFrom,"cityId",t)},expression:"queryFrom.cityId"}},e._l(e.cityOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",[t("el-form-item",{attrs:{label:"用户部门：","label-width":"100px"}},[t("el-select",{staticStyle:{width:"86%"},attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.queryFrom.departmentId,callback:function(t){e.$set(e.queryFrom,"departmentId",t)},expression:"queryFrom.departmentId"}},e._l(e.deptOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("div",{staticStyle:{"margin-left":"auto","margin-right":"20px"}},[t("el-button",{attrs:{type:"primary",loading:e.downloadLoading},on:{click:e.exportList}},[e._v("导出")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.queryListByKeyword()}}},[e._v("查询")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.userAdd()}}},[e._v("新建")])],1)],1)],1)],1),t("div",{staticClass:"list"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{type:"index",label:"序号"}}),t("el-table-column",{attrs:{prop:"cityName",label:"地市","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"userId",label:"用户ID","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"userName",label:"用户昵称","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"title",label:"用户部门","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"roleNames",label:"角色名称","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{staticClass:"text-sm mr-16",attrs:{type:"primary",underline:!1},on:{click:function(t){return e.lookHanlder(a.row,a.$index)}}},[e._v("查看")]),t("el-link",{staticClass:"text-sm mr-16",attrs:{type:"primary",underline:!1},on:{click:function(t){return e.editHanlder(a.row,a.$index)}}},[e._v("编辑")]),t("el-popconfirm",{attrs:{placement:"top",icon:"el-icon-warning",iconColor:"#FAAD14",title:"确定删除？","cancel-button-type":"Primary"},on:{confirm:function(t){return e.deleteHanlder(a.row,a.$index)}}},[t("el-link",{staticClass:"cursor-pointer text-sm",attrs:{slot:"reference",type:"danger",underline:!1},slot:"reference"},[e._v(" 删除")])],1)]}}])})],1)],1),t("div",{staticClass:"pager"},[t("el-pagination",{attrs:{"current-page":e.pageData.currentPage,"page-sizes":e.pageData.pageSizeList,"page-size":e.pageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pageData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e.dialogVisible?t("user-dialog",{attrs:{dialogVisible:e.dialogVisible,dialogTitle:e.dialogTitle,operationType:e.operationType,rowData:e.rowData},on:{"update:dialogVisible":function(t){e.dialogVisible=t},"update:dialog-visible":function(t){e.dialogVisible=t},getUserListData:e.getUserListData}}):e._e()],1)},i=[],o=(a("88a7"),a("271a"),a("5494"),a("f9ae")),s=a("0fea"),l=a("a454"),n=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,"before-close":e.closeHandler,width:"500px",top:"10vh","append-to-body":""}},[t("div",{staticClass:"Contact-mtp"},[t("el-form",{ref:"usersFrom",attrs:{model:e.formData,"label-width":"100px",rules:e.rules,disabled:"look"==this.operationType}},[t("el-form-item",{attrs:{label:"用户账号",prop:"userId"}},[t("el-input",{attrs:{disabled:"add"!=this.operationType},model:{value:e.formData.userId,callback:function(t){e.$set(e.formData,"userId",t)},expression:"formData.userId"}})],1),t("el-form-item",{attrs:{label:"用户昵称",prop:"userName"}},[t("el-input",{model:{value:e.formData.userName,callback:function(t){e.$set(e.formData,"userName",t)},expression:"formData.userName"}})],1),t("el-form-item",{attrs:{label:"用户密码",prop:"pwd"}},[t("el-input",{attrs:{"show-password":""},model:{value:e.formData.pwd,callback:function(t){e.$set(e.formData,"pwd",t)},expression:"formData.pwd"}})],1),t("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[t("el-input",{model:{value:e.formData.email,callback:function(t){e.$set(e.formData,"email",t)},expression:"formData.email"}})],1),t("el-form-item",{attrs:{label:"手机号码",prop:"mobilePhone"}},[t("el-input",{attrs:{disabled:"add"!=this.operationType},model:{value:e.formData.mobilePhone,callback:function(t){e.$set(e.formData,"mobilePhone",t)},expression:"formData.mobilePhone"}})],1),t("el-form-item",{attrs:{label:"归属地市",clearable:"",filterable:"",prop:"cityId"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:e.cityChange},model:{value:e.formData.cityId,callback:function(t){e.$set(e.formData,"cityId",t)},expression:"formData.cityId"}},e._l(e.cityArr,(function(e,a){return t("el-option",{key:a,attrs:{label:e.cityName,value:e.cityId}})})),1)],1),t("el-form-item",{attrs:{label:"归属区县",clearable:"",filterable:"",prop:"countyId"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:e.countyChange},model:{value:e.formData.countyId,callback:function(t){e.$set(e.formData,"countyId",t)},expression:"formData.countyId"}},e._l(e.countyOptions,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"归属网格",clearable:"",filterable:"",prop:"gridId"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.formData.gridId,callback:function(t){e.$set(e.formData,"gridId",t)},expression:"formData.gridId"}},e._l(e.gridOptions,(function(e,a){return t("el-option",{key:a,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"用户部门",filterable:"",clearable:"",prop:"departmentId"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.formData.departmentId,callback:function(t){e.$set(e.formData,"departmentId",t)},expression:"formData.departmentId"}},e._l(e.departmentArr,(function(e,a){return t("el-option",{key:a,attrs:{label:e.title,value:e.deptId}})})),1)],1),t("el-form-item",{attrs:{label:"归属角色",prop:"roleIds"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择",multiple:""},model:{value:e.formData.roleIds,callback:function(t){e.$set(e.formData,"roleIds",t)},expression:"formData.roleIds"}},e._l(e.roleArr,(function(e,a){return t("el-option",{key:a,attrs:{label:e.roleName,value:e.roleId}})})),1)],1)],1)],1),"look"!=this.operationType?t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeHandler}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("保 存")])],1):e._e()])],1)},d=[];a("d9e2"),a("14d9");const c=l["a"].user.citySelectData,u=l["a"].department.selectDepartmentData,p=l["a"].county.selectCountyByCityID,m=l["a"].grid.selectGridByCountyID;var h={name:"UserDialog",props:{dialogTitle:{type:String},dialogVisible:{type:Boolean,default:!1},operationType:{type:String,default:()=>"add"},rowData:{type:Object}},data(){var e=(e,t,a)=>{let r=/^1[345789]\d{9}$/;r.test(t)?a():a(new Error("请输入11位手机号"))};return{cityArr:[],departmentArr:[],roleArr:[],formData:{mobilePhone:"",email:"",userId:"",cityId:"",countyId:"",gridId:"",departmentId:"",roleIds:[],id:""},gridOptions:[],countyOptions:[],dataInfo:{},rules:{userId:[{required:!0,message:"请输入用户账号",trigger:"blur"}],cityId:[{required:!0,message:"请选择所属地市",trigger:"change"}],countyId:[{required:!0,message:"请选择所属区县",trigger:"blur"}],girdId:[{required:!0,message:"请选择所属网格",trigger:"blur"}],roleIds:[{required:!0,message:"请选择归属角色",trigger:"blur"}],departmentId:[{required:!0,message:"请选择部门",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],userName:[{required:!0,message:"请输入用户昵称",trigger:"blur"}],staffNo:[{required:!0,message:"请输入工号",trigger:"blur"}],status:[{required:!1,message:"请输入状态",trigger:"blur"}],birthday:[{required:!1,message:"请选择出生日期",trigger:"blur"}],mobilePhone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{type:"number",validator:e,message:"请输入11位有效手机号号码",trigger:["blur"]}]}}},methods:{closeHandler(){this.$emit("update:dialogVisible",!1)},async initData(){let e=await Object(s["i"])(c);this.cityArr=e,this.cityArr.forEach((e,t)=>{"-1"!==e.value||this.cityArr.splice(t,1)}),this.cityArr.unshift({cityName:"全部",cityId:"-1"});let t=e[0].cityId;this.getDeptList("-1"),this.getCountyList(t),this.getGridList(t,"-1")},getDeptList(e){Object(s["i"])(u,{id:e}).then(e=>{this.departmentArr=e.length?[...e]:[];const t=this.departmentArr.some(e=>"-1"===e.deptId);t||this.departmentArr.unshift({title:"全部",deptId:"-1"})})},async cityChange(e){this.formData={...this.formData,countyId:"",gridId:"",departmentId:""},await Object(s["i"])(u,{id:e}).then(e=>{this.departmentArr=e.length?[...e]:[],this.getCountyList(this.formData.cityId),this.getGridList(this.formData.cityId,this.formData.countyId)})},getSelectRole(){Object(s["i"])(l["a"].role.getSelectRoleData).then(e=>{this.roleArr=e})},async getUsersInfo(){await Object(s["i"])(l["a"].user.lookUserInfo,{id:this.rowData.id}).then(e=>{this.getDeptList(e.cityId),this.getCountyList(e.cityId),this.getGridList(e.cityId,e.countyId),this.dataInfo=e;let t=e.roleIds.split(",");e.roleIds=t,this.formData={...e,cityId:e.cityId||"-1",countyId:e.countyId||"-1",departmentId:e.departmentId||"-1",gridId:e.gridId||"-1"}})},async addUsersInfo(){this.$refs["usersFrom"].validate(async e=>{e?(this.formData.roleIds=this.formData.roleIds.join(","),await Object(s["i"])(l["a"].user.addUserInfo,this.formData).then(e=>{this.$message.success("新增成功"),this.$emit("getUserListData"),this.closeHandler()})):this.$alert("请填写必填项","校验失败",{confirmButtonText:"确定",customClass:"errorPrompt"})})},async editUsersInfo(){this.$refs["usersFrom"].validate(async e=>{e?(this.formData.roleIds=this.formData.roleIds.join(","),this.formData.id=this.rowData.id,await Object(s["i"])(l["a"].user.editUserInfo,this.formData).then(e=>{this.$message.success("编辑成功"),this.$emit("getUserListData"),this.closeHandler()})):this.$alert("请填写必填项","校验失败",{confirmButtonText:"确定",customClass:"errorPrompt"})})},submit(){"add"===this.operationType?this.addUsersInfo():this.editUsersInfo()},countyChange(e){this.formData={...this.formData,gridId:"",departmentId:""},this.getGridList(this.formData.cityId,this.formData.countyId)},getCountyList(e){let t={cityId:e};Object(s["i"])(p,t).then(e=>{this.countyOptions=e.map(e=>({label:e.countyName,value:e.countyId}));const t=this.countyOptions.some(e=>"-1"===e.value),a=this.countyOptions.some(e=>"9999"===e.value);a||this.countyOptions.push({label:"非区县",value:"9999"}),t||(this.countyOptions.unshift({label:"全部",value:"-1"}),this.formData={...this.formData,countyId:this.dataInfo.countyId||"-1"})})},getGridList(e,t){let a={cityId:e,countyId:t};Object(s["i"])(m,a).then(e=>{this.gridOptions=e.map(e=>({label:e.gridName,value:e.gridId}));const t=this.gridOptions.some(e=>"-1"===e.value),a=this.gridOptions.some(e=>"9999"===e.value);a||this.gridOptions.push({label:"非网格",value:"9999"}),t||(this.gridOptions.unshift({label:"全部",value:"-1"}),this.formData={...this.formData,gridId:this.dataInfo.gridId||"-1"})})}},created(){this.initData(),this.formData.cityId="999",this.getSelectRole(),"add"!==this.operationType&&this.getUsersInfo()}},y=h,f=(a("3f4a"),a("2877")),g=Object(f["a"])(y,n,d,!1,null,"1859f404",null),b=g.exports,I=a("0557");const v=l["a"].user.citySelectData,D=l["a"].department.selectDepartmentData;var w={name:"UserManage",components:{UserDialog:b},data(){return{operationType:"add",dialogVisible:!1,downloadLoading:!1,rowData:{},queryFrom:{keyWords:"",cityId:"",departmentId:"",date:[],userId:"",userName:""},pageData:{currentPage:1,pageSize:10,pageSizeList:[10,20,30,40],total:0},loading:!1,dialogTitle:"",windowTitle:"",tableData:[],options:[],cityOptions:[],deptOptions:[]}},methods:{async getUserListData(){this.loading=!0;let e={keyWords:this.queryFrom.keyWords,current:this.pageData.currentPage,size:this.pageData.pageSize,cityId:this.queryFrom.cityId,departmentId:this.queryFrom.departmentId,endTime:this.queryFrom.date?this.queryFrom.date[1]:"",startTime:this.queryFrom.date?this.queryFrom.date[0]:"",userId:this.queryFrom.userName,userName:this.queryFrom.userName};await Object(s["i"])(l["a"].user.getUserList,e).then(e=>{this.tableData=e.records,this.pageData.total=e.total,this.loading=!1})},async cityChange(){this.formData={...this.formData,countyId:"",gridId:"",departmentId:""},await Object(s["i"])(D,{id:this.queryFrom.cityId}).then(e=>{this.deptOptions=e.map(e=>({label:e.title,value:e.deptId}))})},async getCityList(){let e=await Object(s["i"])(v);this.cityOptions=e.map(e=>({label:e.cityName,value:e.cityId})),this.cityOptions.forEach((e,t)=>{"-1"!==e.value||this.cityOptions.splice(t,1)}),this.cityOptions.unshift({label:"全部",value:"-1"}),this.queryFrom={...this.queryFrom,cityId:"-1"},this.getDeptList("-1")},getDeptList(e){let t={cityId:e};Object(s["i"])(D,t).then(e=>{this.deptOptions=e.map(e=>({label:e.title,value:e.deptId}));const t=this.deptOptions.some(e=>"-1"===e.value);t||this.deptOptions.unshift({label:"全部",value:"-1"}),this.queryFrom={...this.queryFrom,departmentId:"-1"}})},queryApproveInfo(){this.getUserListData()},queryListByKeyword(){this.pageData.currentPage=1,this.queryApproveInfo()},userAdd(){this.dialogVisible=!0,this.dialogTitle="添加用户",this.operationType="add"},lookHanlder(e){this.dialogVisible=!0,this.dialogTitle="查看用户",this.operationType="look",this.rowData=e},editHanlder(e){this.dialogVisible=!0,this.dialogTitle="编辑用户",this.operationType="edit",this.rowData=e},deleteHanlder(e){Object(s["i"])(l["a"].user.deleteUserList,{id:e.id}).then(e=>{this.$message({type:"success",message:e.message}),this.getUserListData()})},handleSizeChange(e){this.pageData.pageSize=e,this.queryApproveInfo()},handleCurrentChange(e){this.pageData.currentPage=e,this.queryApproveInfo()},exportList(){const e=I["a"].commonConfig.baseURL+"/cmn-svc/api/jx/user/export?cityId="+(this.queryFrom.cityId||"")+"&departmentId="+(this.queryFrom.departmentId||"")+"&endTime="+(this.queryFrom.date[1]||"")+"&startTime="+(this.queryFrom.date[0]||"")+"&userId="+(this.queryFrom.userName||"")+"&userName="+(this.queryFrom.userName||"");this.downloadLoading=!0,Object(s["d"])(e).then(({data:e})=>{const t=new Blob([e],{type:e.type}),a=`用户清单_${Object(o["b"])(Date.now())}.xls`,r=document.createElement("a");r.download=a,r.style.display="none",r.href=URL.createObjectURL(t),document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r)}).finally(()=>{this.downloadLoading=!1})}},created(){this.getUserListData(),this.getCityList()},mounted(){}},k=w,q=(a("0022"),Object(f["a"])(k,r,i,!1,null,"3e7415ff",null));t["default"]=q.exports},5494:function(e,t,a){"use strict";var r=a("83ab"),i=a("e330"),o=a("edd0"),s=URLSearchParams.prototype,l=i(s.forEach);r&&!("size"in s)&&o(s,"size",{get:function(){var e=0;return l(this,(function(){e++})),e},configurable:!0,enumerable:!0})},"88a7":function(e,t,a){"use strict";var r=a("cb2d"),i=a("e330"),o=a("577e"),s=a("d6d6"),l=URLSearchParams,n=l.prototype,d=i(n.append),c=i(n["delete"]),u=i(n.forEach),p=i([].push),m=new l("a=1&a=2&b=3");m["delete"]("a",1),m["delete"]("b",void 0),m+""!=="a=2"&&r(n,"delete",(function(e){var t=arguments.length,a=t<2?void 0:arguments[1];if(t&&void 0===a)return c(this,e);var r=[];u(this,(function(e,t){p(r,{key:t,value:e})})),s(t,1);var i,l=o(e),n=o(a),m=0,h=0,y=!1,f=r.length;while(m<f)i=r[m++],y||i.key===l?(y=!0,c(this,i.key)):h++;while(h<f)i=r[h++],i.key===l&&i.value===n||d(this,i.key,i.value)}),{enumerable:!0,unsafe:!0})},d6d6:function(e,t,a){"use strict";var r=TypeError;e.exports=function(e,t){if(e<t)throw new r("Not enough arguments");return e}},edd0:function(e,t,a){"use strict";var r=a("13d2"),i=a("9bf2");e.exports=function(e,t,a){return a.get&&r(a.get,t,{getter:!0}),a.set&&r(a.set,t,{setter:!0}),i.f(e,t,a)}}}]);