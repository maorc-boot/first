(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30bf307e"],{"0924":function(e,t,a){"use strict";a("9011")},"33c8":function(e,t,a){"use strict";a("989b")},"36d4":function(e,t,a){},6285:function(e,t,a){"use strict";a("703a")},"703a":function(e,t,a){},"7b5a":function(e,t,a){"use strict";var l=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"Selected"},[e._m(0),t("div",{staticClass:"title label"},[t("span",[e._v(e._s(e.title))])]),t("div",{staticClass:"label"},e._l(e.newLabel,(function(a){return t("el-tag",{key:a[e.Default.id],staticClass:"tag-success",attrs:{type:"success",closable:"","disable-transitions":""},on:{close:function(t){return e.handleClose(a)}}},[e._v(" "+e._s(a[e.Default.value])+" ")])})),1),e.showHistoryBtn?t("el-button",{staticStyle:{"margin-left":"auto"},attrs:{type:"primary"},on:{click:function(t){return e.$emit("openHistory")}}},[e._v(" 营销历史 ")]):e._e()],1)])},s=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"Selected-icon label"},[t("i",{staticClass:"iconfont icongonggongtubiao-huitiaoliangcedianzhui"})])}],i={props:{showHistoryBtn:{type:Boolean,default:()=>!1},Label:{type:Array,default:()=>[]},Default:{type:Object,default:()=>({id:"id",value:"value"})},isPulldown:{type:Boolean,default:()=>!0},ismutex:{type:Boolean,default:()=>!0},title:{type:String,default:()=>"已选产品"},labelFlag:{type:String,default:()=>"product"}},watch:{Label(e,t){0!==e.length?e[0].customerFlag?this.newLabel=this.Label:this.newLabel=e.filter(e=>(void 0===e.flag&&(e.flag=this.labelFlag),e.flag===this.flag)):this.newLabel=this.Label},labelFlag(e,t){this.flag=e,this.newLabel=this.Label.filter(t=>t.flag===e)}},mounted(){this.newLabel=this.Label.filter(e=>e.flag===this.flag)},data(){return{SetMeal:!1,flag:"product",newLabel:[]}},methods:{handleClose(e){this.$emit("close",e)}},created(){}},n=i,o=(a("0924"),a("c37e"),a("2877")),r=Object(o["a"])(n,l,s,!1,null,"88aeb586",null);t["a"]=r.exports},9011:function(e,t,a){},"95f6":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"MaterHome"},[t("div",{staticClass:"search_box"},[t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticClass:"input-search",attrs:{placeholder:"请输入客户群名称"},model:{value:e.keyWords,callback:function(t){e.keyWords="string"===typeof t?t.trim():t},expression:"keyWords"}},[t("i",{staticClass:"el-input__icon el-icon-search cursor-pointer",attrs:{slot:"suffix"},on:{click:function(t){return e.QueryKeyWords()}},slot:"suffix"})]),t("div",[t("span",[e._v("客群类型：")]),t("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.custgroupType,callback:function(t){e.custgroupType=t},expression:"custgroupType"}},e._l(e.custgroupTypeList,(function(e){return t("el-option",{key:e.enumId,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("div",[t("span",[e._v("所属渠道：")]),t("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.selectedChannelId,callback:function(t){e.selectedChannelId=t},expression:"selectedChannelId"}},e._l(e.channelData,(function(e){return t("el-option",{key:e.channelId,attrs:{label:e.channelName,value:e.channelId}})})),1)],1),t("div",{staticClass:"btn_box"},[t("el-button",{attrs:{type:"primary"},on:{click:e.QueryKeyWords}},[e._v("查询")]),t("el-button",{attrs:{type:"primary"},on:{click:e.deleteMuti}},[e._v("批量删除")]),t("el-button",{attrs:{type:"success"},on:{click:e.MaterAdd}},[e._v("新建")])],1)],1),t("div",{staticClass:"table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"cell-style":e.cellStyle},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"45",align:"center"}}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),t("el-table-column",{attrs:{prop:"custgroupId",label:"客户群编号",width:"180"}}),t("el-table-column",{attrs:{prop:"custgroupName",label:"客户群名称",width:"180"}}),t("el-table-column",{attrs:{prop:"custgroupDesc",label:"客户群描述",width:"180","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"channelName",label:"所属渠道",width:"180","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"createUserName",label:"创建人",width:"180"}}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"180"}}),t("el-table-column",{attrs:{prop:"custgroupType",label:"客群类型",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(" "+e._s(e.custgroupTypeList.find(e=>e.enumKey==a.row.custgroupType)&&e.custgroupTypeList.find(e=>e.enumKey==a.row.custgroupType).enumValue)+" ")])]}}])}),t("el-table-column",{attrs:{prop:"custNum",label:"客户群数量",width:"180"}}),t("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"90"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.MaterEdit(a.row)}}},[e._v(" 修改 ")]),t("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(t){return e.deleteData(a.row)}}},[e._v(" 删除 ")])]}}])})],1)],1),t("div",{staticClass:"pager"},[t("el-pagination",{attrs:{"current-page":e.pageData.currentPage,"page-sizes":e.pageData.pageSizeList,"page-size":e.pageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pageData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e.showEditDialog?t("el-dialog",{attrs:{width:"50%",title:"修改",visible:e.showEditDialog,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.showEditDialog=t}}},[t("el-form",{ref:"editForm",staticClass:"edit-form",attrs:{model:e.willUpdateForm}},[t("el-form-item",{attrs:{label:"客户群名称："}},[t("span",[e._v(e._s(e.currentRow.custgroupName))])]),t("el-form-item",{attrs:{label:"客群类型：",prop:"custgroupType",rules:[{required:!0,message:"请选择客群范围",trigger:"change"}]}},[t("el-select",{model:{value:e.willUpdateForm.custgroupType,callback:function(t){e.$set(e.willUpdateForm,"custgroupType",t)},expression:"willUpdateForm.custgroupType"}},e._l(e.custgroupTypeList,(function(e){return t("el-option",{key:e.enumId,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("el-form-item",{attrs:{label:"所属渠道：",prop:"channelId",rules:[{required:!0,message:"请选择所属渠道",trigger:"change"}]}},[t("el-select",{attrs:{multiple:""},model:{value:e.willUpdateForm.channelId,callback:function(t){e.$set(e.willUpdateForm,"channelId",t)},expression:"willUpdateForm.channelId"}},e._l(e.channelData,(function(e){return t("el-option",{key:e.channelId,attrs:{label:e.channelName,value:e.channelId}})})),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.showEditDialog=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.EditData}},[e._v("确 定")])],1)],1):e._e(),t("SensitiveCustDialog",{ref:"Dialog",on:{update:e.getSensitiveCustData}}),t("delete-dialog",{ref:"Delete",attrs:{name:e.deleteInfo.DeleteName,id:e.DeleteId,title:"敏感客户群配置"},on:{Dlete:e.DeleteData}})],1)},s=[],i=(a("14d9"),a("38c8")),n=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.isTitle,visible:e.dialogVisible,width:"1000px",heigh:"1000px",top:"10vh","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){return e.closeDialog()}}},[t("div",{staticClass:"search_box"},[t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticClass:"input-search",attrs:{placeholder:"请输入客户群名称"},model:{value:e.queryFrom.keyWords,callback:function(t){e.$set(e.queryFrom,"keyWords","string"===typeof t?t.trim():t)},expression:"queryFrom.keyWords"}},[t("i",{staticClass:"el-input__icon el-icon-search cursor-pointer",attrs:{slot:"suffix"},on:{click:function(t){return e.QueryKeyWords()}},slot:"suffix"})]),t("el-form",{attrs:{"label-position":"right","label-width":"95px"}},[t("el-form-item",{attrs:{label:"客群类型：",prop:"custgroupType"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.custgroupType,callback:function(t){e.custgroupType=t},expression:"custgroupType"}},e._l(e.custgroupTypeList,(function(e){return t("el-option",{key:e.enumId,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1)],1),t("el-form",{attrs:{"label-position":"right","label-width":"95px"}},[t("el-form-item",{attrs:{label:"所属渠道：",prop:"channelId"}},[t("el-select",{staticClass:"muti-select",attrs:{multiple:"",placeholder:"请选择"},on:{change:e.QuerySelect},model:{value:e.selectedChannelId,callback:function(t){e.selectedChannelId=t},expression:"selectedChannelId"}},e._l(e.channelData,(function(a){return t("el-option",{key:a.channelId,attrs:{label:a.channelName,value:a.channelId}},[e._v(" "+e._s(a.channelName)+" ")])})),1)],1)],1)],1),t("label-screen",{attrs:{title:"已选客户群",ismutex:!1,isPulldown:!1,Label:e.Label,Default:e.LabelDefault},on:{close:e.handleClose}}),t("div",{staticClass:"table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"cell-style":e.cellStyle}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),t("el-table-column",{attrs:{prop:"customGroupId",label:"客户群编号",width:"140"}}),t("el-table-column",{attrs:{prop:"customGroupName",label:"客户群名称",width:"140"}}),t("el-table-column",{attrs:{label:"更新周期",width:"110"},scopedSlots:e._u([{key:"default",fn:function(a){return[1===a.row.updateCycle?t("span",[e._v("一次性")]):e._e(),2===a.row.updateCycle?t("span",[e._v("月周期")]):e._e(),3===a.row.updateCycle?t("span",[e._v("日周期")]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"createUserName",label:"创建人",width:"110"}}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"140"}}),t("el-table-column",{attrs:{prop:"customNum",label:"客户群数量",width:"110"}}),t("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{staticClass:"text-sm mr-16",attrs:{type:"primary",underline:!1},on:{click:function(t){return e.selectCust(a.row,a.$index)}}},[e._v("选择 ")])]}}])})],1)],1),t("div",{staticClass:"pager"},[t("el-pagination",{attrs:{"current-page":e.pageData.currentPage,"page-sizes":e.pageData.pageSizeList,"page-size":e.pageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pageData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.preservation}},[e._v("保 存")])],1)],1)],1)},o=[],r=a("0fea"),u=a("d39c"),c=a("d370"),p=a("5e05"),h=a("4e3f"),d=a("7b5a"),g={name:"SensitiveCustDialog",components:{QueryFormCell:h["a"],LabelScreen:d["a"]},data(){return{dialogVisible:!1,channelData:[],custgroupTypeList:[],custgroupType:"",tableData:[],QueryList:[{label:"归属渠道",values:[],isDate:!1}],sizeForm:{radioModel:["","",""],dateModel:[[]]},ismodify:!0,isTitle:"配置敏感客户群",pageData:{currentPage:1,pageSize:10,pageSizeList:[10,20,30,40],total:0},selectedChannelId:null,Label:[],LabelDefault:{id:"customGroupId",value:"customGroupName"},queryFrom:{channelId:null,keyWords:null}}},created(){this.getChannels(),this.getCustomType(),this.getCustgroupList()},computed:{QueryFormCell(){let e=[...this.QueryList],t=[...this.channelData],a=t.map(e=>({label:e.channelName,value:e.channelId}));return e[0].values=[...e[0].values,...a],e}},methods:{closeDialog(){this.dialogVisible=!1},QueryKeyWords(){this.pageData.currentPage=1,this.getCustgroupList()},async getCustgroupList(){await Object(r["i"])(c["a"].mpapi.getMoreMyCustom,{keyWords:this.queryFrom.keyWords,current:this.pageData.currentPage,size:this.pageData.pageSize}).then(e=>{this.tableData=e.records,this.pageData.total=e.total})},QuerySelect(){},async getChannels(){await Object(r["i"])(u["a"].seapi.listAllChannelName).then(e=>{this.channelData=e.channelNameAndIdList})},async getCustomType(){const e=await Object(r["i"])(p["a"].common.getSysEnum,{enumType:"channel_sensitive_user_type"});this.custgroupTypeList=e},ShowPopup(e,t){this.dialogVisible=!0},async getInfo(e){await Object(r["i"])(u["a"].seapi.queryContactDetailById,{contactId:e}).then(e=>{this.ContactData=e})},async preservation(){if(0==this.selectedChannelId.length)return void this.$message.error("请选择渠道");if(!this.custgroupType)return void this.$message.error("请选择客群类型");if(0===this.Label.length)return void this.$message.error("请选择客户群");let e=[];this.Label.forEach(t=>{for(let a of this.selectedChannelId)e.push({channelId:a,channelName:this.channelData.find(e=>e.channelId==a).channelName,custgroupId:t.customGroupId,custgroupType:this.custgroupType})}),await Object(r["i"])(u["a"].seapi.saveSensitiveCust,e).then(e=>{!0===e&&(this.$message.success("操作成功"),this.dialogVisible=!1,this.$emit("update"))})},async getSensitiveCustData(e){await Object(r["i"])(u["a"].seapi.querySensitiveCust,{channelId:e,custgroupType:this.custgroupType,current:this.pageData.currentPage,size:this.pageData.pageSize}).then(e=>{this.Label=[],e.records.forEach(e=>{this.Label.push({customGroupId:e.custgroupId,customGroupName:e.custgroupName})})})},handleSizeChange(e){this.pageData.pageSize=e,this.getCustgroupList()},handleCurrentChange(e){this.pageData.currentPage=e,this.getCustgroupList()},cellStyle(e){return"触点名称"===e.column.label?"color:#0080CC;cursor: pointer;":0},selectCust(e){if(!this.selectedChannelId||this.selectedChannelId&&!this.selectedChannelId.length)return void this.$message.error("请选择渠道");if(!this.custgroupType)return void this.$message.error("请选择客群类型");let t=!1;this.Label.forEach(a=>{a.customGroupId===e.customGroupId&&(t=!0)}),t?this.$message.error("重复选择"):this.Label.length>=10?this.$message.warning("最多选择10个客群！"):this.Label.push({customGroupId:e.customGroupId,customGroupName:e.customGroupName})},handleClose(e){this.Label=this.Label.filter(t=>!(t.customGroupId===e.customGroupId))}}},m=g,y=(a("6285"),a("d6a2"),a("2877")),b=Object(y["a"])(m,n,o,!1,null,"7c647d26",null),f=b.exports,v=a("ccbf"),C={name:"SensitiveCust",components:{SensitiveCustDialog:f,DeleteDialog:i["a"],QueryFormCell:h["a"],HeadNameDialog:v["a"]},data(){return{tableData:[],LabelData:[],QueryList:[{label:"归属渠道",values:[{label:"不限",value:""}],isDate:!1}],sizeForm:{radioModel:["","",""],dateModel:[[]]},queryFrom:{custgroupType:null,channelId:null,keyWords:null},pageData:{currentPage:1,pageSize:10,pageSizeList:[10,20,30,40],total:0},keyWords:"",channelData:[],selectedChannelId:null,custgroupTypeList:[],custgroupType:null,defaultIndex:1,deleteInfo:{DeleteChannelId:"",DeleteCustgroupId:"",DeleteName:""},DeleteId:"",multipleSelection:[],showEditDialog:!1,willUpdateForm:{custgroupType:"",channelId:[]},currentRow:{}}},computed:{QueryFormCell(){let e=[...this.QueryList],t=[...this.channelData],a=t.map(e=>({label:e.channelName,value:e.channelId}));return e[0].values=[...e[0].values,...a],e}},created(){this.getSensitiveCustData(),this.getChannels(),this.getCustomType()},methods:{async getSensitiveCustData(){await Object(r["i"])(u["a"].seapi.querySensitiveCust,{...this.queryFrom,current:this.pageData.currentPage,size:this.pageData.pageSize}).then(e=>{this.tableData=e.records,this.pageData.total=e.total})},async getCustomType(){const e=await Object(r["i"])(p["a"].common.getSysEnum,{enumType:"channel_sensitive_user_type"});this.custgroupTypeList=e},async getChannels(){await Object(r["i"])(u["a"].seapi.listAllChannelName).then(e=>{this.channelData=e.channelNameAndIdList})},async DeleteData(e){await Object(r["i"])(u["a"].seapi.deleteSensitiveCust,{channelId:this.deleteInfo.DeleteChannelId,custgroupId:this.deleteInfo.DeleteCustgroupId}).then(e=>{e&&(this.$message.success("删除敏感客户群成功"),this.pageData.currentPage=1,this.getSensitiveCustData())})},cellStyle(e){return"触点名称"===e.column.label?"color:#0080CC;cursor: pointer;":0},browse(e){this.$refs["Dialog"].ShowPopup("modify",e)},QueryKeyWords(){this.pageData.currentPage=1,this.queryFrom.keyWords=this.keyWords,this.queryFrom.channelId=this.selectedChannelId,this.queryFrom.custgroupType=this.custgroupType,this.getSensitiveCustData()},QuerySelect(e){this.queryFrom.channelId=e.value,""===e.value&&(this.queryFrom.channelId=null),this.pageData.currentPage=1,this.$forceUpdate(),this.getSensitiveCustData()},MaterAdd(){this.$refs["Dialog"].ShowPopup("MaterAdd")},MaterEdit(e){this.currentRow=e,this.willUpdateForm.custgroupType=e.custgroupType,this.willUpdateForm.channelId=e.channelId.split(",")||[],this.showEditDialog=!0},EditData(){this.$refs["editForm"].validate(e=>{if(!e)return;let t=[];for(let a of this.willUpdateForm.channelId){let e=this.channelData.find(e=>e.channelId===a)&&this.channelData.find(e=>e.channelId===a).channelName;t.push({channelId:a,channelName:e,custgroupType:this.willUpdateForm.custgroupType,custgroupId:this.currentRow.custgroupId})}Object(r["i"])(u["a"].seapi.saveSensitiveCust,t).then(e=>{!0===e&&(this.$message.success("操作成功"),this.showEditDialog=!1,this.getSensitiveCustData())})})},DeleteContact(e,t){this.deleteInfo.DeleteChannelId=e.channelId,this.deleteInfo.DeleteCustgroupId=e.custgroupId,this.deleteInfo.DeleteName=e.channelName+":"+e.custgroupName,this.$refs["Delete"].showDelete()},deleteData(e){this.$confirm("确认删除该数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"errorPrompt"}).then(async()=>{try{const t=await Object(r["i"])(u["a"].seapi.deleteSensitiveCust,{custgroupId:e.custgroupId});if(!0!==t)return void this.$message.error(t.message);this.$message.success("删除成功！"),this.getSensitiveCustData()}catch(t){}}).catch(()=>{})},handleSelectionChange(e){this.multipleSelection=e},deleteMuti(){0!==this.multipleSelection.length?this.$confirm("确认删除选中的数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",customClass:"errorPrompt"}).then(async()=>{let e=[];this.multipleSelection.forEach(t=>{let a={};a.custgroupId=t.custgroupId,e.push(a)});try{const t=await Object(r["i"])(u["a"].seapi.batchDeleteSensitiveCust,e);if("SUCCESS"!==t.status)return void this.$message.error(t.message);this.$message.success(t.message),this.getSensitiveCustData()}catch(t){}}).catch(()=>{}):this.$message.warning("请选择要删除的数据")},handleSizeChange(e){this.pageData.pageSize=e,this.getSensitiveCustData()},handleCurrentChange(e){this.pageData.currentPage=e,this.getSensitiveCustData()},detailClick(e){this.iscontNameDialog=!0,this.contNameList=e,this.$refs["hDialog"].ShowPopup("cont")},closeDialog(){this.iscontNameDialog=!1}}},D=C,w=(a("33c8"),Object(y["a"])(D,l,s,!1,null,"e9f45a08",null));t["default"]=w.exports},"989b":function(e,t,a){},c37e:function(e,t,a){"use strict";a("c56f")},c56f:function(e,t,a){},d6a2:function(e,t,a){"use strict";a("36d4")}}]);