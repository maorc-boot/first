(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59ae44ae"],{"006c":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"链接库",visible:e.dialogVisible,width:"800px",modal:!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"tags"},[t("p",[e._v("已选链接：")]),t("div",e._l(e.tagsList,(function(a){return t("el-tag",{key:a.name,attrs:{closable:"",type:"success"},on:{close:function(t){return e.handleClose(a)}}},[e._v(" "+e._s(a.name)+" ")])})),1)]),t("el-form",{ref:"queryForm",attrs:{model:e.queryForm}},[t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"链接编号：","label-width":"100px"}},[t("el-input",{attrs:{placeholder:"请输入链接编号"},model:{value:e.queryForm.chainedCode,callback:function(t){e.$set(e.queryForm,"chainedCode",t)},expression:"queryForm.chainedCode"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"链接名称：","label-width":"100px"}},[t("el-input",{attrs:{placeholder:"请输入链接名称"},model:{value:e.queryForm.chainName,callback:function(t){e.$set(e.queryForm,"chainName",t)},expression:"queryForm.chainName"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"链接地址：","label-width":"100px"}},[t("el-input",{attrs:{placeholder:"请输入链接地址"},model:{value:e.queryForm.chainDress,callback:function(t){e.$set(e.queryForm,"chainDress",t)},expression:"queryForm.chainDress"}})],1)],1)],1),t("div",{staticStyle:{marginLeft:"81%"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.searchList}},[e._v("查询")]),t("el-button",{attrs:{icon:"el-icon-refresh"}},[e._v("重置")])],1)],1),t("el-table",{staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.chainedData}},[t("el-table-column",{attrs:{prop:"index",label:"序号"}}),t("el-table-column",{attrs:{prop:"date",label:"链接编号"}}),t("el-table-column",{attrs:{prop:"date",label:"链接名称"}}),t("el-table-column",{attrs:{prop:"date",label:"说明"}}),t("el-table-column",{attrs:{prop:"date",label:"关联产品ID"}}),t("el-table-column",{attrs:{prop:"date",label:"关联产品名称"}}),t("el-table-column",{attrs:{prop:"name",label:"关联活动"}}),t("el-table-column",{attrs:{prop:"address",label:"\t创建时间"}}),t("el-table-column",{attrs:{prop:"address",label:"\t创建人"}}),t("el-table-column",{attrs:{prop:"address",label:"\t操作",fixed:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{staticClass:"text-sm mr-16",attrs:{type:"primary",underline:!0},on:{click:function(t){return e.addItem(a.row)}}},[e._v("引用 ")]),t("el-link",{staticClass:"text-sm mr-16",attrs:{type:"primary",underline:!0},on:{click:function(t){return e.copyItem(a.row)}}},[e._v("复制 ")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.queryForm.current,"page-size":e.queryForm.size,layout:"total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n={props:[],data(){return{dialogVisible:!1,tagsList:[],queryForm:{chainedCode:"",chainName:"",chainDress:"",current:1,size:5},total:1,chainedData:[{date:"2016-05-02",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"}]}},created(){},methods:{async getChainedList(e){await Object(l["i"])(o["a"].common.getSmsContentTemplateList,e)},searchList(){this.getChainedList(this.queryForm)},showDialog(e){this.dialogVisible=e},handleCurrentChange(e){this.queryForm.current=e,this.getChainedList(this.queryForm)},handleSizeChange(e){this.queryForm.size=e,this.getChainedList(this.queryForm)},copyItem(e){},addItem(e){this.$set(this.tagsList,0,e)},handleClose(e){this.tagsList.splice(this.tagsList.indexOf(e),1)}}},s=n,m=(a("d1a4"),a("2877")),c=Object(m["a"])(s,r,i,!1,null,"66ea7576",null);t["a"]=c.exports},"00b8":function(e,t,a){"use strict";function r(e){return e.map(e=>`<div><header style="font-size:15px;font-weight:600;color:#2f87ec;">【${e.name}】</header><div style="margin:0 0 5px 8px">${e.content}</div></div>`).join("")}function i(e,t){const a=t.channelId,i=e.contentType,l=e.marketingWords;if("804"===a||"808"===a)"5"==i?(t.columnExt2=l[0].content,t.columnExt5=l[1].content):"6"==i?t.columnExt5=l[0].content:"7"==i?t.columnExt2=l[0].content:"1"==i?(t.columnExt2=r(l[0].list),t.columnExt5=l[1].content):"2"==i?t.columnExt2=r(l[0].list):"3"==i?(t.columnExt2=r(l[0].list),t.columnExt5=l[1].content):"4"==i&&(t.columnExt2=r(l[0].list));else if("809"===a)"5"==i?(t.columnExt2=l[0].content,t.columnExt3=l[1].content):"6"==i?t.columnExt3=l[0].content:"7"==i&&(t.columnExt2=l[0].content);else if("906"===a)"7"===i?t.marketingWords=l[0].content:i<5&&(t.marketingWords=r(l[0].list));else if("924"===a)if("7"==i)"9241"===t.adivInfo.adivId?t.columnExt7=l[0].content:t.EXEC_CONTENT=l[0].content;else if("8"===i)t.columnExt4=l[0].uploadFileUrl||"",t.columnExt6=l[0].linkUrl||"";else if("9"===i){const e=l.find(e=>"1"==e.uploadType),a=l.find(e=>"1"!=e.uploadType);t.columnExt4=e.uploadFileUrl||"",t.columnExt6=e.linkUrl||"",t.columnExt7=a.content}return t}function l(e,t){const a=e.channelId,r=t.contentType,i=t.marketingWords;if("804"===a||"808"===a)"5"==r?(i[0].content=e.columnExt2,i[1].content=e.columnExt5):"6"==r?i=e.columnExt5:"7"==r&&(i[0].content=e.columnExt2);else if("809"===a)"5"==r?(i[0].content=e.columnExt2,i[1].content=e.columnExt3):"6"==r?i=e.columnExt3:"7"==r&&(i[0].content=e.columnExt2);else if("906"===a)"7"==r&&(i[0].content=e.marketingWords);else if("924"===a)if("7"==r)i[0].content=e.EXEC_CONTENT||e.columnExt7;else if("8"==r){var l;i[0].uploadFileUrl=e.columnExt4,i[0].uploadFileName=null===(l=e.columnExt4)||void 0===l?void 0:l.split("/").pop(),i[0].linkUrl=e.columnExt6}else if("9"==r){var o;const t=i.find(e=>"1"==e.uploadType),a=i.find(e=>"1"!=e.uploadType);t.uploadFileUrl=e.columnExt4,t.uploadFileName=null===(o=e.columnExt4)||void 0===o?void 0:o.split("/").pop(),t.linkUrl=e.columnExt6,a.content=e.columnExt7}return t}a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l}))},"0918":function(e,t,a){},"0924":function(e,t,a){"use strict";a("9011")},"0b16":function(e,t,a){"use strict";var r=a("1985");function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var l=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,n=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,s=["<",">",'"',"`"," ","\r","\n","\t"],m=["{","}","|","\\","^","`"].concat(s),c=["'"].concat(m),u=["%","/","?",";","#"].concat(c),d=["/","?","#"],h=255,p=/^[+a-z0-9A-Z_-]{0,63}$/,C=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},f={javascript:!0,"javascript:":!0},b={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=a("4328");function x(e,t,a){if(e&&"object"===typeof e&&e instanceof i)return e;var r=new i;return r.parse(e,t,a),r}function E(e){return"string"===typeof e&&(e=x(e)),e instanceof i?e.format():i.prototype.format.call(e)}function F(e,t){return x(e,!1,!0).resolve(t)}function y(e,t){return e?x(e,!1,!0).resolveObject(t):t}i.prototype.parse=function(e,t,a){if("string"!==typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),o=-1!==i&&i<e.indexOf("#")?"?":"#",s=e.split(o),m=/\\/g;s[0]=s[0].replace(m,"/"),e=s.join(o);var x=e;if(x=x.trim(),!a&&1===e.split("#").length){var E=n.exec(x);if(E)return this.path=x,this.href=x,this.pathname=E[1],E[2]?(this.search=E[2],this.query=t?g.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var F=l.exec(x);if(F){F=F[0];var y=F.toLowerCase();this.protocol=y,x=x.substr(F.length)}if(a||F||x.match(/^\/\/[^@/]+@[^@/]+/)){var I="//"===x.substr(0,2);!I||F&&f[F]||(x=x.substr(2),this.slashes=!0)}if(!f[F]&&(I||F&&!b[F])){for(var k,w,_=-1,N=0;N<d.length;N++){var S=x.indexOf(d[N]);-1!==S&&(-1===_||S<_)&&(_=S)}w=-1===_?x.lastIndexOf("@"):x.lastIndexOf("@",_),-1!==w&&(k=x.slice(0,w),x=x.slice(w+1),this.auth=decodeURIComponent(k)),_=-1;for(N=0;N<u.length;N++){S=x.indexOf(u[N]);-1!==S&&(-1===_||S<_)&&(_=S)}-1===_&&(_=x.length),this.host=x.slice(0,_),x=x.slice(_),this.parseHost(),this.hostname=this.hostname||"";var L="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!L)for(var T=this.hostname.split(/\./),D=(N=0,T.length);N<D;N++){var $=T[N];if($&&!$.match(p)){for(var O="",A=0,j=$.length;A<j;A++)$.charCodeAt(A)>127?O+="x":O+=$[A];if(!O.match(p)){var q=T.slice(0,N),P=T.slice(N+1),M=$.match(C);M&&(q.push(M[1]),P.unshift(M[2])),P.length&&(x="/"+P.join(".")+x),this.hostname=q.join(".");break}}}this.hostname.length>h?this.hostname="":this.hostname=this.hostname.toLowerCase(),L||(this.hostname=r.toASCII(this.hostname));var V=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+V,this.href+=this.host,L&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==x[0]&&(x="/"+x))}if(!v[y])for(N=0,D=c.length;N<D;N++){var R=c[N];if(-1!==x.indexOf(R)){var G=encodeURIComponent(R);G===R&&(G=escape(R)),x=x.split(R).join(G)}}var W=x.indexOf("#");-1!==W&&(this.hash=x.substr(W),x=x.slice(0,W));var B=x.indexOf("?");if(-1!==B?(this.search=x.substr(B),this.query=x.substr(B+1),t&&(this.query=g.parse(this.query)),x=x.slice(0,B)):t&&(this.search="",this.query={}),x&&(this.pathname=x),b[y]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){V=this.pathname||"";var z=this.search||"";this.path=V+z}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",a=this.pathname||"",r=this.hash||"",i=!1,l="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&"object"===typeof this.query&&Object.keys(this.query).length&&(l=g.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||l&&"?"+l||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||b[t])&&!1!==i?(i="//"+(i||""),a&&"/"!==a.charAt(0)&&(a="/"+a)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),o&&"?"!==o.charAt(0)&&(o="?"+o),a=a.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})),o=o.replace("#","%23"),t+i+a+o+r},i.prototype.resolve=function(e){return this.resolveObject(x(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if("string"===typeof e){var t=new i;t.parse(e,!1,!0),e=t}for(var a=new i,r=Object.keys(this),l=0;l<r.length;l++){var o=r[l];a[o]=this[o]}if(a.hash=e.hash,""===e.href)return a.href=a.format(),a;if(e.slashes&&!e.protocol){for(var n=Object.keys(e),s=0;s<n.length;s++){var m=n[s];"protocol"!==m&&(a[m]=e[m])}return b[a.protocol]&&a.hostname&&!a.pathname&&(a.pathname="/",a.path=a.pathname),a.href=a.format(),a}if(e.protocol&&e.protocol!==a.protocol){if(!b[e.protocol]){for(var c=Object.keys(e),u=0;u<c.length;u++){var d=c[u];a[d]=e[d]}return a.href=a.format(),a}if(a.protocol=e.protocol,e.host||f[e.protocol])a.pathname=e.pathname;else{var h=(e.pathname||"").split("/");while(h.length&&!(e.host=h.shift()));e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),a.pathname=h.join("/")}if(a.search=e.search,a.query=e.query,a.host=e.host||"",a.auth=e.auth,a.hostname=e.hostname||e.host,a.port=e.port,a.pathname||a.search){var p=a.pathname||"",C=a.search||"";a.path=p+C}return a.slashes=a.slashes||e.slashes,a.href=a.format(),a}var v=a.pathname&&"/"===a.pathname.charAt(0),g=e.host||e.pathname&&"/"===e.pathname.charAt(0),x=g||v||a.host&&e.pathname,E=x,F=a.pathname&&a.pathname.split("/")||[],y=(h=e.pathname&&e.pathname.split("/")||[],a.protocol&&!b[a.protocol]);if(y&&(a.hostname="",a.port=null,a.host&&(""===F[0]?F[0]=a.host:F.unshift(a.host)),a.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),x=x&&(""===h[0]||""===F[0])),g)a.host=e.host||""===e.host?e.host:a.host,a.hostname=e.hostname||""===e.hostname?e.hostname:a.hostname,a.search=e.search,a.query=e.query,F=h;else if(h.length)F||(F=[]),F.pop(),F=F.concat(h),a.search=e.search,a.query=e.query;else if(null!=e.search){if(y){a.host=F.shift(),a.hostname=a.host;var I=!!(a.host&&a.host.indexOf("@")>0)&&a.host.split("@");I&&(a.auth=I.shift(),a.hostname=I.shift(),a.host=a.hostname)}return a.search=e.search,a.query=e.query,null===a.pathname&&null===a.search||(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.href=a.format(),a}if(!F.length)return a.pathname=null,a.search?a.path="/"+a.search:a.path=null,a.href=a.format(),a;for(var k=F.slice(-1)[0],w=(a.host||e.host||F.length>1)&&("."===k||".."===k)||""===k,_=0,N=F.length;N>=0;N--)k=F[N],"."===k?F.splice(N,1):".."===k?(F.splice(N,1),_++):_&&(F.splice(N,1),_--);if(!x&&!E)for(;_--;_)F.unshift("..");!x||""===F[0]||F[0]&&"/"===F[0].charAt(0)||F.unshift(""),w&&"/"!==F.join("/").substr(-1)&&F.push("");var S=""===F[0]||F[0]&&"/"===F[0].charAt(0);if(y){a.hostname=S?"":F.length?F.shift():"",a.host=a.hostname;I=!!(a.host&&a.host.indexOf("@")>0)&&a.host.split("@");I&&(a.auth=I.shift(),a.hostname=I.shift(),a.host=a.hostname)}return x=x||a.host&&F.length,x&&!S&&F.unshift(""),F.length>0?a.pathname=F.join("/"):(a.pathname=null,a.path=null),null===a.pathname&&null===a.search||(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.auth=e.auth||a.auth,a.slashes=a.slashes||e.slashes,a.href=a.format(),a},i.prototype.parseHost=function(){var e=this.host,t=o.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.parse=x,t.resolve=F,t.resolveObject=y,t.format=E,t.Url=i},"0d29":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1),t("div",{staticClass:"header"},[t("el-form-item",{attrs:{label:"活动类型：",prop:"columnExt2"}},[t("el-select",{attrs:{placeholder:"请选择活动类型"},on:{change:e.changeAid},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"标准化素材：",prop:"columnExt20"}},[t("div",{staticClass:"select-material",on:{click:function(t){return e.selectMaterial(!0)}}},[e._v(e._s(e.CrmFrom.materialName||"请选择"))])])],1)],1),t("el-form-item",{attrs:{label:"客户群规则：",prop:"columnExt3"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":"",rows:8,placeholder:"您还可以输入500个字"},model:{value:e.CrmFrom.columnExt3,callback:function(t){e.$set(e.CrmFrom,"columnExt3",t)},expression:"CrmFrom.columnExt3"}})],1),e.showExt18?t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1):e._e(),t("el-form-item",{attrs:{label:"营销用语：",prop:"marketingWords"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.marketingWords,callback:function(t){e.$set(e.CrmFrom,"marketingWords",t)},expression:"CrmFrom.marketingWords"}})],1)],1),t("materialList",{ref:"material",attrs:{channelId:e.id,adivId:e.CrmFrom.adivInfo.adivId},on:{addMaterial:e.addMaterial}})],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("b893"),s=a("f1ce"),m=a("5ed5");a("0b16");const c=o["a"].common.getSysEnum,u=o["a"].common.queryAdivInfo,d=o["a"].common.queryHallInfo;var h={props:["channelNewData","id"],components:{materialList:s["a"],Tips:m["a"]},data(){return{CrmFrom:{adivInfo:{},channelId:"",channelName:"",attributionInfo:{},standard:"",CustomerRules:"",marketingWords:"",policy:"",activityType:"",columnExt1:"1",columnExt2:"",columnExt3:"",columnExt18:"0",columnExt20:""},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{activityType:[{required:!0,message:"请选择活动类型",trigger:"blur"}],columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],columnExt2:[{required:!0,message:"请选择活动类型",trigger:"blur"}],standard:[{required:!0,message:"请选择标准化素材",trigger:"change"}],CustomerRules:[{required:!0,message:"请输入客户群规则",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],policy:[{required:!0,message:"请输入活动政策",trigger:"change"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[]}},watch:{channelNewData:{handler(){this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0}},mounted(){this.getOptionData(),this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(c,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(u,{channelId:this.id}).then(e=>{this.adivList=e}),await Object(l["i"])(d,{}).then(e=>{this.attributionList=e})},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},selectMaterial(e){this.$refs["material"].getMaterialList(),this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}}},created(){}},p=h,C=(a("aabc"),a("2877")),v=Object(C["a"])(p,r,i,!1,null,"59c0a972",null);t["a"]=v.exports},"0dd9":function(e,t,a){"use strict";a("1cb6")},"0ed7":function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return n}));var r=a("0fea"),i=a("cdbb");async function l(e){return Object(r["i"])(i["a"].getScriptPreview+"?scriptId="+e)}async function o(e){return Object(r["i"])(i["a"].clickScript+"?scriptId="+e)}async function n(){const e=await Object(r["g"])(i["a"].getTermRule);return e}},"0ef1":function(e,t,a){"use strict";a("409c")},"12ed":function(e,t,a){"use strict";a("526e")},1326:function(e,t,a){},"138c":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"CrmFrom",attrs:{"label-width":"110px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},model:{value:e.CrmFrom.adivId,callback:function(t){e.$set(e.CrmFrom,"adivId",t)},expression:"CrmFrom.adivId"}},e._l(e.timeIdList,(function(e){return t("el-option",{key:e.enumKey,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("el-form-item",{attrs:{label:"外呼类型：",prop:"outCallType"}},[t("el-select",{attrs:{placeholder:"请选择外呼类型"},model:{value:e.CrmFrom.outCallType,callback:function(t){e.$set(e.CrmFrom,"outCallType",t)},expression:"CrmFrom.outCallType"}},e._l(e.callTypeList,(function(e){return t("el-option",{key:e.enumKey,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("el-form-item",{attrs:{label:"推荐用语：",prop:"markingTerm"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.markingTerm,callback:function(t){e.$set(e.CrmFrom,"markingTerm",t)},expression:"CrmFrom.markingTerm"}})],1),t("el-form-item",{attrs:{label:"时机选择："}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.CrmFrom.timeId,callback:function(t){e.$set(e.CrmFrom,"timeId",t)},expression:"CrmFrom.timeId"}},e._l(e.timeIdList,(function(e){return t("el-option",{key:e.enumKey,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("el-form-item",{attrs:{label:"时间描述："}},[t("el-input",{attrs:{type:"textarea",maxlength:"240","show-word-limit":""},model:{value:e.CrmFrom.timeDistindes,callback:function(t){e.$set(e.CrmFrom,"timeDistindes",t)},expression:"CrmFrom.timeDistindes"}})],1),t("el-form-item",[t("el-button",{on:{click:e.SubInstall}},[e._v("保存当前设置")])],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05");const n=o["a"].common.getSysEnum,s=o["a"].common.queryAdivInfo;var m={props:["channelId"],data(){return{CrmFrom:{},CrmFromRules:{adivId:[{required:!0,message:"请选择运营位",trigger:"blur,change"}],outCallType:[{required:!0,message:"请选择外呼类型",trigger:"blur,change"}],markingTerm:[{required:!0,message:"请输入推荐用语",trigger:"blur"}]},callTypeList:[],timeIdList:[],adivList:[]}},mounted(){this.getOptionData()},methods:{getOptionData(){Object(l["i"])(n,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),Object(l["i"])(n,{enumType:"E_610_OUT_CALL_TYPE"}).then(e=>{this.callTypeList=e}),Object(l["i"])(s,{channelId:this.channelId}).then(e=>{this.adivList=e})},SubInstall(){this.$refs.CrmFrom.validate(e=>{})}}},c=m,u=a("2877"),d=Object(u["a"])(c,r,i,!1,null,"f977bdd4",null);t["a"]=d.exports},"14ea":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"标准化素材：",prop:"columnExt20"}},[t("div",{staticClass:"select-material",on:{click:function(t){return e.selectMaterial(!0)}}},[e._v(e._s(e.CrmFrom.materialName||"请选择"))])])],1),e.showExt18?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1)],1):e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"营销用语：",prop:"EXEC_CONTENT"}},[t("el-input",{attrs:{id:"smsDetail",type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.EXEC_CONTENT,callback:function(t){e.$set(e.CrmFrom,"EXEC_CONTENT",t)},expression:"CrmFrom.EXEC_CONTENT"}})],1)],1),t("el-col",{attrs:{span:24}},[1==e.custgroupSource?t("el-form-item",{attrs:{label:"营销用语替换变量："}},[t("DNAReplaceVar",{on:{getVar:e.getContent}})],1):t("el-form-item",{attrs:{label:"营销用语替换变量：","label-width":"148px"}},e._l(e.replaceVar,(function(a){return t("el-tag",{key:a.id,attrs:{type:"info"},on:{click:function(t){return e.getContent(a.attrCol)}}},[e._v(e._s(a.attrColName))])})),1)],1)],1)],1),t("materialList",{ref:"material",attrs:{adivId:e.CrmFrom.adivInfo.adivId,channelId:e.id},on:{addMaterial:e.addMaterial}})],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("f1ce"),s=a("5ed5"),m=a("6501");a("0b16");o["a"].common.getSysEnum;const c=o["a"].common.queryAdivInfo;o["a"].common.queryHallInfo;var u={props:["channelNewData","id","deleteSub"],components:{materialList:n["a"],Tips:s["a"],DNAReplaceVar:m["a"]},data(){return{CrmFrom:{adivInfo:{},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",standard:"",CustomerRules:"",marketingWords:"",columnExt2:"",columnExt3:"",columnExt4:"",columnExt18:"0",EXEC_CONTENT:"",IF_HAVE_VAR:"0"},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],EXEC_CONTENT:[{required:!0,message:"请输入营销用语",trigger:"blur"}],columnExt4:[{required:!0,message:"请选择任务类型",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],replaceVar:[]}},watch:{channelNewData:{handler(){this.CrmFrom=JSON.parse(JSON.stringify(this.channelNewData)),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0},CrmFrom:{handler(e,t){},deep:!0},deleteSub(){},SMS_CONTENT(e){if(e){const t=/\$[a-zA-Z0-9_\u4e00-\u9fa5]+\$/g,a=e.match(t);a&&a.length>0?this.CrmFrom.IF_HAVE_VAR="1":this.CrmFrom.IF_HAVE_VAR="0"}else this.CrmFrom.IF_HAVE_VAR="0"}},computed:{SMS_CONTENT(){return this.CrmFrom.EXEC_CONTENT},custgroupSource(){return this.$store.state.extendData.custgroupSource}},mounted(){this.getOptionData(),this.listCustAttr(),this.CrmFrom=JSON.parse(JSON.stringify(this.channelNewData)),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(c,{channelId:this.id}).then(e=>{this.adivList=e})},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},async listCustAttr(){var e;const t=null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId;await Object(l["i"])(o["a"].common.listCustAttr+"?custGroupId="+t).then(e=>{this.replaceVar=e})},getContent(e){let t="$"+e+"$";e=t,this.ShortMsgContent=e;const a=document.querySelector("#smsDetail");if(a.selectionStart||0===a.selectionStart){var r=a.selectionStart,i=a.selectionEnd;this.CrmFrom={...this.CrmFrom,EXEC_CONTENT:a.value.substring(0,r)+e+a.value.substring(i,a.value.length)},this.$nextTick(),a.focus(),a.setSelectionRange(i+e.length,i+e.length)}else this.CrmFrom.EXEC_CONTENT+=e},selectMaterial(e){this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}}},created(){}},d=u,h=(a("b953"),a("2877")),p=Object(h["a"])(d,r,i,!1,null,"aeeb524e",null);t["a"]=p.exports},"17e3":function(e,t,a){},"180b":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"物料列表",visible:e.dialogVisible,width:"60%","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",[t("el-input",{staticStyle:{width:"30%"},attrs:{placeholder:"请输入搜索内容"}},[t("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},slot:"suffix"})])],1),t("el-table",{staticStyle:{width:"100%"}},[t("el-table-column",{staticStyle:{width:"30%"},attrs:{label:"物料编码"}}),t("el-table-column",{staticStyle:{width:"30%"},attrs:{label:"物料名称"}}),t("el-table-column",{staticStyle:{width:"30%"},attrs:{label:"目标地址"}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)],1)],1)},i=[],l={name:"GroupHandDialog",data(){return{dialogVisible:!0}},methods:{}},o=l,n=a("2877"),s=Object(n["a"])(o,r,i,!1,null,null,null);t["a"]=s.exports},1985:function(e,t,a){(function(e,r){var i;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(l){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof r&&r;o.global!==o&&o.window!==o&&o.self;var n,s=2147483647,m=36,c=1,u=26,d=38,h=700,p=72,C=128,v="-",f=/^xn--/,b=/[^\x20-\x7E]/,g=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=m-c,F=Math.floor,y=String.fromCharCode;function I(e){throw new RangeError(x[e])}function k(e,t){var a=e.length,r=[];while(a--)r[a]=t(e[a]);return r}function w(e,t){var a=e.split("@"),r="";a.length>1&&(r=a[0]+"@",e=a[1]),e=e.replace(g,".");var i=e.split("."),l=k(i,t).join(".");return r+l}function _(e){var t,a,r=[],i=0,l=e.length;while(i<l)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<l?(a=e.charCodeAt(i++),56320==(64512&a)?r.push(((1023&t)<<10)+(1023&a)+65536):(r.push(t),i--)):r.push(t);return r}function N(e){return k(e,(function(e){var t="";return e>65535&&(e-=65536,t+=y(e>>>10&1023|55296),e=56320|1023&e),t+=y(e),t})).join("")}function S(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:m}function L(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function T(e,t,a){var r=0;for(e=a?F(e/h):e>>1,e+=F(e/t);e>E*u>>1;r+=m)e=F(e/E);return F(r+(E+1)*e/(e+d))}function D(e){var t,a,r,i,l,o,n,d,h,f,b=[],g=e.length,x=0,E=C,y=p;for(a=e.lastIndexOf(v),a<0&&(a=0),r=0;r<a;++r)e.charCodeAt(r)>=128&&I("not-basic"),b.push(e.charCodeAt(r));for(i=a>0?a+1:0;i<g;){for(l=x,o=1,n=m;;n+=m){if(i>=g&&I("invalid-input"),d=S(e.charCodeAt(i++)),(d>=m||d>F((s-x)/o))&&I("overflow"),x+=d*o,h=n<=y?c:n>=y+u?u:n-y,d<h)break;f=m-h,o>F(s/f)&&I("overflow"),o*=f}t=b.length+1,y=T(x-l,t,0==l),F(x/t)>s-E&&I("overflow"),E+=F(x/t),x%=t,b.splice(x++,0,E)}return N(b)}function $(e){var t,a,r,i,l,o,n,d,h,f,b,g,x,E,k,w=[];for(e=_(e),g=e.length,t=C,a=0,l=p,o=0;o<g;++o)b=e[o],b<128&&w.push(y(b));r=i=w.length,i&&w.push(v);while(r<g){for(n=s,o=0;o<g;++o)b=e[o],b>=t&&b<n&&(n=b);for(x=r+1,n-t>F((s-a)/x)&&I("overflow"),a+=(n-t)*x,t=n,o=0;o<g;++o)if(b=e[o],b<t&&++a>s&&I("overflow"),b==t){for(d=a,h=m;;h+=m){if(f=h<=l?c:h>=l+u?u:h-l,d<f)break;k=d-f,E=m-f,w.push(y(L(f+k%E,0))),d=F(k/E)}w.push(y(L(d,0))),l=T(a,x,r==i),a=0,++r}++a,++t}return w.join("")}function O(e){return w(e,(function(e){return f.test(e)?D(e.slice(4).toLowerCase()):e}))}function A(e){return w(e,(function(e){return b.test(e)?"xn--"+$(e):e}))}n={version:"1.4.1",ucs2:{decode:_,encode:N},decode:D,encode:$,toASCII:A,toUnicode:O},i=function(){return n}.call(t,a,t,e),void 0===i||(e.exports=i)})()}).call(this,a("62e4")(e),a("c8ba"))},"1a65":function(e,t,a){},"1bd8":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("BaseDialog",{attrs:{title:"话术预览",visible:e.dialogVisible,width:"1000px",top:"5vh","confirm-button-text":"关 闭","show-cancel-button":!1},on:{confirm:e.close,close:e.close},scopedSlots:e._u([e.enableEvaluate&&e.form.scriptId?{key:"footerBtn",fn:function(){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.evaluteVisible=!0}}},[e._v("评价")]),t("el-button",{attrs:{type:"warning",loading:e.likeLoading},on:{click:e.like}},[e._v("点赞")])]},proxy:!0}:null],null,!0)},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"label-width":"120px"}},[t("el-form-item",{attrs:{label:"话术名称："}},[e._v(" "+e._s(e.form.scriptName)+" ")]),t("el-form-item",{attrs:{label:"产品编码/名称："}},[e.form.planId?t("span",[e._v(" "+e._s(e.form.planId+" "+e.form.planName)+" ")]):e._e()]),t("el-form-item",{attrs:{label:"话术类型："}},[e._v(" "+e._s(e.form.scriptTypeName)+" ")]),t("el-form-item",{attrs:{label:"应用渠道："}},[e._v(" "+e._s(e.form.channelName)+" ")]),t("el-form-item",{attrs:{label:"运营位："}},[e._v(" "+e._s(e.form.adivName)+" ")]),"2"===e.form.scriptType?t("el-form-item",{attrs:{label:"应用地市："}},[e._v(" "+e._s(e.form.cityName)+" ")]):e._e(),t("el-form-item",{attrs:{label:"内容类型："}},[e._v(" "+e._s(e.form.contentTypeName)+" ")]),t("el-form-item",{attrs:{label:"话术内容："}},[t("MarketingWordsPreview",{attrs:{marketingWords:e.form.marketingWords||[]}})],1)],1),e.enableEvaluate?t("EvaluateDialog",{attrs:{currentRow:e.form,dialogVisible:e.evaluteVisible},on:{"update:dialogVisible":function(t){e.evaluteVisible=t},"update:dialog-visible":function(t){e.evaluteVisible=t}}}):e._e()],1)},i=[],l=a("ea45"),o=a("2102"),n=a("571b"),s=a("0ed7"),m=a("5a4a"),c=a("ac7c"),u={components:{BaseDialog:l["a"],MarketingWordsPreview:o["a"],EvaluateDialog:n["a"]},props:{dialogVisible:{type:Boolean,default:!1},id:{type:String|Number,default:""},enableEvaluate:{type:Boolean,default:!1}},watch:{dialogVisible(e){e?this.getScriptInfo():this.$nextTick(()=>{this.form={}})}},data(){return{loading:!1,form:{},evaluteVisible:!1,likeLoading:!1}},methods:{async getScriptInfo(){try{var e,t;this.loading=!0;const a=await Object(s["b"])(this.id);a.contentTypeName=null===(e=c["a"].find(e=>e.value==a.contentType))||void 0===e?void 0:e.label,a.scriptTypeName=null===(t=c["j"].find(e=>e.value==a.scriptType))||void 0===t?void 0:t.label,this.form=Object(m["c"])(a)}catch(a){this.form={}}finally{this.loading=!1}},async like(){try{this.likeLoading=!0;const e=await Object(s["c"])(this.form.scriptId);this.$message.success(e.message)}catch(e){}finally{this.likeLoading=!1}},close(){this.$emit("update:dialogVisible",!1)}}},d=u,h=(a("c0ec"),a("2877")),p=Object(h["a"])(d,r,i,!1,null,"836eb7b0",null);t["a"]=p.exports},"1c07":function(e,t,a){"use strict";a("77fd")},"1cb6":function(e,t,a){},"20d5":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"135px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1),t("div",{staticClass:"header"},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1)],1),e.CrmFrom.adivInfo.adivId?t("UseScript",{ref:"useScript",attrs:{"label-width":"135px","channel-id":e.channelNewData.channelId,"channel-name":e.channelNewData.channelName,"script-id":e.CrmFrom.columnExt19,CrmFrom:e.CrmFrom},on:{change:e.changeScript}}):e._e(),e.showExt18?t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1):e._e(),t("el-form-item",{attrs:{label:"营销用语：",prop:"columnExt2"}},[e.isStrArr?t("Face2FaceWords",{attrs:{marketingWords:e.CrmFrom.columnExt2}}):t("el-input",{ref:"wording",attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}})],1),t("el-form-item",{attrs:{label:"短信模板：",prop:"columnExt5"}},[t("el-input",{attrs:{maxlength:"300",type:"textarea","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt5,callback:function(t){e.$set(e.CrmFrom,"columnExt5",t)},expression:"CrmFrom.columnExt5"}})],1),t("el-form-item",{attrs:{label:"客户群规则描述：",prop:"columnExt3"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":"",rows:8,placeholder:"您还可以输入500个字"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleTextareaKeydown.apply(null,arguments)}},model:{value:e.CrmFrom.columnExt3,callback:function(t){e.$set(e.CrmFrom,"columnExt3",t)},expression:"CrmFrom.columnExt3"}})],1),e._e(),t("el-form-item",{attrs:{label:"活动政策：",prop:"columnExt4"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleTextareaKeydown.apply(null,arguments)}},model:{value:e.CrmFrom.columnExt4,callback:function(t){e.$set(e.CrmFrom,"columnExt4",t)},expression:"CrmFrom.columnExt4"}})],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("b893"),s=a("00b8"),m=a("f1ce"),c=a("5ed5"),u=a("98d2"),d=a("cd74");const h=o["a"].common.getSysEnum,p=o["a"].common.queryAdivInfo,C=o["a"].common.queryHallInfo;var v={props:["channelNewData","id"],components:{materialList:m["a"],Tips:c["a"],UseScript:u["a"],Face2FaceWords:d["a"]},data(){return{CrmFrom:{isOneKey:null,adivInfo:{},channelConf:{},channelId:"",channelName:"",attributionInfo:{},standard:"",CustomerRules:"",marketingWords:"",policy:"",shortInfo:"",columnExt1:"",columnExt3:"",columnExt2:"",columnExt4:"",columnExt5:"",columnExt18:"0",columnExt19:"",columnExt20:""},CrmFromRules:{isOneKey:[{required:!0,message:"是否一键办理",trigger:"change"}],columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],standard:[{required:!1,message:"请选择标准化素材",trigger:"blur"}],columnExt3:[{required:!0,message:"请输入客户群规则",trigger:"blur"}],columnExt2:[{required:!0,message:"请输入营销话术",trigger:"blur"}],columnExt4:[{required:!0,message:"请输入活动政策",trigger:"blur"}],columnExt5:[{required:!0,message:"请输入短信模板",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},showExt18:!1,checkColumnExt18:!1,timeIdList:[],adivList:[],attributionList:[],labelConfig:{variable:[{name:"可呼时段",value:"${1234561}"},{name:"可呼时段2",value:"${123456}3"},{name:"可呼时段3",value:"${123456}4"},{name:"可呼时段4",value:"${123456}5"},{name:"可呼时段5",value:"${14r3456}5"}],touchPoint:[{name:"可呼时段",value:"${123456}5"},{name:"可呼时段g",value:"${123456}r"},{name:"可呼时段b",value:"${123456}g"},{name:"可呼时段t",value:"${123456}b"}]},lableProp:"variable",isStrArr:!1}},watch:{channelNewData:{handler(){if(this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.CrmFrom.columnExt19&&this.CrmFrom.columnExt2)try{this.isStrArr=this.CrmFrom.columnExt2.includes("</header>")}catch(e){}this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0}},created(){if(this.getOptionData(),this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt2",this.CrmFrom.columnExt2||""),this.CrmFrom.columnExt19&&this.CrmFrom.columnExt2)try{this.isStrArr=this.CrmFrom.columnExt2.includes("</header>")}catch(e){}this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(h,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(p,{channelId:this.id}).then(e=>{this.adivList=e}),await Object(l["i"])(C,{}).then(e=>{this.attributionList=e})},changeAid(e){const t=this.adivList.find(t=>t.adivId===e);this.$set(this.CrmFrom,"adivInfo",{adivId:(null===t||void 0===t?void 0:t.adivId)||"",adivName:(null===t||void 0===t?void 0:t.adivName)||""}),this.isStrArr=!1,this.CrmFrom.columnExt19="",this.CrmFrom.columnExt2="",this.CrmFrom.columnExt5="",this.$refs.useScript&&this.$nextTick(()=>{this.$refs.useScript.getScriptList()})},changeAttribution(e){var t="";this.attributionList.forEach(a=>{e===a.adivId&&(t=a.attributionName)}),this.CrmFrom.attributionInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,attributionName:t})},changeTime(){this.timeIdList.forEach(e=>{e.enumKey===this.CrmFrom.timeId&&(this.CrmFrom.timeName=e.enumValue)})},async SubInstall(){const e=!0;let t=!0;return this.$refs.CrmFrom.validate(a=>{a&&e?(this.$emit("saveChannelData",this.CrmFrom),t=!0):t=!1}),t},selectMaterial(e){this.$refs["material"].getMaterialList(),this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}},addWord(e){void 0===this.CrmFrom.columnExt2&&(this.CrmFrom.columnExt2=""),this.CrmFrom.columnExt2+=e,this.$forceUpdate(),this.$refs.wording.$el.querySelector(".el-textarea__inner").focus()},handleTextareaKeydown(){let e=arguments[0];if("Enter"===e.key||"Enter"===e.code||13==e.keyCode)return e.returnValue=!1,!1},changeScript(e){if(this.CrmFrom.columnExt19=e.scriptId,!e.scriptId&&this.isStrArr)return this.$set(this.CrmFrom,"columnExt2",""),this.$set(this.CrmFrom,"columnExt5",""),void(this.isStrArr=!1);this.isStrArr=!1,e.contentType<5&&(this.isStrArr=!0),this.CrmFrom=Object(s["a"])(e,this.CrmFrom),this.$forceUpdate()}}},f=v,b=(a("854d"),a("2877")),g=Object(b["a"])(f,r,i,!1,null,"c04112ae",null);t["a"]=g.exports},2102:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"script-container"},[t("el-form",e._l(e.marketingWords,(function(a,r){var i;return t("el-form-item",{key:r,attrs:{label:e.marketingWords.length>1?a.typeName+"：":"","label-width":e.marketingWords.length>1?"100px":"10px"}},[a.list&&a.list.length?e._l(a.list,(function(a){return t("div",{key:a.name},[t("header",[e._v("【"+e._s(a.name)+"】")]),t("div",{domProps:{innerHTML:e._s(a.content)}})])})):e._e(),a.uploadType||null!==(i=a.list)&&void 0!==i&&i.length?e._e():t("span",[e._v(e._s(a.content))]),a.uploadType?[t("Upload",{attrs:{"is-view":!0,type:"1"==a.uploadType?"image":"2"==a.uploadType?"video":"3"==a.uploadType?"audio":"image"},model:{value:e.marketingWords[r],callback:function(t){e.$set(e.marketingWords,r,t)},expression:"marketingWords[i]"}}),t("div",{staticClass:"link"},[t("span",[e._v("跳转链接：")]),t("el-link",{attrs:{underline:!1,href:a.linkUrl,target:"_blank"}},[e._v(e._s(a.linkUrl))])],1)]:e._e()],2)})),1)],1)},i=[],l=a("eae4"),o={components:{Upload:l["a"]},props:{marketingWords:{type:Array,default:()=>[]}}},n=o,s=(a("327a"),a("2877")),m=Object(s["a"])(n,r,i,!1,null,"4a48a557",null);t["a"]=m.exports},"226f":function(e,t,a){},2486:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"CrmFrom",attrs:{"label-width":"100px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivId,callback:function(t){e.$set(e.CrmFrom,"adivId",t)},expression:"CrmFrom.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"物料：",prop:"material"}},[t("el-input",{staticStyle:{width:"60%"},on:{focus:e.preMaterial},model:{value:e.CrmFrom.material,callback:function(t){e.$set(e.CrmFrom,"material",t)},expression:"CrmFrom.material"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.preview}},[e._v(" 预览 ")])],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"产品价格",prop:"proPrice"}},[t("el-input",{staticStyle:{width:"60%"},model:{value:e.CrmFrom.proPrice,callback:function(t){e.$set(e.CrmFrom,"proPrice",t)},expression:"CrmFrom.proPrice"}})],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"URL链接：",prop:"urlLink"}},[t("el-input",{staticStyle:{width:"60%"},model:{value:e.CrmFrom.urlLink,callback:function(t){e.$set(e.CrmFrom,"urlLink",t)},expression:"CrmFrom.urlLink"}})],1),t("el-form-item",{attrs:{label:"优先级：",prop:"priorityOrder"}},[t("div",{staticClass:"block"},[t("el-slider",{attrs:{"show-input":""},model:{value:e.CrmFrom.priorityOrder,callback:function(t){e.$set(e.CrmFrom,"priorityOrder",t)},expression:"CrmFrom.priorityOrder"}})],1)]),t("el-form-item",{attrs:{label:"时机选择："}},[t("el-select",{attrs:{placeholder:"请选择"},on:{click:e.changeTime},model:{value:e.CrmFrom.timeId,callback:function(t){e.$set(e.CrmFrom,"timeId",t)},expression:"CrmFrom.timeId"}},e._l(e.timeIdList,(function(e){return t("el-option",{key:e.enumKey,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("el-form-item",{attrs:{label:"时机描述："}},[t("el-input",{attrs:{type:"textarea",maxlength:"240","show-word-limit":""},model:{value:e.CrmFrom.timeDistindes,callback:function(t){e.$set(e.CrmFrom,"timeDistindes",t)},expression:"CrmFrom.timeDistindes"}})],1),t("el-form-item",[t("el-button",{on:{click:e.SubInstall}},[e._v("保存当前设置")])],1)],1),!0===e.gHandIsShow?t("group-hand-dialog"):e._e()],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("180b");const s=o["a"].common.getSysEnum,m=o["a"].common.queryAdivInfo;var c={props:["channelId","channelData"],components:{GroupHandDialog:n["a"]},data(){return{CrmFrom:{adivId:null,material:null,proPrice:null,urlLink:null,priorityOrder:null,timeId:null,timeDistindes:null},CrmFromRules:{adivId:[{required:!0,message:"请选择运营位",trigger:"blur,change"}],material:[{required:!0,message:"请选择物料",trigger:"blur"}],urlLink:[{required:!0,message:"请输入URL链接",trigger:"blur"}]},timeIdList:[],adivList:[],gHandIsShow:!1}},mounted(){var e;this.CrmFrom=null!==(e=this.channelData)&&void 0!==e?e:this.CrmFrom,this.getOptionData()},methods:{getOptionData(){Object(l["i"])(m,{channelId:this.channelId}).then(e=>{this.adivList=e}),Object(l["i"])(s,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e})},changeAid(){this.adivList.forEach(e=>{(this.CrmFrom.adivId=e.adivId)&&(this.CrmFrom.adivName=e.adivName)})},changeTime(){this.timeIdList.forEach(e=>{e.enumKey===this.CrmFrom.timeId&&(this.CrmFrom.timeName=e.enumValue)})},preMaterial(){this.gHandIsShow=!this.gHandIsShow},preview(){this.$alert("没有可预览的材料",{confirmButtonText:"确定"})},SubInstall(){this.$refs.CrmFrom.validate(e=>{e&&this.$emit("saveChannelData",this.CrmFrom)})}}},u=c,d=a("2877"),h=Object(d["a"])(u,r,i,!1,null,"9ee5996c",null);t["a"]=h.exports},"2ad0":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("div",{staticStyle:{display:"flex","justify-content":"end"}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"150px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"标准化素材：",prop:"columnExt20"}},[t("div",{staticClass:"select-material",on:{click:function(t){return e.selectMaterial(!0)}}},[e._v(e._s(e.CrmFrom.materialName||"请选择"))])])],1),"9572"===e.CrmFrom.adivInfo.adivId?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"项目层级二：",prop:"columnExt6"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeProjectLevel2},model:{value:e.CrmFrom.columnExt6,callback:function(t){e.$set(e.CrmFrom,"columnExt6",t)},expression:"CrmFrom.columnExt6"}},e._l(e.projectLevel2,(function(e){return t("el-option",{key:e.id,attrs:{label:e.levelValue,value:e.id}})})),1)],1)],1):e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"营销类型：",prop:"saleType"}},[t("el-select",{attrs:{placeholder:"请选择营销类型",disabled:"9572"===e.CrmFrom.adivInfo.adivId},on:{change:e.changeSaleType},model:{value:e.CrmFrom.saleType,callback:function(t){e.$set(e.CrmFrom,"saleType",t)},expression:"CrmFrom.saleType"}},e._l(e.saleList,(function(a){return t("el-option",{key:a.value,attrs:{label:a.label,value:a.value,disabled:("10086JXVR1101IVR102"===e.CrmFrom.adivInfo.adivId||"10086JXVR1101IVR101"===e.CrmFrom.adivInfo.adivId)&&"1"===a.value}})})),1)],1)],1),"9572"===e.CrmFrom.adivInfo.adivId?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"项目层级三：",prop:"columnExt7"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeProjectLevel3},model:{value:e.CrmFrom.columnExt7,callback:function(t){e.$set(e.CrmFrom,"columnExt7",t)},expression:"CrmFrom.columnExt7"}},e._l(e.projectLevel3,(function(e){return t("el-option",{key:e.id,attrs:{label:e.levelValue,value:e.id}})})),1)],1)],1):e._e(),"1"===e.CrmFrom.saleType?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"复杂事件场景：",prop:"CEP_EVENT_ID"}},[t("div",[t("div",{staticStyle:{display:"flex","justify-content":"space-between","max-width":"375px"}},[t("div",{staticClass:"add-botton"},[t("span",{on:{click:function(t){return e.openSceneDilog(!0)}}},[e._v(e._s(e.CrmFrom.sceneParams.eventName||"添加"))]),t("i",{directives:[{name:"show",rawName:"v-show",value:e.CrmFrom.sceneParams.eventName,expression:"CrmFrom.sceneParams.eventName"}],staticClass:"el-icon-close",on:{click:e.removeEvent}})]),t("el-checkbox",{model:{value:e.CrmFrom.checked,callback:function(t){e.$set(e.CrmFrom,"checked",t)},expression:"CrmFrom.checked"}},[e._v("取消推荐规则设置")])],1),"JX0000000001"===e.customGroupId?t("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("该活动没有限定客群，触发事件即发送，请慎重选择事件！")]):e._e(),e.CrmFrom.checked?t("div",{staticClass:"select"},[t("div",{staticClass:"setRules"},[t("p",[e._v("已选择事件："+e._s(e.CrmFrom.sceneParams.eventName))])]),t("div",[t("span",[e._v("取消推荐时间：")]),t("el-select",{attrs:{placeholder:"请选择执行端口",size:"mini"},model:{value:e.CrmFrom.columnExt4,callback:function(t){e.$set(e.CrmFrom,"columnExt4",t)},expression:"CrmFrom.columnExt4"}},e._l(e.columnExt4List,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]):e._e()])])],1):e._e(),"9572"===e.CrmFrom.adivInfo.adivId?[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"营销(服务)目标客户及提取规则：",prop:"columnExt10"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.columnExt10,callback:function(t){e.$set(e.CrmFrom,"columnExt10",t)},expression:"CrmFrom.columnExt10"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"任务描述及要求：",prop:"columnExt11","label-width":"148px"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.columnExt11,callback:function(t){e.$set(e.CrmFrom,"columnExt11",t)},expression:"CrmFrom.columnExt11"}})],1)],1)]:e._e(),e.showExt18?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1)],1):e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"营销话术：",prop:"columnExt2"}},[t("el-input",{attrs:{id:"smsDetail",type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}})],1)],1),t("el-col",{attrs:{span:24}},[1==e.custgroupSource?t("el-form-item",{attrs:{label:"营销用语替换变量："}},[t("DNAReplaceVar",{on:{getVar:e.getContent}})],1):t("el-form-item",{attrs:{label:"营销话术变量："}},e._l(e.replaceVar,(function(a){return t("el-tag",{key:a.id,attrs:{type:"info"},on:{click:function(t){return e.getContent(a.attrCol)}}},[e._v(e._s(a.attrColName))])})),1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"IVR营销音：",prop:"columnExt5"}},[t("el-input",{attrs:{id:"smsDetail2",type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.columnExt5,callback:function(t){e.$set(e.CrmFrom,"columnExt5",t)},expression:"CrmFrom.columnExt5"}})],1)],1),t("el-col",{attrs:{span:24}},[1==e.custgroupSource?t("el-form-item",{attrs:{label:"IVR营销音变量："}},[t("DNAReplaceVar",{on:{getVar:e.getContent2}})],1):t("el-form-item",{attrs:{label:"IVR营销音变量："}},e._l(e.replaceVar,(function(a){return t("el-tag",{key:a.id,attrs:{type:"info"},on:{click:function(t){return e.getContent2(a.attrCol)}}},[e._v(e._s(a.attrColName))])})),1)],1),1!=e.custgroupSource?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"发送周期：",prop:"UPDATE_CYCLE"}},[t("div",{staticStyle:{display:"flex",width:"100px"}},[t("el-tag",{attrs:{type:"1"===e.CrmFrom.UPDATE_CYCLE?"":"info"},on:{click:function(t){return e.getTags("1")}}},[e._v("一次性")]),1!==e.updateCycle?t("el-tag",{staticStyle:{"margin-left":"10px"},attrs:{type:"0"===e.CrmFrom.UPDATE_CYCLE?"":"info"},on:{click:function(t){return e.getTags("0")}}},[e._v("周期性")]):e._e()],1)])],1):e._e(),1!==e.updateCycle&&0==e.CrmFrom.UPDATE_CYCLE||1==e.custgroupSource?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"频次配置：",prop:e.CrmFrom.FREQUENCY?"num":"FREQUENCY"}},[t("div",{staticStyle:{display:"flex"}},[t("el-select",{attrs:{placeholder:"请选择天数"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.FREQUENCY,callback:function(t){e.$set(e.CrmFrom,"FREQUENCY",t)},expression:"CrmFrom.FREQUENCY"}},e._l(e.dateList,(function(e){return t("el-option",{key:e.cycleId,attrs:{label:e.cycleName,value:e.cycle}})})),1),t("el-input",{staticStyle:{width:"100px",margin:"0px 20px"},attrs:{type:"text",rows:8,placeholder:""},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.num,callback:function(t){e.$set(e.CrmFrom,"num",t)},expression:"CrmFrom.num"}}),e._v("次 ")],1)])],1):e._e()],2)],1),t("ShortMessageList",{ref:"messageList",attrs:{tableData:e.tableData,cols:e.cols,channelId:e.id},on:{getSmsContentTemplateList:e.getSmsContentTemplateList,addShortMessage:e.addShortMessage}}),t("ChainedDialog",{ref:"chainedDialog"}),t("ComplexScene",{ref:"SceneDialog",on:{addScene:e.addScene}}),t("materialList",{ref:"material",attrs:{channelId:e.id,adivId:e.CrmFrom.adivInfo.adivId},on:{addMaterial:e.addMaterial}})],1)},i=[],l=a("0fea"),o=a("5e05"),n=(a("0b16"),a("c3eb")),s=a("006c"),m=a("aedd"),c=a("b893"),u=a("f1ce"),d=a("5ed5"),h=a("6501");const p=o["a"].common.getSysEnum,C=o["a"].common.queryAdivInfo,v=o["a"].common.queryHallInfo;var f={props:["channelNewData","id","deleteSub"],components:{ShortMessageList:n["a"],ChainedDialog:s["a"],ComplexScene:m["a"],materialList:u["a"],Tips:d["a"],DNAReplaceVar:h["a"]},data(){return{CrmFrom:{adivInfo:{},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",columnExt2:"",columnExt3:"0",columnExt4:"7",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt9:"",columnExt10:"",columnExt11:"",columnExt12:"",columnExt13:"",columnExt14:"",columnExt15:"",columnExt18:"",columnExt19:"",columnExt20:"",standard:"",CustomerRules:"",marketingWords:"",UPDATE_CYCLE:"",FREQUENCY:"",num:"",CEP_EVENT_ID:"",CEP_SCENE_NAME:"",IF_HAVE_VAR:"0",showScene:!1,checked:Boolean,saleType:""},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],saleType:[{required:!0,message:"请选择营销类型",trigger:"change"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],CEP_EVENT_ID:[{required:!0,message:"请选择发送周期",trigger:"blur"}],UPDATE_CYCLE:[{required:!0,message:"请选择发送周期",trigger:"change"}],FREQUENCY:[{required:!0,message:"请选择频次配置",trigger:"blur"}],num:[{required:!0,message:"请填写次数",trigger:"blur"}],columnExt2:[{required:!0,message:"请输入营销话术",trigger:"blur"}],columnExt5:[{required:!0,message:"请输入IVR营销音",trigger:"blur"}],columnExt6:[{required:!0,message:"请选择项目层级二",trigger:"blur"}],columnExt7:[{required:!0,message:"请选择项目层级三",trigger:"blur"}],columnExt10:[{required:!0,message:"请输入营销(服务)目标客群提取规则",trigger:"blur"}],columnExt11:[{required:!0,message:"请输入任务描述及要求",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],tableData:[],cols:[{label:"模板编号",props:"id"},{label:"模板内容",props:"content"}],dateList:[],sceneParams:{eventName:""},replaceVar:[],columnExt4List:[{label:"1天",value:"1"},{label:"2天",value:"2"},{label:"3天",value:"3"},{label:"4天",value:"4"},{label:"5天",value:"5"},{label:"6天",value:"6"},{label:"7天",value:"7"}],saleList:[{label:"实时营销",value:"1"},{label:"批量营销",value:"2"}],projectLevel2:[],projectLevel3:[]}},computed:{updateCycle(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.updateCycle},customGroupId(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId},custgroupSource(){return this.$store.state.extendData.custgroupSource},SMS_CONTENT(){return this.CrmFrom.columnExt2},columnExt5(){return this.CrmFrom.columnExt5},checked(){return this.CrmFrom.checked},saleTypes(){return this.CrmFrom.saleType},custgroupSource(){return this.$store.state.extendData.custgroupSource}},watch:{channelNewData:{handler(){this.CrmFrom=Object(c["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),"9572"===this.CrmFrom.adivInfo.adivId&&(this.getProjectLevelList(this.CrmFrom.adivInfo.adivId,2),this.getProjectLevelList(this.CrmFrom.columnExt6,3)),this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0},deleteSub(){},checked(e){this.CrmFrom=e?{...this.CrmFrom,columnExt3:"1"}:{...this.CrmFrom,columnExt3:"0"}},SMS_CONTENT(e){let t=e+this.columnExt5;const a=/\$[a-zA-Z0-9_\u4e00-\u9fa5]+\$/g,r=t.match(a);r&&r.length>0?this.CrmFrom.IF_HAVE_VAR="1":this.CrmFrom.IF_HAVE_VAR="0"},columnExt5(e){let t=e+this.SMS_CONTENT;const a=/\$[a-zA-Z0-9_\u4e00-\u9fa5]+\$/g,r=t.match(a);r&&r.length>0?this.CrmFrom.IF_HAVE_VAR="1":this.CrmFrom.IF_HAVE_VAR="0"},saleTypes(e){"2"===e&&(this.CrmFrom={...this.CrmFrom,CEP_SCENE_NAME:"",CEP_EVENT_ID:"",sceneParams:{eventName:""},checked:!1})}},created(){this.getOptionData(),this.getDateList(),this.listCustAttr(),this.CrmFrom=Object(c["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),"9572"===this.CrmFrom.adivInfo.adivId&&(this.getProjectLevelList(this.CrmFrom.adivInfo.adivId,2),this.getProjectLevelList(this.CrmFrom.columnExt6,3)),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(p,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(C,{channelId:this.id}).then(e=>{this.adivList=e}),await Object(l["i"])(v,{}).then(e=>{this.attributionList=e})},changeAid(e){const t=this.adivList.find(t=>t.adivId===e)||{adivId:"",adivName:""};this.CrmFrom.adivInfo={adivId:t.adivId,adivName:t.adivName},"9572"===e?(this.getProjectLevelList(e,2),this.$set(this.CrmFrom,"saleType","1"),this.CrmFrom.columnExt6="",this.CrmFrom.columnExt7="",this.CrmFrom.columnExt8="",this.CrmFrom.columnExt9="",this.CrmFrom.columnExt12="",this.CrmFrom.columnExt13="",this.CrmFrom.columnExt14="",this.CrmFrom.columnExt15=""):(this.$set(this.CrmFrom,"saleType",""),this.CrmFrom.columnExt6="",this.CrmFrom.columnExt7="",this.CrmFrom.columnExt8="",this.CrmFrom.columnExt9="",this.CrmFrom.columnExt10="",this.CrmFrom.columnExt11="",this.CrmFrom.columnExt12="",this.CrmFrom.columnExt13="",this.CrmFrom.columnExt14="",this.CrmFrom.columnExt15=""),this.$forceUpdate()},async getProjectLevelList(e,t=2){const a={parentId:e,levelType:2===t?"iop_projectLevel2_id":"iop_projectLevel3_actual_id"};try{const e=await Object(l["i"])(o["a"].common.getProject,a);2===t?this.projectLevel2=e:this.projectLevel3=e}catch(r){}},changeProjectLevel2(e){const t=this.projectLevel2.find(t=>t.id===e)||{id:"",levelValue:"",levelKey:""};this.CrmFrom.columnExt8=t.levelValue,this.getProjectLevelList(t.id,3),this.CrmFrom.columnExt14=t.levelKey,this.CrmFrom.columnExt7="",this.CrmFrom.columnExt9="",this.CrmFrom.columnExt12="",this.CrmFrom.columnExt13="",this.CrmFrom.columnExt15=""},changeProjectLevel3(e){const t=this.projectLevel3.find(t=>t.id===e)||{id:"",levelValue:""};this.CrmFrom.columnExt9=t.levelValue,this.CrmFrom.columnExt12=t.taskTypeId,this.CrmFrom.columnExt13=t.taskTypeName,this.CrmFrom.columnExt15=t.levelKey},changeSaleType(e){this.$set(this.CrmFrom,"saleType",e),this.removeEvent(),this.CrmFrom.checked=!1},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},openDilog(e){this.$refs["messageList"].showDialog(e)},addShortMessage(e){this.CrmFrom={...this.CrmFrom,marketingWords:e.row.content}},async getSmsContentTemplateList(e){await Object(l["i"])(o["a"].common.getSmsContentTemplateList,e).then(e=>{e.width=570,this.tableData=e})},openChainedDilog(e){this.$refs["chainedDialog"].showDialog(e)},openSceneDilog(e){this.$refs["SceneDialog"].showDialog(e)},addScene(e){this.CrmFrom={...this.CrmFrom,CEP_EVENT_ID:e.eventId,CEP_SCENE_NAME:e.eventName,sceneParams:e}},removeEvent(){this.CrmFrom.sceneParams={eventName:""},this.CrmFrom.CEP_EVENT_ID="",this.CrmFrom.CEP_SCENE_NAME=""},getTags(e){this.CrmFrom={...this.CrmFrom,UPDATE_CYCLE:e},0==e&&(this.CrmFrom.FREQUENCY=null,this.CrmFrom.num=""),this.$forceUpdate()},async getDateList(){await Object(l["i"])(o["a"].common.getDateList).then(e=>{this.dateList=e})},async listCustAttr(){var e;const t=null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId;await Object(l["i"])(o["a"].common.listCustAttr+"?custGroupId="+t).then(e=>{this.replaceVar=e})},getContent(e){let t="$"+e+"$";e=t,this.ShortMsgContent=e;const a=document.querySelector("#smsDetail");if(a.selectionStart||0===a.selectionStart){var r=a.selectionStart,i=a.selectionEnd;this.CrmFrom={...this.CrmFrom,columnExt2:a.value.substring(0,r)+e+a.value.substring(i,a.value.length)},this.$nextTick(),a.focus(),a.setSelectionRange(i+e.length,i+e.length)}else this.CrmFrom.columnExt2+=e},getContent2(e){let t="$"+e+"$";e=t,this.ShortMsgContent=e;const a=document.querySelector("#smsDetail2");if(a.selectionStart||0===a.selectionStart){var r=a.selectionStart,i=a.selectionEnd;this.CrmFrom={...this.CrmFrom,columnExt5:a.value.substring(0,r)+e+a.value.substring(i,a.value.length)},this.$nextTick(),a.focus(),a.setSelectionRange(i+e.length,i+e.length)}else this.CrmFrom.columnExt5+=e},selectMaterial(e){this.$refs["material"].getMaterialList(),this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}}}},b=f,g=(a("2e11"),a("2877")),x=Object(g["a"])(b,r,i,!1,null,"6031f131",null);t["a"]=x.exports},"2d81":function(e,t,a){},"2e11":function(e,t,a){"use strict";a("6141")},"2ec7":function(e,t,a){"use strict";a("6034")},3074:function(e,t,a){"use strict";a("39dd")},3175:function(e,t,a){},"317a":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",attrs:{"label-width":"150px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1),e.showExt18?t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1):e._e(),t("el-form-item",{attrs:{label:"推荐用语：",prop:"EXEC_CONTENT"}},[t("el-input",{attrs:{type:"textarea",rows:4,maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.EXEC_CONTENT,callback:function(t){e.$set(e.CrmFrom,"EXEC_CONTENT",t)},expression:"CrmFrom.EXEC_CONTENT"}})],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("b893"),s=(a("57d8"),a("9044"),a("5ed5"));const m=o["a"].common.getSysEnum;var c={components:{Tips:s["a"]},props:["channelNewData","id"],data(){return{CrmFrom:{adivInfo:{adivId:"8101"},channelConf:{},channelId:"",channelName:"",EXEC_CONTENT:"",columnExt18:"0"},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},EXEC_CONTENT:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],priorityOrder:[{required:!0,message:"请输入优先等级",trigger:"blur"}],ceshi:[{required:!0,message:"请输入优先等级",trigger:"blur"}]}},timeIdList:[],adivList:[],isadivInfo:!1}},watch:{channelNewData:{handler(){this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0,this.CrmFrom.adivInfo.adivId="8101",this.isadivInfo=!0},deep:!0}},mounted(){this.getOptionData(),this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0,this.CrmFrom.adivInfo.adivId="8101",this.isadivInfo=!0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(m,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e})},getConfiguration(e){1!==e.zt&&(this.CrmFrom.channelConf={priorityOrder:0,channelExtConf:{}}),this.$refs.configurationSheet.lookSchedulingInfo(e.configid)},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},changeTime(){this.timeIdList.forEach(e=>{e.enumKey===this.CrmFrom.timeId&&(this.CrmFrom.timeName=e.enumValue)})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},configGsheet(e){this.CrmFrom.channelConf.channelExtConf=Object.assign(this.CrmFrom.channelConf.channelExtConf,e),this.CrmFrom=JSON.parse(JSON.stringify(this.CrmFrom))}},created(){}},u=c,d=a("2877"),h=Object(d["a"])(u,r,i,!1,null,"0e15928f",null);t["a"]=h.exports},3193:function(e,t,a){},"31b1":function(e,t,a){"use strict";const r="/plan-svc/api/action",i="/plan-svc/action",l="/approve-svc/",o="/element-svc/";t["a"]={channel:{queryIopTemplate:r+"/tactics/tacticsCreate/queryIopTemplate",queryTopics:r+"/topic/queryTopics",getTemplateData:l+"jx/cmpApprovalProcessConf/getApproveConfig",getApproveConfig:l+"cmpApprovalProcessConf/getApproveConfig",getNextApprovers:l+"jx/cmpApproveProcessInstance/getNodeApprover",saveChannel:r+"/tactics/tacticsCreate/save",deleteCustom:r+"/custgroup/custGroupManager/deleteCustom",getMoreMyCustom:r+"/custgroup/custGroupManager/getMoreMyCustom",viewCustGroupDetail:r+"/custgroup/custGroupManager/viewCustGroupDetail",queryMmsTemplates:i+"/mmsTemplates/queryMmsTemplates",deleteMmsTemplateLists:i+"/mmsTemplates/createTactics/deleteMmsTemplateLists",updateMmsTemplate:i+"/mmsTemplates/updateMmsTemplate",smsContentBatchDel:r+"/smsTemplates/smsContentBatchDel",smsContentDel:r+"/smsTemplates/smsContentDel",smsContentEdit:r+"/smsTemplates/smsContentEdit",smsContentSaveOrUpdate:r+"/smsTemplates/smsContentSaveOrUpdate",smsTemplateOffline:r+"/smsTemplates/smsTemplateOffline",smsTemplates:r+"/smsTemplates/smsTemplates",smsTemplateSaveOrUpdate:r+"/smsTemplates/smsTemplateSaveOrUpdate",delPlanExclusivity:o+"mcd-plan-exclusivity/delPlanExclusivity",exportPlanExcluTemplate:o+"mcd-plan-exclusivity/exportPlanExcluTemplate",getPlanExclusivityInfo:o+"mcd-plan-exclusivity/getPlanExclusivityInfo",getPlanExclusivityList:o+"mcd-plan-exclusivity/getPlanExclusivityList",queryPlanDefList:o+"mcd-plan-exclusivity/queryPlanDefList",queryPlanExclusivity:o+"mcd-plan-exclusivity/queryPlanExclusivity",saveOrUpdatePlanExclusivity:o+"mcd-plan-exclusivity/saveOrUpdatePlanExclusivity",savePlanExclusivity:o+"mcd-plan-exclusivity/savePlanExclusivity",updatePlanExclusivity:o+"mcd-plan-exclusivity/updatePlanExclusivity",uploadPlanExcluFile:o+"mcd-plan-exclusivity/uploadPlanExcluFile",approveRecord:o+"api/mcdDimMaterialApprove/jx/approveRecord",getMaterialApprover:o+"api/mcdDimMaterialApprove/jx/getMaterialApprover",commitProcess:"/approve-svc/cmpApproveProcessInstance/commitProcess",subMaterialApprove:o+"api/mcdDimMaterialApprove/jx/subMaterialApprove",queryCommunicationUsers:"/plan-svc/api/channelMaterial/jx/queryCommunicationUsers",queryCommunicationTask:"/approve-svc/jx/cmpApproveProcessInstance/queryCommunicationTask",addCommunicationTask:"/approve-svc/jx/cmpApproveProcessInstance/addCommunicationTask",addCommunicationTaskBatch:"/approve-svc/jx/cmpApproveProcessInstance/addCommunicationTaskBatch",communicationAppTask:"/approve-svc/jx/cmpApproveProcessInstance/communicationAppTask",queryChannelExecInfo:"/plan-svc/mcd/camp/channelExec/queryChannelExecInfo",queryChannelExecList:"/plan-svc/mcd/camp/channelExec/queryChannelExecList",deleteChannelPrompt:"/plan-svc/mcd/chan/prompt/deleteChannelPrompt",queryChannelPrompt:"/plan-svc/mcd/chan/prompt/queryChannelPrompt",saveOrUpdateChannelPrompt:"/plan-svc/mcd/chan/prompt/saveOrUpdateChannelPrompt",uploaChanPromptFile:"/plan-svc/mcd/chan/prompt/uploaChanPromptFile",chanAndPlanMarketingHistory:"/plan-svc/mcd/marketing/history/chanAndPlanMarketingHistory",custContactNumMarketingHistory:"/plan-svc/mcd/marketing/history/custContactNumMarketingHistory",custSuccessRateMarketingHistory:"/plan-svc/mcd/marketing/history/custSuccessRateMarketingHistory",planMarketingHistory:"/plan-svc/mcd/marketing/history/planMarketingHistory",caculateContactUserNum:"/pec-timing/mcd/user/contact/caculateContactUserNum",caculateOrderUserNum:"/pec-timing/mcd/user/contact/caculateOrderUserNum",queryCampScene:"/plan-svc/api/action/tactics/tacticsCreate/jx/queryCampScene"}}},"327a":function(e,t,a){"use strict";a("0918")},3390:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("Tips",{attrs:{id:e.channelId},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",attrs:{"label-width":"110px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivId,callback:function(t){e.$set(e.CrmFrom,"adivId",t)},expression:"CrmFrom.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{attrs:{label:"复杂事件场景："}},[t("el-button",{staticClass:"ml-10",attrs:{type:"primary"},on:{click:e.addCepClick}},[e._v("添加")])],1),e.showExt18?t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1):e._e(),t("el-form-item",{attrs:{label:"推荐用语：",prop:"execContent"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.execContent,callback:function(t){e.$set(e.CrmFrom,"execContent",t)},expression:"CrmFrom.execContent"}})],1),t("el-form-item",[t("el-button",{on:{click:e.SubInstall}},[e._v("保存当前设置")])],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("5ed5"),s=a("f3ba");const m=o["a"].common.queryAdivInfo,c=o["a"].common.queryMaterialByChannel,u=s["a"].home.getDicValueByKey;var d={props:["channelId"],components:{Tips:n["a"]},data(){return{CrmFrom:{adivId:"",adivName:"",materialId:"",materialName:"",execContent:"",columnExt18:"0"},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{adivId:[{required:!0,message:"请选择运营位",trigger:"blur,change"}],materialId:[{required:!0,message:"请选择素材",trigger:"blur,change"}],execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}]},matList:[],timeIdList:[],adivList:[]}},mounted(){this.getOptionData(),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},getOptionData(){Object(l["i"])(m,{channelId:this.channelId}).then(e=>{this.adivList=e})},addCepClick(){Object(l["i"])(u,{key:"MCD_CEP_EVENT_URL"}).then(e=>{})},changeAid(){this.adivList.forEach(e=>{(this.CrmFrom.adivId=e.adivId)&&(this.CrmFrom.adivName=e.adivName)});let e="0",t={channelId:this.channelId,materialType:e,positionId:this.CrmFrom.adivId};Object(l["i"])(c,t).then(e=>{this.matList=e})},SubInstall(){this.$refs.CrmFrom.validate(e=>{})}}},h=d,p=a("2877"),C=Object(p["a"])(h,r,i,!1,null,"8d418fd6",null);t["a"]=C.exports},3719:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"CrmFrom",attrs:{"label-width":"130px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{attrs:{label:"推荐用语：",prop:"channelConf.execContent"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.channelConf.execContent,callback:function(t){e.$set(e.CrmFrom.channelConf,"execContent",t)},expression:"CrmFrom.channelConf.execContent"}})],1),t("el-form-item",{attrs:{label:"时机选择："}},[t("el-select",{attrs:{placeholder:"请选择"},on:{click:e.changeTime},model:{value:e.CrmFrom.channelConf.timeId,callback:function(t){e.$set(e.CrmFrom.channelConf,"timeId",t)},expression:"CrmFrom.channelConf.timeId"}},e._l(e.timeIdList,(function(e){return t("el-option",{key:e.enumKey,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("el-form-item",{attrs:{label:"时机描述："}},[t("el-input",{attrs:{type:"textarea",maxlength:"240","show-word-limit":""},model:{value:e.CrmFrom.channelConf.timeDistindes,callback:function(t){e.$set(e.CrmFrom.channelConf,"timeDistindes",t)},expression:"CrmFrom.channelConf.timeDistindes"}})],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05");const n=o["a"].common.getSysEnum,s=o["a"].common.queryAdivInfo,m=o["a"].common.queryHallInfo;var c={props:["channelNewData"],data(){return{CrmFrom:{adivInfo:{},channelConf:{},channelId:"",channelName:"",attributionInfo:{}},CrmFromRules:{adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[]}},mounted(){this.getOptionData(),this.CrmFrom=JSON.parse(JSON.stringify(this.channelNewData))},methods:{async getOptionData(){await Object(l["i"])(n,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(s,{channelId:this.CrmFrom.channelId}).then(e=>{this.adivList=e}),await Object(l["i"])(m,{}).then(e=>{this.attributionList=e})},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},changeAttribution(e){var t="";this.attributionList.forEach(a=>{e===a.adivId&&(t=a.attributionName)}),this.CrmFrom.attributionInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,attributionName:t})},changeTime(){this.timeIdList.forEach(e=>{e.enumKey===this.CrmFrom.timeId&&(this.CrmFrom.timeName=e.enumValue)})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e}},created(){}},u=c,d=a("2877"),h=Object(d["a"])(u,r,i,!1,null,"45b23a1c",null);t["a"]=h.exports},"39d6":function(e,t,a){},"39dd":function(e,t,a){},"3a17":function(e,t,a){},"3aeb":function(e,t,a){"use strict";a("f7b7")},"3c7a":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));const r=[{id:"804",components:"Incoming"},{id:"805",components:"ProductApp"},{id:"906",components:"MutiplePositionComponent"},{id:"922",components:"MutiplePositionComponent"},{id:"961",components:"MutiplePositionComponent"},{id:"963",components:"MutiplePositionComponent"},{id:"965",components:"MutiplePositionComponent"},{id:"966",components:"MutiplePositionComponent"},{id:"962",components:"MutiplePositionComponent"},{id:"901",components:"ContentSMS"},{id:"932",components:"MobileVideo"},{id:"957",components:"IVRsales"},{id:"958",components:"PushNotification"},{id:"964",components:"FiveCloudCard"},{id:"960",components:"FiveMessage"},{id:"801",components:"ContentSMS"},{id:"910",components:"MessageEntrainment"},{id:"802",components:"OutboundMarking"},{id:"809",components:"CustomerPass"},{id:"808",components:"GridPass"},{id:"931",components:"Linestore"},{id:"924",components:"BelieveWithMe"},{id:"926",components:"FindOneLevel"},{id:"916",components:"MiguChannel"},{id:"917",components:"MiguChannel"},{id:"919",components:"MiguChannel"},{id:"920",components:"MiguChannel"},{id:"933",components:"EnterpriseWeChat"},{id:"811",components:"OutboundForEight"},{id:"810",components:"shortOffice"},{id:"968",components:"GuangDianTong"},{id:"969",components:"GovernmentEnterprise"},{id:"967",components:"ChinaMobileApp"},{id:"970",components:"Zhuangweisuixiao"}],i={id:"0",components:"DefaultItem"};function l(e){const t=r.find(t=>t.id===e);return void 0!==t?t.components:i.components}},"3d00":function(e,t,a){"use strict";a("9192")},"3f74":function(e,t,a){},"409c":function(e,t,a){},"40ca":function(e,t,a){"use strict";a("8eb2")},4239:function(e,t,a){"use strict";a("e0bf")},"43fd":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("div",{staticStyle:{display:"flex","justify-content":"end"}}),t("Tips",{attrs:{id:e.id}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"150px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择短信类型"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"标准化素材：",prop:"columnExt20"}},[t("div",{staticClass:"select-material",on:{click:function(t){return e.selectMaterial(!0)}}},[e._v(e._s(e.CrmFrom.materialName||"请选择"))])])],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"消息模板编号前缀：",prop:"columnExt5"}},[t("el-select",{attrs:{placeholder:"请消息模板编号前缀"},model:{value:e.CrmFrom.columnExt5,callback:function(t){e.$set(e.CrmFrom,"columnExt5",t)},expression:"CrmFrom.columnExt5"}},e._l(e.columnExt5List,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"实时事件类型：",prop:"columnExt6"}},[t("el-select",{attrs:{placeholder:"请选择实时事件类型"},model:{value:e.CrmFrom.columnExt6,callback:function(t){e.$set(e.CrmFrom,"columnExt6",t)},expression:"CrmFrom.columnExt6"}},e._l(e.columnExt6List,(function(e){return t("el-option",{key:e.enumId,attrs:{label:e.enumValue,value:e.enumId}})})),1)],1)],1),e.showScene?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"复杂事件场景：",prop:"CEP_EVENT_ID"}},[t("div",[t("div",{staticStyle:{display:"flex","justify-content":"space-between","max-width":"375px"}},[t("div",{staticClass:"add-botton"},[t("span",{on:{click:function(t){return e.openSceneDilog(!0)}}},[e._v(e._s(e.CrmFrom.sceneParams.eventName||"添加"))]),t("i",{directives:[{name:"show",rawName:"v-show",value:e.CrmFrom.sceneParams.eventName,expression:"CrmFrom.sceneParams.eventName"}],staticClass:"el-icon-close",on:{click:e.removeEvent}})]),t("el-checkbox",{model:{value:e.CrmFrom.checked,callback:function(t){e.$set(e.CrmFrom,"checked",t)},expression:"CrmFrom.checked"}},[e._v("取消推荐规则设置")])],1),"JX0000000001"===e.customGroupId?t("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("该活动没有限定客群，触发事件即发送，请慎重选择事件！")]):e._e(),e.CrmFrom.checked?t("div",{staticClass:"select"},[t("div",{staticClass:"setRules"},[t("p",[e._v("已选择事件："+e._s(e.CrmFrom.sceneParams.eventName))])]),t("div",[t("span",[e._v("取消推荐时间：")]),t("el-select",{attrs:{placeholder:"请选择执行端口",size:"mini"},model:{value:e.CrmFrom.columnExt4,callback:function(t){e.$set(e.CrmFrom,"columnExt4",t)},expression:"CrmFrom.columnExt4"}},e._l(e.columnExt4List,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]):e._e()])])],1):e._e(),e.showExt18?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1)],1):e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"营销话术：",prop:"columnExt2","label-width":"148px"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{id:"smsDetail",type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}})],1)],1),t("el-col",{attrs:{span:24}},[1==e.custgroupSource?t("el-form-item",{attrs:{label:"营销用语替换变量："}},[t("DNAReplaceVar",{on:{getVar:e.getContent}})],1):t("el-form-item",{attrs:{label:"营销用语替换变量："}},e._l(e.replaceVar,(function(a){return t("el-tag",{key:a.id,attrs:{type:"info"},on:{click:function(t){return e.getContent(a.attrCol)}}},[e._v(e._s(a.attrColName))])})),1)],1),1!=e.custgroupSource?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"发送周期：",prop:"UPDATE_CYCLE"}},[t("div",{staticStyle:{display:"flex",width:"100px"}},[t("el-tag",{attrs:{type:"1"===e.CrmFrom.UPDATE_CYCLE?"":"info"},on:{click:function(t){return e.getTags("1")}}},[e._v("一次性")]),1!==e.updateCycle?t("el-tag",{staticStyle:{"margin-left":"10px"},attrs:{type:"0"===e.CrmFrom.UPDATE_CYCLE?"":"info"},on:{click:function(t){return e.getTags("0")}}},[e._v("周期性")]):e._e()],1)])],1):e._e(),1!==e.updateCycle&&0==e.CrmFrom.UPDATE_CYCLE||1==e.custgroupSource?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"频次配置：",prop:e.CrmFrom.FREQUENCY?"num":"FREQUENCY"}},[t("div",{staticStyle:{display:"flex"}},[t("el-select",{attrs:{placeholder:"请选择天数"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.FREQUENCY,callback:function(t){e.$set(e.CrmFrom,"FREQUENCY",t)},expression:"CrmFrom.FREQUENCY"}},e._l(e.dateList,(function(e){return t("el-option",{key:e.cycleId,attrs:{label:e.cycleName,value:e.cycle}})})),1),t("el-input",{staticStyle:{width:"100px",margin:"0px 20px"},attrs:{type:"text",rows:8,placeholder:""},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.num,callback:function(t){e.$set(e.CrmFrom,"num",t)},expression:"CrmFrom.num"}}),e._v("次 ")],1)])],1):e._e()],1)],1),t("ComplexScene",{ref:"SceneDialog",on:{addScene:e.addScene}}),t("materialList",{ref:"material",attrs:{channelId:e.id,adivId:e.CrmFrom.adivInfo.adivId},on:{addMaterial:e.addMaterial}})],1)},i=[],l=a("0fea"),o=a("5e05"),n=(a("0b16"),a("aedd")),s=a("b893"),m=a("f1ce"),c=a("5ed5"),u=a("6501");const d=o["a"].common.getSysEnum,h=o["a"].common.queryAdivInfo,p=o["a"].common.queryHallInfo;var C={props:["channelNewData","id","deleteSub"],components:{ComplexScene:n["a"],materialList:m["a"],Tips:c["a"],DNAReplaceVar:u["a"]},data(){return{CrmFrom:{adivInfo:{},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",standard:"",CustomerRules:"",marketingWords:"",UPDATE_CYCLE:"",IF_HAVE_VAR:"0",SMS_CONTENT:"",CEP_EVENT_ID:"",columnExt2:"",columnExt4:"7",columnExt6:"",columnExt5:"",columnExt18:"0",sceneParams:{eventName:""},checked:Boolean,columnExt20:""},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],UPDATE_CYCLE:[{required:!0,message:"请选择发送周期",trigger:"blur"}],FREQUENCY:[{required:!0,message:"请选择频次配置",trigger:"blur"}],num:[{required:!0,message:"请填写次数",trigger:"blur"}],columnExt5:[{required:!0,message:"请选择模板消息前缀",trigger:"blur"}],columnExt6:[{required:!0,message:"请选择实时事件类型",trigger:"blur"}],columnExt2:[{required:!0,message:"请输入营销话术",trigger:"blur"}],CEP_EVENT_ID:[{required:!0,message:"请输入选择复杂事件场景",trigger:"change"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],dateList:[],showScene:!0,ShortMsgContent:"",sceneParams:{eventName:""},replaceVar:[],columnExt4List:[{label:"1天",value:"1"},{label:"2天",value:"2"},{label:"3天",value:"3"},{label:"4天",value:"4"},{label:"5天",value:"5"},{label:"6天",value:"6"},{label:"7天",value:"7"}],columnExt6List:[],columnExt5List:[{label:"iop公共模板前缀",value:"80001"}],toolTopContent:"IOP免打扰时间段为21:00-8:00,在此期间将不会主动推送营销信息给客户。周期性客群如当天任务没有发送完成,将不会在第二天发送,第二天直接使用更新后客群发送。"}},computed:{updateCycle(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.updateCycle},customGroupId(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId},custgroupSource(){return this.$store.state.extendData.custgroupSource},SMS_CONTENT(){return this.CrmFrom.columnExt2},checked(){return this.CrmFrom.checked}},watch:{channelNewData:{handler(){this.CrmFrom=Object(s["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0},CrmFrom:{handler(e,t){},deep:!0},deleteSub(){},checked(e){this.CrmFrom=e?{...this.CrmFrom,columnExt3:"1"}:{...this.CrmFrom,columnExt3:"0"}},SMS_CONTENT(e){if(e){const t=/\$[a-zA-Z0-9_\u4e00-\u9fa5]+\$/g,a=e.match(t);a&&a.length>0?this.CrmFrom.IF_HAVE_VAR="1":this.CrmFrom.IF_HAVE_VAR="0"}else this.CrmFrom.IF_HAVE_VAR="0"}},mounted(){this.getOptionData(),this.listCustAttr(),this.getDateList(),this.getSysEnum(),this.CrmFrom=Object(s["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(d,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(h,{channelId:this.id}).then(e=>{this.adivList=e}),await Object(l["i"])(p,{}).then(e=>{this.attributionList=e})},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},openSceneDilog(e){this.$refs["SceneDialog"].showDialog(e)},addScene(e){this.CrmFrom={...this.CrmFrom,CEP_EVENT_ID:e.eventId,CEP_SCENE_NAME:e.eventName,sceneParams:e}},removeEvent(){this.CrmFrom.sceneParams={eventName:""},this.CrmFrom.CEP_EVENT_ID="",this.CrmFrom.CEP_SCENE_NAME=""},async listCustAttr(){var e;const t=null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId;await Object(l["i"])(o["a"].common.listCustAttr+"?custGroupId="+t).then(e=>{this.replaceVar=e})},getContent(e){let t="$"+e+"$";e=t,this.ShortMsgContent=e;const a=document.querySelector("#smsDetail");if(a.selectionStart||0===a.selectionStart){var r=a.selectionStart,i=a.selectionEnd;this.CrmFrom={...this.CrmFrom,columnExt2:a.value.substring(0,r)+e+a.value.substring(i,a.value.length)},this.$nextTick(),a.focus(),a.setSelectionRange(i+e.length,i+e.length)}else this.CrmFrom.columnExt2+=e},getTags(e){this.CrmFrom={...this.CrmFrom,UPDATE_CYCLE:e},0==e&&(this.CrmFrom.FREQUENCY=null,this.CrmFrom.num=""),this.$forceUpdate()},async getDateList(){await Object(l["i"])(o["a"].common.getDateList).then(e=>{this.dateList=e})},async getSysEnum(){await Object(l["i"])(o["a"].common.getSysEnum,{enumType:"event_type_958"}).then(e=>{this.columnExt6List=e})},selectMaterial(e){this.$refs["material"].getMaterialList(),this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}}},created(){}},v=C,f=(a("89b7"),a("2877")),b=Object(f["a"])(v,r,i,!1,null,"629a3bed",null);t["a"]=b.exports},"458b":function(e,t,a){"use strict";a("5140")},4873:function(e,t,a){},4880:function(e,t,a){"use strict";a("9a5b")},"492d":function(e,t,a){"use strict";a("ab51")},"4a44":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("el-form",{ref:"CrmFrom",attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1),e.showExt18?t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1):e._e(),t("el-form-item",{attrs:{label:"推荐用语：",prop:"marketingWords"}},[t("el-input",{attrs:{type:"textarea",rows:5,maxlength:"500","show-word-limit":"",placeholder:"请输入推荐用语"},model:{value:e.CrmFrom.marketingWords,callback:function(t){e.$set(e.CrmFrom,"marketingWords",t)},expression:"CrmFrom.marketingWords"}})],1)],1)},i=[],l=a("b893"),o=a("5ed5"),n={props:["channelNewData","id"],components:{Tips:o["a"]},data(){return{CrmFrom:{columnExt1:"1",columnExt18:"0",marketingWords:""},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入推荐用语",trigger:"blur"}]},adivList:[]}},watch:{channelNewData:{handler(){this.CrmFrom=Object(l["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0}},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},SubInstall(){let e=!0;return this.$refs.CrmFrom.validate(t=>{t?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e}},created(){this.CrmFrom=Object(l["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0}},s=n,m=a("2877"),c=Object(m["a"])(s,r,i,!1,null,"22e46086",null);t["a"]=c.exports},"4b54":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"应用号：",prop:"columnExt2"}},[t("el-select",{attrs:{placeholder:"请选择应用号"},on:{change:e.changeApplication},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}},e._l(e.applicationList,(function(e){return t("el-option",{key:e.applicationId,attrs:{label:e.applicationName,value:e.applicationName}})})),1)],1)],1),t("el-col",{attrs:{span:4}},[t("el-form-item",{attrs:{"label-width":"100px"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.platformList()}}},[e._v("模板列表")])],1)],1),e.CrmFrom.columnExt5?[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"模板编号：",prop:"columnExt5","label-width":"148px"}},[t("el-input",{attrs:{type:"text","show-word-limit":"",placeholder:"请输入模板ID",disabled:""},model:{value:e.CrmFrom.columnExt5,callback:function(t){e.$set(e.CrmFrom,"columnExt5",t)},expression:"CrmFrom.columnExt5"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"模板名称：",prop:"columnExt6","label-width":"148px"}},[t("el-input",{attrs:{type:"text","show-word-limit":"",placeholder:"请输入模板ID",disabled:""},model:{value:e.CrmFrom.columnExt6,callback:function(t){e.$set(e.CrmFrom,"columnExt6",t)},expression:"CrmFrom.columnExt6"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"模板内容：",prop:"columnExt7","label-width":"148px"}},[1===e.CrmFrom.templateObj.contentType||4===e.CrmFrom.templateObj.contentType?t("el-input",{attrs:{type:"text","show-word-limit":"",placeholder:"请输入模板ID",disabled:""},model:{value:e.CrmFrom.columnExt7,callback:function(t){e.$set(e.CrmFrom,"columnExt7",t)},expression:"CrmFrom.columnExt7"}}):t("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.CrmFrom.columnExt7,"preview-src-list":[e.CrmFrom.columnExt7],fit:"contain"}})],1)],1)]:e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"营销类型：",prop:"saleType"}},[t("el-select",{attrs:{placeholder:"请选择短信类型",disabled:e.CrmFrom.saleTypeFlag},model:{value:e.CrmFrom.saleType,callback:function(t){e.$set(e.CrmFrom,"saleType",t)},expression:"CrmFrom.saleType"}},e._l(e.saleTypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("p",{staticStyle:{"font-size":"12px",color:"red"}},[e._v("注：交互动态模板类型暂不支持批量营销!")])],1)],1),e.showScene?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"复杂事件场景：",prop:"CEP_EVENT_ID"}},[t("div",[t("div",{staticStyle:{display:"flex","justify-content":"space-between","max-width":"375px"}},[t("div",{staticClass:"add-botton"},[t("span",{on:{click:function(t){return e.openSceneDilog(!0)}}},[e._v(e._s(e.CrmFrom.sceneParams.eventName||"添加"))]),t("i",{directives:[{name:"show",rawName:"v-show",value:e.CrmFrom.sceneParams.eventName,expression:"CrmFrom.sceneParams.eventName"}],staticClass:"el-icon-close",on:{click:e.removeEvent}})]),t("el-checkbox",{model:{value:e.CrmFrom.checked,callback:function(t){e.$set(e.CrmFrom,"checked",t)},expression:"CrmFrom.checked"}},[e._v("取消推荐规则设置")])],1),"JX0000000001"===e.customGroupId?t("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("该活动没有限定客群，触发事件即发送，请慎重选择事件！")]):e._e(),e.CrmFrom.checked?t("div",{staticClass:"select"},[t("div",{staticClass:"setRules"},[t("p",[e._v("已选择事件："+e._s(e.CrmFrom.sceneParams.eventName))])]),t("div",[t("span",[e._v("取消推荐时间：")]),t("el-select",{attrs:{placeholder:"请选择取消推荐时间",size:"mini"},model:{value:e.CrmFrom.columnExt4,callback:function(t){e.$set(e.CrmFrom,"columnExt4",t)},expression:"CrmFrom.columnExt4"}},e._l(e.columnExt4List,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]):e._e()])])],1):e._e(),1!==e.updateCycle?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"频次配置：",prop:e.CrmFrom.FREQUENCY?"FREQUENCY":"num"}},[t("div",{staticStyle:{display:"flex"}},[t("el-select",{attrs:{placeholder:"请选择天数"},model:{value:e.CrmFrom.FREQUENCY,callback:function(t){e.$set(e.CrmFrom,"FREQUENCY",t)},expression:"CrmFrom.FREQUENCY"}},e._l(e.dateList,(function(e){return t("el-option",{key:e.cycleId,attrs:{label:e.cycleName,value:e.cycle}})})),1),t("el-input",{staticStyle:{width:"100px",margin:"0px 20px"},attrs:{type:"text",rows:8,placeholder:""},model:{value:e.CrmFrom.num,callback:function(t){e.$set(e.CrmFrom,"num",t)},expression:"CrmFrom.num"}}),e._v("次 ")],1)])],1):e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"回落类型：",prop:"columnExt9"}},[t("el-radio",{attrs:{label:"-1"},model:{value:e.CrmFrom.columnExt9,callback:function(t){e.$set(e.CrmFrom,"columnExt9",t)},expression:"CrmFrom.columnExt9"}},[e._v("无回落")]),e._l(e.CrmFrom.radioList,(function(a){return t("el-radio",{key:a.key,attrs:{label:a.key},model:{value:e.CrmFrom.columnExt9,callback:function(t){e.$set(e.CrmFrom,"columnExt9",t)},expression:"CrmFrom.columnExt9"}},[e._v(e._s(a.fallBackType))])}))],2)],1)],2)],1),t("ComplexScene",{ref:"SceneDialog",on:{addScene:e.addScene}}),t("el-dialog",{staticClass:"my-tem-dialog",attrs:{title:"模板列表",visible:e.dialogTableVisible,modal:!1,width:"1015px",top:"8vh"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[t("div",{staticClass:"selech-panel"},[t("el-form",{ref:"queryForm",staticStyle:{display:"flex","flex-wrap":"wrap"},attrs:{model:e.queryForm,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"模板类型：","label-width":"120px"}},[t("el-select",{staticStyle:{width:"187px"},attrs:{placeholder:"请选择"},model:{value:e.queryForm.templateType,callback:function(t){e.$set(e.queryForm,"templateType",t)},expression:"queryForm.templateType"}},e._l(e.templateTypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"模板内容类型：","label-width":"120px"}},[t("el-select",{staticStyle:{width:"187px"},attrs:{placeholder:"请选择"},model:{value:e.queryForm.contentType,callback:function(t){e.$set(e.queryForm,"contentType",t)},expression:"queryForm.contentType"}},e._l(e.contentTypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"审核结果：","label-width":"120px"}},[t("el-select",{staticStyle:{width:"187px"},attrs:{placeholder:"请选择"},model:{value:e.queryForm.result,callback:function(t){e.$set(e.queryForm,"result",t)},expression:"queryForm.result"}},e._l(e.resultList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("div",{staticStyle:{"margin-left":"800px"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.platformList()}}},[e._v("查询")]),t("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.resetQueryForm}},[e._v("重置")])],1)],1)],1),t("label-screen",{attrs:{title:"已选模板",ismutex:!1,isPulldown:!1,Label:e.Label,Default:e.LabelDefault},on:{close:e.handleClose}}),t("el-table",{staticClass:"customTable",attrs:{data:e.gridData}},[t("el-table-column",{attrs:{type:"index",prop:"index",label:"序号",width:"45",align:"center"}}),t("el-table-column",{attrs:{property:"templateID",label:"模板编号",width:"90"}}),t("el-table-column",{attrs:{property:"templateTypeChn",label:"模板类型",width:"70",align:"center"}}),t("el-table-column",{attrs:{property:"contentTypeChn",label:"内容类型",width:"70",align:"center"}}),t("el-table-column",{attrs:{property:"templateName",label:"模板名称",width:"120","header-align":"center"}}),t("el-table-column",{attrs:{label:"模板内容",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[1===a.row.contentType||4===a.row.contentType?t("span",[e._v(e._s(a.row.contents))]):t("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:a.row.contents,"preview-src-list":[a.row.contents],fit:"contain"}})]}}])}),t("el-table-column",{attrs:{property:"createTime",label:"创建时间",width:"90",align:"center"}}),t("el-table-column",{attrs:{property:"until",label:"有效期",width:"90",align:"center"}}),t("el-table-column",{attrs:{property:"statusChn",label:"状态",align:"center"}}),t("el-table-column",{attrs:{property:"resultChn",label:"审核结果",align:"center"}}),t("el-table-column",{attrs:{property:"address",label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(a){return[e.isPast(a.row.until)?t("span",{staticStyle:{color:"#bbb"}},[e._v("失效")]):t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.choose(a.row)}}},[e._v("选择")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.queryForm.pageNum,layout:"total, prev, pager, next, jumper",total:e.Total},on:{"current-change":e.handleCurrentChange}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sureChoose()}}},[e._v("确 定")])],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("b893"),s=a("aedd"),m=a("7b5a"),c=a("5ed5");o["a"].common.getSysEnum,o["a"].common.queryAdivInfo,o["a"].common.queryHallInfo;const u=o["a"].common.getApplication;var d={props:["channelNewData","id","deleteSub"],components:{ComplexScene:s["a"],LabelScreen:m["a"],Tips:c["a"]},data(){return{CrmFrom:{adivInfo:{adivId:""},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",columnExt2:"",columnExt3:"",columnExt4:"7",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt9:"-1",columnExt10:"",standard:"",CustomerRules:"",marketingWords:"",FREQUENCY:"",num:"",CEP_EVENT_ID:"",CEP_SCENE_NAME:"",saleType:"2",sceneParams:{eventName:""},checked:!1,templateObj:{templateType:""},radioList:[],saleTypeFlag:!1},CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],columnExt9:[{required:!0,message:"请选择回落类型",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],CEP_EVENT_ID:[{required:!0,message:"请选择复杂事件场景",trigger:"blur"}],FREQUENCY:[{required:!0,message:"请选择频次配置",trigger:"blur"}],num:[{required:!0,message:"请填写次数",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],showScene:!1,sceneParams:{eventName:""},dateList:[],applicationList:[],dialogTableVisible:!1,gridData:[],templateParams:{},queryForm:{templateType:"",contentType:"",result:"",pageNum:1,pageSize:10},templateTypeList:[{label:"全部",value:""},{label:"静态",value:1},{label:"交互动态",value:2},{label:"主动动态",value:3},{label:"空白",value:4}],contentTypeList:[{label:"全部",value:""},{label:"文本",value:1},{label:"多媒体",value:2},{label:"卡片",value:3},{label:"组合",value:4}],resultList:[{label:"全部",value:""},{label:"未提交审核",value:-1},{label:"审核通过",value:0},{label:"审核不通过",value:1},{label:"审核中",value:999}],Total:0,templateObj:{},LabelDefault:{id:"templateId",value:"templateName"},Label:[],saleTypeList:[{label:"实时营销",value:"1"},{label:"批量营销",value:"2"}],columnExt4List:[{label:"1天",value:"1"},{label:"2天",value:"2"},{label:"3天",value:"3"},{label:"4天",value:"4"},{label:"5天",value:"5"},{label:"6天",value:"6"},{label:"7天",value:"7"}]}},computed:{updateCycle(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.updateCycle},customGroupId(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId},changeSaleType(){return this.CrmFrom.saleType},checked(){return this.CrmFrom.checked}},watch:{channelNewData:{handler(){this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.CrmFrom.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"columnExt9",this.CrmFrom.columnExt9||"-1"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.$set(this.CrmFrom,"templateObj",this.CrmFrom.templateObj||{templateType:""})},deep:!0},deleteSub(){},checked(e){this.CrmFrom=e?{...this.CrmFrom,columnExt3:"1"}:{...this.CrmFrom,columnExt3:"0"}},changeSaleType(e){this.removeEvent(),this.CrmFrom.checked=!1,"1"===e?(this.showScene=!0,this.CrmFrom.adivInfo.adivId="9601"):(this.showScene=!1,this.CrmFrom.adivInfo.adivId="9602",this.CrmFrom.columnExt3=null,this.CrmFrom.columnExt4=null,this.CrmFrom={...this.CrmFrom,CEP_EVENT_ID:"",CEP_SCENE_NAME:"",sceneParams:{},checked:!1})}},mounted(){if(this.getOptionData(),this.getDateList(),this.getApplicationNum(),this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.CrmFrom.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"columnExt9",this.CrmFrom.columnExt9||"-1"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.$set(this.CrmFrom,"templateObj",this.CrmFrom.templateObj||{templateType:""}),this.CrmFrom.columnExt9>-1){let e=[{fallBackType:"文本回落",key:"0"},{fallBackType:"视频回落",key:"1"},{fallBackType:"短小2.0回落",key:"2"}];this.$set(this.CrmFrom,"radioList",[e[this.CrmFrom.columnExt9]])}},methods:{async getOptionData(){},changeApplication(e){const t=this.applicationList.filter(t=>t.applicationName===e);this.templateParams=t[0],this.CrmFrom.columnExt5="",this.CrmFrom.columnExt6="",this.CrmFrom.columnExt7="",this.CrmFrom.columnExt8="",this.$forceUpdate()},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t?this.CrmFrom.columnExt5?(this.$emit("saveChannelData",this.CrmFrom),e=!0):(this.$message.error("请选择模板后提交"),e=!1):("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},openSceneDilog(e){this.$refs["SceneDialog"].showDialog(e)},addScene(e){this.CrmFrom={...this.CrmFrom,CEP_EVENT_ID:e.eventId,CEP_SCENE_NAME:e.eventName,sceneParams:e}},removeEvent(){this.CrmFrom.sceneParams={eventName:""},this.CrmFrom.CEP_EVENT_ID="",this.CrmFrom.CEP_SCENE_NAME=""},async getDateList(){await Object(l["i"])(o["a"].common.getDateList).then(e=>{e.forEach(e=>{e.cycle=e.cycle+""}),this.dateList=e})},async getApplicationNum(){await Object(l["i"])(u,{channelId:this.id}).then(e=>{this.applicationList=e,this.CrmFrom.columnExt2=e[0].applicationName,this.templateParams={id:e[0].id,applicationId:e[0].applicationId,appSecret:e[0].appSecret}})},async platformList(){if(!this.templateParams.id)return void this.$message.error("请先选择应用号");this.dialogTableVisible=!0;const e={...this.queryForm,chatbotId:this.templateParams.id,appId:this.templateParams.applicationId,appSecret:this.templateParams.appSecret};await Object(l["i"])(o["a"].common.getPlaformList,e).then(e=>{null!==e.data&&(this.formatList(JSON.parse(e).list),this.Total=JSON.parse(e).total)})},resetQueryForm(){this.queryForm={...this.queryForm,templateType:"",contentType:"",result:""},this.platformList()},handleCurrentChange(e){this.queryForm.pageNum=e,this.platformList()},choose(e){this.CrmFrom.templateObj=e,this.Label=[{templateId:e.templateID,templateName:e.templateName}]},sureChoose(){if(0===this.Label.length)return this.dialogTableVisible=!1;let e=[];if(Object.prototype.hasOwnProperty.call(this.CrmFrom.templateObj,"aimSmsTemplate")){var t=this.CrmFrom.templateObj.aimSmsTemplate;Object.prototype.hasOwnProperty.call(t,"state")&&"1"===t.state&&(e=[{fallBackType:"短小2.0回落",key:"2"}])}Object.prototype.hasOwnProperty.call(this.CrmFrom.templateObj,"smsTemplate")&&(e=[{fallBackType:"文本回落",key:"0"}]),Object.prototype.hasOwnProperty.call(this.CrmFrom.templateObj,"mmsTemplate")&&(e=[{fallBackType:"视频回落",key:"1"}]),this.CrmFrom.radioList=e,this.CrmFrom={...this.CrmFrom,columnExt5:this.CrmFrom.templateObj.templateID,columnExt6:this.CrmFrom.templateObj.templateName,columnExt7:this.CrmFrom.templateObj.contents,columnExt8:this.CrmFrom.templateObj.templateType,saleType:1!==this.CrmFrom.templateObj.templateType&&3!==this.CrmFrom.templateObj.templateType?"1":this.CrmFrom.saleType,saleTypeFlag:1!==this.CrmFrom.templateObj.templateType&&3!==this.CrmFrom.templateObj.templateType},this.dialogTableVisible=!1},formatList(e){const t="https://rcs.10086.cn/5g-csp/csp-manage";this.gridData=e.map(e=>{if(1===e.templateType?e.templateTypeChn="静态":2===e.templateType?e.templateTypeChn="交互动态":3===e.templateType?e.templateTypeChn="主动动态":e.templateTypeChn="空白",1===e.contentType)e.contentTypeChn="文本",e.contents=e.bodyTextTemplate.contents[0].text;else if(2===e.contentType)e.contentTypeChn="多媒体",e.contents=t+e.bodyTextTemplate.contents[0].file.thumbInfo.url;else if(3===e.contentType){e.contentTypeChn="卡片";var a="generalPurposeCardCarousel",r=e.bodyTextTemplate.contents[0].message;for(var i in r)e.contents=i===a?t+e.bodyTextTemplate.contents[0].message.generalPurposeCardCarousel.content[0].media.thumbnailUrl:t+e.bodyTextTemplate.contents[0].message.generalPurposeCard.content.media.thumbnailUrl}else 4===e.contentType&&(e.contents=e.bodyTextTemplate.contents[0].text,e.contentTypeChn="组合");return-1===e.result?e.resultChn="未提交审核":0===e.result?e.resultChn="审核通过":1===e.result?e.resultChn="审核不通过":e.resultChn="审核中",1===e.status?e.statusChn="正常":2===e.status?e.statusChn="下线":3===e.status&&(e.statusChn="删除"),e})},handleClose(e){this.Label=this.Label.filter(t=>!(t.templateId===e.templateId))},isPast(e){let t=(new Date).getTime(),a=new Date(e).getTime();return a<t}}},h=d,p=(a("7779"),a("2877")),C=Object(p["a"])(h,r,i,!1,null,"324dd6a2",null);t["a"]=C.exports},"4cb2":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"CrmFrom",attrs:{"label-width":"110px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivId,callback:function(t){e.$set(e.CrmFrom,"adivId",t)},expression:"CrmFrom.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{attrs:{label:"选择素材：",prop:"materialId"}},[t("el-select",{attrs:{placeholder:"请选择素材"},model:{value:e.CrmFrom.materialId,callback:function(t){e.$set(e.CrmFrom,"materialId",t)},expression:"CrmFrom.materialId"}},e._l(e.matList,(function(e){return t("el-option",{key:e.ID,attrs:{label:e.NAME,value:e.ID}})})),1),t("el-button",{staticClass:"ml-10",attrs:{type:"primary"},on:{click:e.showImage}},[e._v("预览")])],1),t("el-form-item",{attrs:{label:"推荐用语：",prop:"execContent"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.execContent,callback:function(t){e.$set(e.CrmFrom,"execContent",t)},expression:"CrmFrom.execContent"}})],1),t("el-form-item",[t("el-button",{on:{click:e.SubInstall}},[e._v("保存当前设置")])],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05");const n=o["a"].common.queryAdivInfo,s=o["a"].common.queryMaterialByChannel,m=o["a"].common.queryMaterialById;var c={props:["channelId"],data(){return{CrmFrom:{},CrmFromRules:{adivId:[{required:!0,message:"请选择运营位",trigger:"blur,change"}],materialId:[{required:!0,message:"请选择素材",trigger:"blur,change"}],execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}]},matList:[],timeIdList:[],adivList:[]}},mounted(){this.getOptionData()},methods:{getOptionData(){Object(l["i"])(n,{channelId:this.channelId}).then(e=>{this.adivList=e})},changeAid(){this.adivList.forEach(e=>{(this.CrmFrom.adivId=e.adivId)&&(this.CrmFrom.adivName=e.adivName)});let e="0",t={channelId:this.channelId,materialType:e,positionId:this.CrmFrom.adivId};Object(l["i"])(s,t).then(e=>{this.matList=e})},showImage(){Object(l["i"])(m,{materialId:this.CrmFrom.materialId}).then(e=>{})},SubInstall(){this.$refs.CrmFrom.validate(e=>{})}}},u=c,d=a("2877"),h=Object(d["a"])(u,r,i,!1,null,"f4ec5a32",null);t["a"]=h.exports},"4db8":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"CrmFrom",attrs:{"label-width":"130px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{attrs:{label:"推荐用语：",prop:"channelConf.execContent"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.channelConf.execContent,callback:function(t){e.$set(e.CrmFrom.channelConf,"execContent",t)},expression:"CrmFrom.channelConf.execContent"}})],1),t("el-form-item",{attrs:{label:"是否一键办理：",prop:"isOneKey"}},[t("el-radio-group",{model:{value:e.CrmFrom.isOneKey,callback:function(t){e.$set(e.CrmFrom,"isOneKey",t)},expression:"CrmFrom.isOneKey"}},[t("el-radio",{attrs:{label:!0}},[e._v("一键办理")]),t("el-radio",{attrs:{label:!1}},[e._v("非一键办理")])],1)],1),t("el-form-item",{attrs:{label:"短信用语：",prop:"channelConf.smsContent"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.channelConf.smsContent,callback:function(t){e.$set(e.CrmFrom.channelConf,"smsContent",t)},expression:"CrmFrom.channelConf.smsContent"}})],1),t("el-form-item",{attrs:{label:"产品办理URL：",prop:"channelConf.materialDisplayUrl"}},[t("el-input",{model:{value:e.CrmFrom.channelConf.materialDisplayUrl,callback:function(t){e.$set(e.CrmFrom.channelConf,"materialDisplayUrl",t)},expression:"CrmFrom.channelConf.materialDisplayUrl"}})],1),t("el-form-item",{attrs:{label:"时机选择："}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeTime},model:{value:e.CrmFrom.channelConf.timeId,callback:function(t){e.$set(e.CrmFrom.channelConf,"timeId",t)},expression:"CrmFrom.channelConf.timeId"}},e._l(e.timeIdList,(function(e){return t("el-option",{key:e.enumKey,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("el-form-item",{attrs:{label:"时机描述："}},[t("el-input",{attrs:{type:"textarea",maxlength:"240","show-word-limit":""},model:{value:e.CrmFrom.channelConf.timeDistindes,callback:function(t){e.$set(e.CrmFrom.channelConf,"timeDistindes",t)},expression:"CrmFrom.channelConf.timeDistindes"}})],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05");const n=o["a"].common.getSysEnum,s=o["a"].common.queryAdivInfo,m=o["a"].common.queryHallInfo;var c={props:["channelNewData"],data(){return{CrmFrom:{isOneKey:null,adivInfo:{},channelConf:{},channelId:"",channelName:"",attributionInfo:{}},CrmFromRules:{isOneKey:[{required:!0,message:"是否一键办理",trigger:"change"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[]}},mounted(){this.getOptionData(),this.CrmFrom=JSON.parse(JSON.stringify(this.channelNewData))},methods:{async getOptionData(){await Object(l["i"])(n,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(s,{channelId:this.CrmFrom.channelId}).then(e=>{this.adivList=e}),await Object(l["i"])(m,{}).then(e=>{this.attributionList=e})},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},changeAttribution(e){var t="";this.attributionList.forEach(a=>{e===a.adivId&&(t=a.attributionName)}),this.CrmFrom.attributionInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,attributionName:t})},changeTime(){this.timeIdList.forEach(e=>{e.enumKey===this.CrmFrom.timeId&&(this.CrmFrom.timeName=e.enumValue)})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e}},created(){}},u=c,d=a("2877"),h=Object(d["a"])(u,r,i,!1,null,"2ef65636",null);t["a"]=h.exports},5140:function(e,t,a){},"521b":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("el-form",{ref:"CrmFrom",attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("Tips",{attrs:{id:e.id}}),t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1),t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAdiv},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("b893"),s=a("5ed5"),m={props:["channelNewData","id"],components:{Tips:s["a"]},data(){return{CrmFrom:{adivInfo:{adivId:"",adivName:""}},CrmFromRules:{adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]}},adivList:[]}},watch:{channelNewData:{handler(){this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"adivInfo",this.CrmFrom.adivInfo||{adivId:"",adivName:""})},deep:!0}},methods:{getAdivList(){Object(l["i"])(o["a"].common.queryAdivInfo,{channelId:this.id}).then(e=>{this.adivList=e,this.adivList.length>0&&this.$set(this.CrmFrom,"adivInfo",this.adivList[0]||{adivId:"",adivName:""})})},changeAdiv(e){const t=this.adivList.find(t=>t.adivId===e);this.CrmFrom.adivInfo=t||{adivId:"",adivName:""}},SubInstall(){let e=!0;return this.$refs.CrmFrom.validate(t=>{t?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e}},created(){this.getAdivList(),this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"adivInfo",this.CrmFrom.adivInfo||{adivId:"",adivName:""})}},c=m,u=a("2877"),d=Object(u["a"])(c,r,i,!1,null,"72603716",null);t["a"]=d.exports},"523c":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("el-form",{ref:"CrmFrom",attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1),t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAdiv},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),e.showExt18?t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1):e._e(),t("el-form-item",{attrs:{label:"推荐用语：",prop:"channelConf.execContent"}},[t("el-input",{attrs:{type:"textarea",rows:5,maxlength:"500","show-word-limit":"",placeholder:"请输入推荐用语"},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.channelConf.execContent,callback:function(t){e.$set(e.CrmFrom.channelConf,"execContent",t)},expression:"CrmFrom.channelConf.execContent"}})],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("b893"),s=a("5ed5"),m={props:["channelNewData","id"],components:{Tips:s["a"]},data(){return{CrmFrom:{adivInfo:{adivId:"",adivName:""},columnExt1:"1",columnExt18:"0",channelConf:{execContent:""}},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}]}},adivList:[]}},watch:{channelNewData:{handler(){this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0}},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},getAdivList(){Object(l["i"])(o["a"].common.queryAdivInfo,{channelId:this.id}).then(e=>{this.adivList=e})},changeAdiv(e){const t=this.adivList.find(t=>t.adivId===e);this.CrmFrom.adivInfo=t||{adivId:"",adivName:""}},SubInstall(){let e=!0;return this.$refs.CrmFrom.validate(t=>{t?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e}},created(){this.getAdivList(),this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0}},c=m,u=a("2877"),d=Object(u["a"])(c,r,i,!1,null,"111afee5",null);t["a"]=d.exports},"526e":function(e,t,a){},"52f7":function(e,t,a){},"53e3":function(e,t,a){},5414:function(e,t,a){e.exports=a.p+"img/pdf.8249fad0.png"},"56b3":function(e,t,a){e.exports=a.p+"img/txt.3756ec5e.png"},"571b":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("BaseDialog",{attrs:{title:`话术评价【${e.currentRow.scriptName}】`,visible:e.dialogVisible,width:"500px",top:"25vh","confirm-button-text":"提 交","show-cancel-button":!1,"confirm-loading":e.loading},on:{confirm:e.submit,close:e.close}},[t("el-form",{ref:"ruleForm",attrs:{model:e.form}},e._l(e.form,(function(a,r){return t("el-form-item",{key:r,attrs:{label:e.keyMap.get(r),prop:r,rules:[{required:!0,validator:e.validate,trigger:"change"}]}},[t("el-rate",{attrs:{"show-text":"",max:5,colors:e.colors,texts:e.texts},model:{value:e.form[r],callback:function(t){e.$set(e.form,r,t)},expression:"form[key]"}})],1)})),1)],1)},i=[],l=(a("d9e2"),a("0fea")),o=a("cdbb"),n=a("ea45"),s={components:{BaseDialog:n["a"]},props:{dialogVisible:{type:Boolean,default:!1},currentRow:{type:Object,default:()=>({})}},watch:{dialogVisible(e){if(!e){this.$refs.ruleForm.clearValidate();for(const e in this.form)this.form.hasOwnProperty(e)&&(this.form[e]=null)}}},data(){return{loading:!1,keyMap:new Map([["syxStarNumber","实用性"],["tyxStarNumber","通用性"],["zqxStarNumber","准确性"]]),form:{syxStarNumber:null,tyxStarNumber:null,zqxStarNumber:null},colors:["#99A9BF","#67a6e7","#2F87EC"],texts:["很差","差","一般","满意","优秀"]}},methods:{validate(e,t,a){const r=this.keyMap.get(e.field);t<1?a(new Error(`请对${r}进行星级评价`)):a()},submit(){this.$refs.ruleForm.validate(async e=>{if(e)try{this.loading=!0;const e={...this.form,scriptId:this.currentRow.scriptId,scriptName:this.currentRow.scriptName};await Object(l["i"])(o["a"].getScriptAppraise,e);this.$message.success("评价成功"),this.$emit("refresh"),this.$nextTick(()=>{this.close()})}catch(t){}finally{this.loading=!1}})},close(){this.$emit("update:dialogVisible",!1)}}},m=s,c=(a("d6bd"),a("2877")),u=Object(c["a"])(m,r,i,!1,null,"3b927ad5",null);t["a"]=u.exports},"57d8":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",e._l(e.attrInfoList,(function(a){return t("el-form-item",{key:a.attrId,attrs:{label:a.attrName+"：",prop:0===a.isNullable?"channelConf.channelExtConf."+a.attrId:void 0,rules:0===a.isNullable?a.Rules:void 0}},[1===a.attrValueType?t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],attrs:{maxlength:a.attrLength},model:{value:e.DataFrom[a.attrId],callback:function(t){e.$set(e.DataFrom,a.attrId,t)},expression:"DataFrom[item.attrId]"}}):e._e(),6===a.attrValueType?t("el-radio-group",{model:{value:e.DataFrom[a.attrId],callback:function(t){e.$set(e.DataFrom,a.attrId,t)},expression:"DataFrom[item.attrId]"}},e._l(a.dataSource,(function(a){return t("el-radio",{key:a.attrValueId,attrs:{label:a.attrValueId}},[e._v(e._s(a.attrValueName))])})),1):e._e(),7===a.attrValueType?t("el-checkbox-group",{model:{value:e.DataFrom[a.attrId],callback:function(t){e.$set(e.DataFrom,a.attrId,t)},expression:"DataFrom[item.attrId]"}},e._l(a.dataSource,(function(a){return t("el-checkbox",{key:a.attrValueId,attrs:{label:a.attrValueId}},[e._v(e._s(a.attrValueName))])})),1):e._e(),3===a.attrValueType?t("el-select",{attrs:{placeholder:"请选择"+a.attrName},model:{value:e.DataFrom[a.attrId],callback:function(t){e.$set(e.DataFrom,a.attrId,t)},expression:"DataFrom[item.attrId]"}},e._l(a.dataSource,(function(e){return t("el-option",{key:e.attrValueId,attrs:{label:e.attrValueName,value:e.attrValueId}})})),1):e._e(),4===a.attrValueType?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.DataFrom[a.attrId],callback:function(t){e.$set(e.DataFrom,a.attrId,t)},expression:"DataFrom[item.attrId]"}}):e._e(),5===a.attrValueType?t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.DataFrom[a.attrId],callback:function(t){e.$set(e.DataFrom,a.attrId,t)},expression:"DataFrom[item.attrId]"}}):e._e(),2===a.attrValueType?t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],attrs:{type:"textarea",rows:4,"show-word-limit":"",maxlength:a.attrLength},model:{value:e.DataFrom[a.attrId],callback:function(t){e.$set(e.DataFrom,a.attrId,t)},expression:"DataFrom[item.attrId]"}}):e._e()],1)})),1)},i=[],l=(a("d9e2"),a("14d9"),a("a454")),o=a("0fea");const n=(e,t,a)=>{const r=/^[1-9]\d*$/;r.test(t)?a():a(new Error("请输入数字"))};var s={props:["CrmFrom"],data(){return{DataFrom:{},attrInfoList:[]}},mounted(){},methods:{async lookSchedulingInfo(e){this.attrInfoList=[],this.DataFrom={},void 0!==e&&""!==e&&void 0!==e&&"0"!==e&&await Object(o["i"])(l["a"].scheduling.lookSchedulingInfo,{id:e+""}).then(e=>{var t=[],a={};t=e.attrInfoList.map(async(e,t)=>{if(7===e.attrValueType?a[e.attrId]=this.CrmFrom[e.attrId]||[]:a[e.attrId]=this.CrmFrom[e.attrId]||"",null!==e.resoureUrl){var r=await Object(o["g"])(e.resoureUrl);e.dataSource=r,r.map(t=>{1===t.isDefaultValue&&(Array.isArray(a[e.attrId])?Array.isArray(this.CrmFrom[e.attrId])&&0===this.CrmFrom[e.attrId].length?a[e.attrId].push(t.attrValueId):a[e.attrId]=this.CrmFrom[e.attrId]:a[e.attrId]=this.CrmFrom[e.attrId]||t.attrValueId)})}return e.Rules=[],0===e.isNullable&&e.Rules.push({required:!0,message:e.attrName+"不能为空",trigger:"blur"}),1===e.attrFormat&&e.Rules.push({validator:n,trigger:"blur"}),e}),t.map(async e=>{await e.then(e=>{this.attrInfoList.push(e),this.attrInfoList=this.insertSort(this.attrInfoList)})}),this.DataFrom=Object.assign(a,this.DataFrom),this.$watch("DataFrom",e=>{this.$emit("configGsheet",e)},{deep:!0})})},insertSort(e){for(var t=e.length,a=1;a<t;a++){var r=e[a],i=a-1;while(i>=0&&e[i].serialNumber>r.serialNumber)e[i+1]=e[i],i--;e[i+1]=r}return e}}},m=s,c=a("2877"),u=Object(c["a"])(m,r,i,!1,null,"1ce56c84",null);t["a"]=u.exports},5985:function(e,t,a){"use strict";a("3175")},"5ac7":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),e._e(),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择营销类型"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1)],1),e.CrmFrom.showScene?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"复杂事件场景：",prop:"CEP_EVENT_ID"}},[t("div",[t("div",{staticStyle:{display:"flex","justify-content":"space-between","max-width":"375px"}},[t("div",{staticClass:"add-botton"},[t("span",{on:{click:function(t){return e.openSceneDilog(!0)}}},[e._v(e._s(e.CrmFrom.sceneParams.eventName||"添加"))]),t("i",{directives:[{name:"show",rawName:"v-show",value:e.CrmFrom.sceneParams.eventName,expression:"CrmFrom.sceneParams.eventName"}],staticClass:"el-icon-close",on:{click:e.removeEvent}})]),t("el-checkbox",{model:{value:e.CrmFrom.checked,callback:function(t){e.$set(e.CrmFrom,"checked",t)},expression:"CrmFrom.checked"}},[e._v("取消推荐规则设置")])],1),"JX0000000001"===e.customGroupId?t("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("该活动没有限定客群，触发事件即发送，请慎重选择事件！")]):e._e(),e.CrmFrom.checked?t("div",{staticClass:"select"},[t("div",{staticClass:"setRules"},[t("p",[e._v("已选择事件："+e._s(e.CrmFrom.sceneParams.eventName))])]),t("div",[t("span",[e._v("取消推荐时间：")]),t("el-select",{attrs:{placeholder:"请选择执行端口",size:"mini"},model:{value:e.CrmFrom.columnExt4,callback:function(t){e.$set(e.CrmFrom,"columnExt4",t)},expression:"CrmFrom.columnExt4"}},e._l(e.columnExt4List,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]):e._e()])])],1):e._e(),e.showExt18?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1)],1):e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"彩信任务编号：",prop:"columnExt2","label-width":"148px"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字",disabled:""},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}}),t("div",{staticClass:"button"},[t("div",{staticClass:"sub-otton",on:{click:function(t){return e.openDilog(!0)}}},[e._v("视频彩信模板")])])],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"彩信任务主题：",prop:"columnExt3","label-width":"148px"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字",disabled:""},model:{value:e.CrmFrom.columnExt3,callback:function(t){e.$set(e.CrmFrom,"columnExt3",t)},expression:"CrmFrom.columnExt3"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"彩信地址：",prop:"columnExt5","label-width":"148px"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字",disabled:""},model:{value:e.CrmFrom.columnExt5,callback:function(t){e.$set(e.CrmFrom,"columnExt5",t)},expression:"CrmFrom.columnExt5"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"频次配置：",prop:e.CrmFrom.FREQUENCY?"FREQUENCY":"num"}},[t("div",{staticStyle:{display:"flex"}},[t("el-select",{attrs:{placeholder:"请选择天数"},model:{value:e.CrmFrom.FREQUENCY,callback:function(t){e.$set(e.CrmFrom,"FREQUENCY",t)},expression:"CrmFrom.FREQUENCY"}},e._l(e.dateList,(function(e){return t("el-option",{key:e.cycleId,attrs:{label:e.cycleName,value:e.cycle}})})),1),t("el-input",{staticStyle:{width:"100px",margin:"0px 20px"},attrs:{type:"text",rows:8,placeholder:""},model:{value:e.CrmFrom.num,callback:function(t){e.$set(e.CrmFrom,"num",t)},expression:"CrmFrom.num"}}),e._v("次 ")],1)])],1)],1)],1),t("ShortMessageList",{ref:"messageList",attrs:{tableData:e.tableData,cols:e.cols,channelId:e.id},on:{getSmsContentTemplateList:e.getSmsContentTemplateList,addShortMessage:e.addShortMessage}}),t("ComplexScene",{ref:"SceneDialog",on:{addScene:e.addScene}}),t("materialList",{ref:"material",attrs:{channelId:e.id,adivId:e.CrmFrom.adivInfo.adivId},on:{addMaterial:e.addMaterial}})],1)},i=[],l=a("0fea"),o=a("5e05"),n=(a("0b16"),a("c3eb")),s=a("b893"),m=a("aedd"),c=a("f1ce"),u=a("5ed5");const d=o["a"].common.getSysEnum,h=o["a"].common.queryAdivInfo,p=o["a"].common.queryHallInfo;var C={props:["channelNewData","id","deleteSub"],components:{ShortMessageList:n["a"],ComplexScene:m["a"],materialList:c["a"],Tips:u["a"]},data(){return{CrmFrom:{adivInfo:{},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",standard:"",CustomerRules:"",marketingWords:"",FREQUENCY:"",num:"",CEP_EVENT_ID:"",IF_HAVE_VAR:"",columnExt4:"7",columnExt18:"0",showScene:!1,sceneParams:{eventName:""},checked:Boolean},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],FREQUENCY:[{required:!0,message:"请选择频次配置",trigger:"blur"}],CEP_EVENT_ID:[{required:!0,message:"请选择复杂场景事件",trigger:"blur"}],num:[{required:!0,message:"请填写次数",trigger:"blur"}],columnExt2:[{required:!0,message:"请输入彩信任务编号",trigger:"blur"}],columnExt3:[{required:!0,message:"请输入彩信任务主题",trigger:"blur"}],columnExt5:[{required:!0,message:"请输入彩信地址",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],tableData:[],cols:[{label:"彩信模板编号",props:"id"},{label:"彩信主题",props:"templateName"},{label:"彩信地址",props:"mmsAddress"}],dateList:"",sceneParams:{},columnExt4List:[{label:"1天",value:"1"},{label:"2天",value:"2"},{label:"3天",value:"3"},{label:"4天",value:"4"},{label:"5天",value:"5"},{label:"6天",value:"6"},{label:"7天",value:"7"}],toolTopContent:"IOP免打扰时间段为21:00-8:00,在此期间将不会主动推送营销信息给客户。周期性客群如当天任务没有发送完成,将不会在第二天发送,第二天直接使用更新后客群发送。"}},computed:{checked(){return this.CrmFrom.checked},customGroupId(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId}},watch:{channelNewData:{handler(){this.CrmFrom=Object(s["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0},CrmFrom:{handler(e,t){},deep:!0},deleteSub(){},checked(e){this.CrmFrom={...this.CrmFrom}},SMS_CONTENT(e){e&&(this.CrmFrom={...this.CrmFrom,IF_HAVE_VAR:-1!==e.search(this.ShortMsgContent)?"1":"0"})}},mounted(){this.getOptionData(),this.getDateList(),this.CrmFrom=Object(s["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(d,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(h,{channelId:this.id}).then(e=>{this.adivList=e}),await Object(l["i"])(p,{}).then(e=>{this.attributionList=e})},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t}),this.CrmFrom.sceneParams={...this.CrmFrom.sceneParams},this.removeEvent(),this.CrmFrom.checked=!1,"9322"===e?this.CrmFrom.showScene=!0:(this.CrmFrom.showScene=!1,this.CrmFrom={...this.CrmFrom,showScene:!1,sceneParams:{eventName:""},CEP_EVENT_ID:"",CEP_SCENE_NAME:"",checked:!1})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},openDilog(e){this.$refs["messageList"].showDialog(e)},addShortMessage(e){this.CrmFrom={...this.CrmFrom,columnExt2:e.row.id,columnExt3:e.row.templateName,columnExt5:e.row.mmsAddress}},async getSmsContentTemplateList(e){const t={...e,pageSize:e.size,pageNum:e.current};await Object(l["i"])(o["a"].common.getMobileVideo,t).then(e=>{e.width=570,this.tableData={...e,records:e.result}})},openSceneDilog(e){this.$refs["SceneDialog"].showDialog(e)},addScene(e){this.CrmFrom={...this.CrmFrom,CEP_EVENT_ID:e.eventId,CEP_SCENE_NAME:e.eventName,sceneParams:e}},removeEvent(){this.CrmFrom.sceneParams={eventName:""},this.CrmFrom.CEP_EVENT_ID="",this.CrmFrom.CEP_SCENE_NAME=""},async getDateList(){await Object(l["i"])(o["a"].common.getDateList).then(e=>{this.dateList=e})},selectMaterial(e){this.$refs["material"].getMaterialList(),this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}}},created(){}},v=C,f=(a("8c8d"),a("2877")),b=Object(f["a"])(v,r,i,!1,null,"5a28cdbb",null);t["a"]=b.exports},"5ed5":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return e.tip&&(e.tip.fileName||e.tip.promptWord)?t("div",{staticClass:"tips"},[t("el-popover",{attrs:{placement:"left-end",trigger:"click"}},[t("div",{staticClass:"tip-content--global"},[e.tip.promptWord?t("span",{staticClass:"text"},[e._v(e._s(e.tip.promptWord))]):e._e(),e.tip.fileName?t("div",{staticClass:"pic",attrs:{title:e.tip.fileName.length>11&&e.tip.fileName},on:{click:e.downloadFile}},[t("img",{attrs:{src:e.fileType,width:"30",height:"30",alt:""}}),t("span",[e._v(e._s(e.tip.fileName.length>11?e.tip.fileName.slice(0,8)+"...":e.tip.fileName))])]):e._e()]),t("i",{staticClass:"el-icon-warning-outline",attrs:{slot:"reference",title:"提示"},slot:"reference"})])],1):e._e()},i=[],l=(a("88a7"),a("271a"),a("5494"),a("0fea")),o=a("d39c"),n=a("fcff"),s=a.n(n),m=a("b1d3"),c=a.n(m),u=a("5414"),d=a.n(u),h=a("56b3"),p=a.n(h),C=a("f26a"),v=a.n(C),f={name:"Tips",props:["id"],data(){return{tip:null,fileType:c.a}},methods:{getFileType(e){const t=e.substring(e.lastIndexOf(".")+1);switch(t){case"xls":case"xlsx":return s.a;case"pdf":this.fileType=d.a;break;case"txt":return p.a;case"doc":case"docx":return v.a;default:return c.a}},async getTips(){try{const e=await Object(l["i"])(o["a"].seapi.queryDimChannelInfo,{channelId:this.id});this.$emit("getChannelDetail",e),this.tip=e,e.fileName&&(this.fileType=this.getFileType(e.fileName))}catch(e){}},async downloadFile(){try{const{data:e}=await Object(l["b"])(o["a"].seapi.downloadChanPromptFile,{fileUrlAndName:this.tip.fileUploadUrl}),t=new Blob([e],{type:e.type}),a=document.createElement("a");a.download=this.tip.fileName,a.style.display="none",a.href=URL.createObjectURL(t),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)}catch(e){}}},created(){this.getTips()}},b=f,g=(a("7400"),a("2877")),x=Object(g["a"])(b,r,i,!1,null,"32ec1b4c",null);t["a"]=x.exports},6034:function(e,t,a){},6141:function(e,t,a){},6401:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"CrmFrom",attrs:{"label-width":"130px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"端口号码：",prop:"adivId"}},[t("el-select",{attrs:{placeholder:"请选择端口号码"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivId,callback:function(t){e.$set(e.CrmFrom,"adivId",t)},expression:"CrmFrom.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{attrs:{label:"短信类型：",prop:"adivId"}},[t("el-select",{attrs:{placeholder:"请选择短信类型"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivId,callback:function(t){e.$set(e.CrmFrom,"adivId",t)},expression:"CrmFrom.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{attrs:{label:"短信用语：",prop:"channelConf.smsContent"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.channelConf.smsContent,callback:function(t){e.$set(e.CrmFrom.channelConf,"smsContent",t)},expression:"CrmFrom.channelConf.smsContent"}})],1),t("el-form-item",{attrs:{label:"短信用语变量："}},[t("ul",{staticClass:"variableLabl"},e._l(e.variable,(function(a){return t("li",{key:a.label},[e._v(" "+e._s(a.name)+" ")])})),0)]),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"发送类型：",prop:"sendTypeDetail"}},[t("el-radio-group",{model:{value:e.CrmFrom.sendType,callback:function(t){e.$set(e.CrmFrom,"sendType",t)},expression:"CrmFrom.sendType"}},[t("el-radio-button",{attrs:{label:"0"}},[e._v("订制")]),t("el-radio-button",{attrs:{label:"1"}},[e._v("频次")])],1)],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"",prop:"sendTypeDetail"}},["0"===e.CrmFrom.sendType?t("div",{staticClass:"send-box"},[t("el-form-item",{staticStyle:{width:"100%"},attrs:{"label-width":"100px",label:"发送日期：",prop:"sendTime"}},[t("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.CrmFrom.sendTime,callback:function(t){e.$set(e.CrmFrom,"sendTime",t)},expression:"CrmFrom.sendTime"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.preview}},[e._v("新增")])],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{"label-width":"100px",label:"日发送量：",prop:"daySend"}},[t("el-radio-group",{model:{value:e.CrmFrom.daySend,callback:function(t){e.$set(e.CrmFrom,"daySend",t)},expression:"CrmFrom.daySend"}},[t("el-radio",{attrs:{v:"",label:"0"}},[e._v("全部")]),t("el-radio",{attrs:{label:"1"}},[e._v("平均")])],1)],1)],1):e._e(),t("div",{staticClass:"send-box"},[t("el-form-item",{staticStyle:{width:"100%"},attrs:{"label-width":"160px",label:"免打扰日（周）：",prop:"daySend"}},[t("el-checkbox-group",{model:{value:e.CrmFrom.disturb,callback:function(t){e.$set(e.CrmFrom,"disturb",t)},expression:"CrmFrom.disturb"}},e._l(e.weekMap,(function(a,r){return t("el-checkbox",{key:r,attrs:{label:r}},[e._v(e._s(a))])})),1)],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{"label-width":"160px",label:"免打扰日（日历）：",prop:"sendTime"}},[t("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.CrmFrom.sendTime,callback:function(t){e.$set(e.CrmFrom,"sendTime",t)},expression:"CrmFrom.sendTime"}}),t("el-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:e.preview}},[e._v("新增")])],1)],1)]),"1"===e.CrmFrom.sendType?t("el-form-item",{attrs:{label:"发送频次：",prop:"frequency"}},[t("div",{staticStyle:{display:"flex"}},[t("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择发送频次"},on:{change:e.changeAid},model:{value:e.CrmFrom.frequency,callback:function(t){e.$set(e.CrmFrom,"frequency",t)},expression:"CrmFrom.frequency"}},e._l(e.frequencyList,(function(e,a){return t("el-option",{key:a,attrs:{label:e,value:a}})})),1),t("el-form-item",{staticStyle:{width:"100%","margin-left":"20px"},attrs:{label:"",prop:"frequencyNum",inline:!0}},[t("el-input",{staticStyle:{width:"30%"},model:{value:e.CrmFrom.frequencyNum,callback:function(t){e.$set(e.CrmFrom,"frequencyNum",t)},expression:"CrmFrom.frequencyNum"}})],1)],1)]):e._e(),t("el-form-item",{attrs:{label:"时机选择："}},[t("el-select",{attrs:{placeholder:"请选择"},on:{click:e.changeTime},model:{value:e.CrmFrom.timeId,callback:function(t){e.$set(e.CrmFrom,"timeId",t)},expression:"CrmFrom.timeId"}},e._l(e.timeIdList,(function(e){return t("el-option",{key:e.enumKey,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("el-form-item",{attrs:{label:"时机描述："}},[t("el-input",{attrs:{type:"textarea",maxlength:"240","show-word-limit":""},model:{value:e.CrmFrom.timeDistindes,callback:function(t){e.$set(e.CrmFrom,"timeDistindes",t)},expression:"CrmFrom.timeDistindes"}})],1),t("el-form-item",{attrs:{label:"免打扰时段为："}},[t("span",[e._v("21:10到23:59，00:00到9:30")])]),t("el-form-item",[t("el-button",{on:{click:e.SubInstall}},[e._v("保存当前设置")])],1)],1),!0===e.gHandIsShow?t("group-hand-dialog"):e._e()],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("180b");const s=o["a"].common.getSysEnum,m=o["a"].common.queryAdivInfo;var c={props:["channelId","channelData"],components:{GroupHandDialog:n["a"]},data(){return{CrmFrom:{adivId:null,material:null,proPrice:null,urlLink:null,priorityOrder:null,timeId:null,timeDistindes:null,channelConf:{},sendType:"0",sendTime:null,disturb:[],frequency:0,frequencyNum:null},CrmFromRules:{adivId:[{required:!0,message:"请选择运营位",trigger:"blur,change"}],material:[{required:!0,message:"请选择物料",trigger:"blur"}],urlLink:[{required:!0,message:"请输入URL链接",trigger:"blur"}],sendTime:[{required:!0,message:"请输入发送日期",trigger:"blur"}],frequency:[{required:!0,message:"请选择频次",trigger:"blur"}],frequencyNum:[{required:!0,message:"请输入频次",trigger:"blur"}],channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],gHandIsShow:!1,variable:[{name:"APP名称",label:"$APP_NAME$"},{name:"内容热点",label:"$CONTENT_HOT_SPOT$"},{name:"内容标签",label:"$CONTENT_LABEL$"},{name:"内容主题",label:"$CONTENT_SUBJECT$"}],weekMap:["周一","周二","周三","周四","周五","周六","周日"],frequencyList:["多次","单次"]}},mounted(){var e;this.CrmFrom=null!==(e=this.channelData)&&void 0!==e?e:this.CrmFrom,this.getOptionData()},methods:{getOptionData(){Object(l["i"])(m,{channelId:this.channelId}).then(e=>{this.adivList=e}),Object(l["i"])(s,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e})},changeAid(){this.adivList.forEach(e=>{(this.CrmFrom.adivId=e.adivId)&&(this.CrmFrom.adivName=e.adivName)})},changeTime(){this.timeIdList.forEach(e=>{e.enumKey===this.CrmFrom.timeId&&(this.CrmFrom.timeName=e.enumValue)})},preMaterial(){this.gHandIsShow=!this.gHandIsShow},preview(){this.$alert("没有可预览的材料",{confirmButtonText:"确定"})},SubInstall(){this.$refs.CrmFrom.validate(e=>{e&&this.$emit("saveChannelData",this.CrmFrom)})}}},u=c,d=(a("d7d2"),a("2877")),h=Object(d["a"])(u,r,i,!1,null,"2b2b72aa",null);t["a"]=h.exports},6501:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"var-layout"},[e.allList.length>0?t("div",{staticClass:"filter"},[t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],attrs:{size:"mini",placeholder:"请输入关键字",clearable:""},on:{clear:e.search,input:e.search,change:e.search},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)}},model:{value:e.keyWords,callback:function(t){e.keyWords="string"===typeof t?t.trim():t},expression:"keyWords"}})],1):e._e(),t("div",{staticClass:"tag"},e._l(e.varList,(function(a){return t("el-tag",{key:a.id,attrs:{type:"info"},on:{click:function(t){return e.emitVar(a.field,a)}}},[e._v(e._s(a.fieldName))])})),1)])},i=[],l={data(){return{keyWords:"",varList:[]}},computed:{allList(){const e=this.$store.getters["extendData/varList"]||[];return this.varList=[...e],e}},methods:{search(){this.varList=this.allList.filter(e=>e.fieldName.includes(this.keyWords))},emitVar(e,t){this.$emit("getVar",e,t)}},created(){0===this.allList.length&&this.$store.dispatch("extendData/getVarList")}},o=l,n=(a("9193"),a("2877")),s=Object(n["a"])(o,r,i,!1,null,"297edd9f",null);t["a"]=s.exports},"65e9":function(e,t,a){},"661d":function(e,t,a){"use strict";a("c126")},"66d1":function(e,t,a){},"68e8":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",attrs:{"label-width":"130px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{attrs:{label:"营业厅归属地：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择营业厅归属地"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.attributionList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),e.showExt18?t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1):e._e(),t("el-form-item",{attrs:{label:"推荐用语：",prop:"channelConf.execContent"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.channelConf.execContent,callback:function(t){e.$set(e.CrmFrom.channelConf,"execContent",t)},expression:"CrmFrom.channelConf.execContent"}})],1),t("el-form-item",{attrs:{label:"短信用语：",prop:"channelConf.smsContent"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.channelConf.smsContent,callback:function(t){e.$set(e.CrmFrom.channelConf,"smsContent",t)},expression:"CrmFrom.channelConf.smsContent"}})],1),t("el-form-item",{attrs:{label:"时机选择："}},[t("el-select",{attrs:{placeholder:"请选择"},on:{click:e.changeTime},model:{value:e.CrmFrom.channelConf.timeId,callback:function(t){e.$set(e.CrmFrom.channelConf,"timeId",t)},expression:"CrmFrom.channelConf.timeId"}},e._l(e.timeIdList,(function(e){return t("el-option",{key:e.enumKey,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("el-form-item",{attrs:{label:"时机描述："}},[t("el-input",{attrs:{type:"textarea",maxlength:"240","show-word-limit":""},model:{value:e.CrmFrom.channelConf.timeDistindes,callback:function(t){e.$set(e.CrmFrom.channelConf,"timeDistindes",t)},expression:"CrmFrom.channelConf.timeDistindes"}})],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("5ed5");const s=o["a"].common.getSysEnum,m=o["a"].common.queryAdivInfo,c=o["a"].common.queryHallInfo;var u={props:["channelNewData"],components:{Tips:n["a"]},data(){return{CrmFrom:{adivInfo:{},channelConf:{},channelId:"",channelName:"",attributionInfo:{},columnExt18:"0"},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[]}},mounted(){this.getOptionData(),this.CrmFrom=JSON.parse(JSON.stringify(this.channelNewData)),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(s,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(m,{channelId:this.CrmFrom.channelId}).then(e=>{this.adivList=e}),await Object(l["i"])(c,{}).then(e=>{this.attributionList=e})},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},changeAttribution(e){var t="";this.attributionList.forEach(a=>{e===a.adivId&&(t=a.attributionName)}),this.CrmFrom.attributionInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,attributionName:t})},changeTime(){this.timeIdList.forEach(e=>{e.enumKey===this.CrmFrom.timeId&&(this.CrmFrom.timeName=e.enumValue)})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e}},created(){}},d=u,h=a("2877"),p=Object(h["a"])(d,r,i,!1,null,"097f03b8",null);t["a"]=p.exports},7032:function(e,t,a){"use strict";a("ae3d")},7112:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",attrs:{"label-width":"150px",model:e.CrmFrom,rules:e.CrmFromRules}},[e.isadivInfo?t("adivInfo",{attrs:{CrmFrom:e.CrmFrom.adivInfo,FromData:e.CrmFrom},on:{"update:CrmFrom":function(t){return e.$set(e.CrmFrom,"adivInfo",t)},"update:crm-from":function(t){return e.$set(e.CrmFrom,"adivInfo",t)},getConfiguration:e.getConfiguration}}):e._e(),t("el-form-item",{attrs:{label:"优先级：",prop:"channelConf.priorityOrder"}},[t("div",{staticClass:"block"},[t("el-slider",{attrs:{"show-input":""},model:{value:e.CrmFrom.channelConf.priorityOrder,callback:function(t){e.$set(e.CrmFrom.channelConf,"priorityOrder",t)},expression:"CrmFrom.channelConf.priorityOrder"}})],1)]),e.showExt18?t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1):e._e(),t("el-form-item",{attrs:{label:"推荐用语：",prop:"channelConf.execContent"}},[t("el-input",{attrs:{type:"textarea",rows:4,maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.channelConf.execContent,callback:function(t){e.$set(e.CrmFrom.channelConf,"execContent",t)},expression:"CrmFrom.channelConf.execContent"}})],1),e.isadivInfo?t("configurationSheet",{ref:"configurationSheet",attrs:{CrmFrom:e.CrmFrom.channelConf.channelExtConf},on:{configGsheet:e.configGsheet,"update:CrmFrom":function(t){return e.$set(e.CrmFrom.channelConf,"channelExtConf",t)},"update:crm-from":function(t){return e.$set(e.CrmFrom.channelConf,"channelExtConf",t)}}}):e._e()],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("57d8"),s=a("9044"),m=a("5ed5");const c=o["a"].common.getSysEnum;var u={components:{configurationSheet:n["a"],adivInfo:s["a"],Tips:m["a"]},props:["channelNewData","id"],data(){return{CrmFrom:{adivInfo:{},channelConf:{},channelId:"",channelName:"",columnExt18:"0"},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],priorityOrder:[{required:!0,message:"请输入优先等级",trigger:"blur"}],ceshi:[{required:!0,message:"请输入优先等级",trigger:"blur"}]}},timeIdList:[],adivList:[],isadivInfo:!1}},mounted(){this.getOptionData(),this.CrmFrom=JSON.parse(JSON.stringify(this.channelNewData)),this.isadivInfo=!0,this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(c,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e})},getConfiguration(e){1!==e.zt&&(this.CrmFrom.channelConf={priorityOrder:0,channelExtConf:{}}),this.$refs.configurationSheet.lookSchedulingInfo(e.configid)},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},changeTime(){this.timeIdList.forEach(e=>{e.enumKey===this.CrmFrom.timeId&&(this.CrmFrom.timeName=e.enumValue)})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},configGsheet(e){this.CrmFrom.channelConf.channelExtConf=Object.assign(this.CrmFrom.channelConf.channelExtConf,e),this.CrmFrom=JSON.parse(JSON.stringify(this.CrmFrom))}},created(){}},d=u,h=a("2877"),p=Object(h["a"])(d,r,i,!1,null,"207a2a98",null);t["a"]=p.exports},7248:function(e,t,a){"use strict";a("1326")},7400:function(e,t,a){"use strict";a("39d6")},"75c8":function(e,t,a){},"76a4":function(e,t,a){"use strict";var r=function(){var e,t=this,a=t._self._c;return a("div",{staticStyle:{width:"95%"}},[a("Tips",{attrs:{id:t.channelNewData.channelId},on:{getChannelDetail:t.getChannelDetail}}),a("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:t.CrmFrom,rules:t.CrmFromRules}},[t._e(),a("div",{staticClass:"header"},[a("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[a("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:t.changeAid},model:{value:t.CrmFrom.adivInfo.adivId,callback:function(e){t.$set(t.CrmFrom.adivInfo,"adivId",e)},expression:"CrmFrom.adivInfo.adivId"}},t._l(t.colAdivInfo.adivList,(function(e){return a("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId,disabled:t.selectedAdivId.has(e.adivId)}})})),1)],1)],1),a("el-form-item",{attrs:{label:"场景：",prop:"columnExt6"}},[a("el-select",{attrs:{placeholder:"请选择场景"},on:{change:t.changeScene},model:{value:t.CrmFrom.columnExt6,callback:function(e){t.$set(t.CrmFrom,"columnExt6",e)},expression:"CrmFrom.columnExt6"}},t._l(t.activeList,(function(e){return a("el-option",{key:e.enumId,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t.showExt18?a("el-form-item",{attrs:{label:"智能话术："}},[a("el-checkbox",{on:{change:()=>t.CrmFrom.columnExt18=t.checkColumnExt18?"1":"0"},model:{value:t.checkColumnExt18,callback:function(e){t.checkColumnExt18=e},expression:"checkColumnExt18"}},[t._v("启用")]),t.checkColumnExt18?a("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(e){return t.$forceUpdate()}},model:{value:t.CrmFrom.columnExt18,callback:function(e){t.$set(t.CrmFrom,"columnExt18",e)},expression:"CrmFrom.columnExt18"}},[a("el-radio",{attrs:{label:"1"}},[t._v("省端模型")]),a("el-radio",{attrs:{label:"2"}},[t._v("一级IOP模型")])],1):t._e()],1):t._e(),null!==(e=t.CrmFrom.adivInfo)&&void 0!==e&&e.adivId?a("UseScript",{ref:"useScript",attrs:{"label-width":"145px","channel-id":t.channelNewData.channelId,"channel-name":t.channelNewData.channelName,"script-id":t.CrmFrom.columnExt19,CrmFrom:t.CrmFrom},on:{change:t.changeScript}}):t._e(),a("el-form-item",{attrs:{label:"推荐营销用语：",prop:"marketingWords"}},[t.isStrArr?a("Face2FaceWords",{attrs:{marketingWords:t.CrmFrom.marketingWords}}):a("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},on:{input:function(e){return t.$forceUpdate()}},model:{value:t.CrmFrom.marketingWords,callback:function(e){t.$set(t.CrmFrom,"marketingWords",e)},expression:"CrmFrom.marketingWords"}})],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("b893"),s=a("00b8"),m=a("f1ce"),c=a("98d2"),u=a("cd74"),d=a("5ed5");const h=o["a"].common.getSysEnum,p=(o["a"].common.queryAdivInfo,o["a"].common.queryHallInfo);var C={props:["channelNewData","id","deleteSub","columnExt1","colAdivInfo","selectedAdivId"],components:{materialList:m["a"],UseScript:c["a"],Face2FaceWords:u["a"],Tips:d["a"]},data(){return{CrmFrom:{adivInfo:{},sceneInfo:{},arrInfo:{},channelId:"",channelName:"",attributionInfo:{},standard:"",CustomerRules:"",marketingWords:void 0,scene:"",columnExt1:"",columnExt6:void 0,channelConf:{channelExtConf:{CampChannelExtReq:{columnExt1:""}}},columnExt18:"0",columnExt19:"",columnExt20:""},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"change"}],columnExt6:[{required:!0,message:"请选择场景",trigger:"change"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},isStrArr:!1,timeIdList:[],attributionList:[],activeList:[]}},created(){if(this.getOptionData(),this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.columnExt1),this.$set(this.CrmFrom,"marketingWords",this.CrmFrom.marketingWords||""),this.checkColumnExt18=this.CrmFrom.columnExt18>0,this.CrmFrom.columnExt19&&this.CrmFrom.marketingWords)try{this.isStrArr=this.CrmFrom.marketingWords.includes("</header>")}catch(e){}},watch:{columnExt1(e,t){this.CrmFrom.columnExt1=e}},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(h,{enumType:"jx_906_scene"}).then(e=>{this.activeList=e}),await Object(l["i"])(p,{}).then(e=>{this.attributionList=e})},changeScene(e){var t="";this.activeList.forEach(a=>{e===a.enumId&&(t=a.enumValue)}),this.CrmFrom.scene=e,this.CrmFrom.sceneInfo=Object.assign({},this.CrmFrom.sceneInfo,{enumId:e,enumValue:t})},changeAid(e){var t;const a=null===(t=this.colAdivInfo.adivList)||void 0===t?void 0:t.find(t=>t.adivId===e);this.$set(this.CrmFrom,"adivInfo",{adivId:(null===a||void 0===a?void 0:a.adivId)||"",adivName:(null===a||void 0===a?void 0:a.adivName)||""}),this.$emit("changeAdiv",e),this.isStrArr=!1,this.CrmFrom.columnExt19="",this.CrmFrom.marketingWords="",this.$refs.useScript&&this.$nextTick(()=>{this.$refs.useScript.getScriptList()})},SubInstall(e=!0){var t=!0;return this.$refs.CrmFrom.validate(a=>{a||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(e&&this.$emit("saveChannelData",this.colAdivInfo.id,this.CrmFrom),t=!0):t=!1}),t},selectMaterial(e){this.$refs["material"].getMaterialList(),this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}},changeScript(e){if(this.CrmFrom.columnExt19=e.scriptId,!e.scriptId&&this.isStrArr)return this.$set(this.CrmFrom,"marketingWords",""),void(this.isStrArr=!1);this.isStrArr=!1,e.contentType<5&&(this.isStrArr=!0),this.CrmFrom=Object(s["a"])(e,this.CrmFrom),this.$forceUpdate()}}},v=C,f=(a("c691"),a("2877")),b=Object(f["a"])(v,r,i,!1,null,"4af847cc",null);t["a"]=b.exports},7779:function(e,t,a){"use strict";a("7b33")},"77fd":function(e,t,a){},7900:function(e,t,a){},7940:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"CrmFrom",attrs:{"label-width":"150px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivId,callback:function(t){e.$set(e.CrmFrom,"adivId",t)},expression:"CrmFrom.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{attrs:{label:"发送类型：",prop:"sendType"}},[t("el-select",{attrs:{placeholder:"请选择发送类型"},model:{value:e.CrmFrom.sendType,callback:function(t){e.$set(e.CrmFrom,"sendType",t)},expression:"CrmFrom.sendType"}},e._l(e.typeList,(function(e){return t("el-option",{key:e.enumKey,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("el-form-item",{attrs:{label:"视频短信产品编码：",prop:"videoSmsPlanId"}},[t("el-input",{model:{value:e.CrmFrom.videoSmsPlanId,callback:function(t){e.$set(e.CrmFrom,"videoSmsPlanId",t)},expression:"CrmFrom.videoSmsPlanId"}})],1),t("el-form-item",{attrs:{label:"彩信编码：",prop:"mmsId"}},[t("el-input",{model:{value:e.CrmFrom.mmsId,callback:function(t){e.$set(e.CrmFrom,"mmsId",t)},expression:"CrmFrom.mmsId"}})],1),t("el-form-item",{attrs:{label:"推荐用语：",prop:"execContent"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.execContent,callback:function(t){e.$set(e.CrmFrom,"execContent",t)},expression:"CrmFrom.execContent"}})],1),t("el-form-item",[t("el-button",{on:{click:e.SubInstall}},[e._v("保存当前设置")])],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05");const n=o["a"].common.queryAdivInfo,s=o["a"].common.getSysEnum;var m={props:["channelId"],data(){return{CrmFrom:{},CrmFromRules:{adivId:[{required:!0,message:"请选择运营位",trigger:"blur,change"}],sendType:[{required:!0,message:"请选择发送类型",trigger:"blur,change"}],videoSmsPlanId:[{required:!0,message:"请填写视频短信产品编码",trigger:"blur"}],mmsId:[{required:!0,message:"请填写彩信编码",trigger:"blur"}],execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}]},matList:[],typeList:[],adivList:[]}},mounted(){this.getOptionData()},methods:{getOptionData(){Object(l["i"])(n,{channelId:this.channelId}).then(e=>{this.adivList=e}),Object(l["i"])(s,{enumType:"E_608_SEND_TYPEd"}).then(e=>{this.typeList=e})},changeAid(){this.adivList.forEach(e=>{(this.CrmFrom.adivId=e.adivId)&&(this.CrmFrom.adivName=e.adivName)})},SubInstall(){this.$refs.CrmFrom.validate(e=>{})}}},c=m,u=a("2877"),d=Object(u["a"])(c,r,i,!1,null,"0ed81ca1",null);t["a"]=d.exports},"79a2":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("main",{staticClass:"script-main-content"},e._l(e.scriptList,(function(a,r){return t("el-tabs",{key:a.typeName,staticClass:"top-level-tabs"},[t("el-tab-pane",{attrs:{label:a.typeName}},[a.list&&a.list.length?[t("el-tabs",{attrs:{type:"card"},model:{value:e.richTextActive,callback:function(t){e.richTextActive=t},expression:"richTextActive"}},e._l(a.list,(function(i,l){return t("el-tab-pane",{attrs:{label:i.name,name:r+"-"+l}},[a.isRich?t("Editor",{attrs:{placeholder:"请输入"+i.name},model:{value:i.content,callback:function(t){e.$set(i,"content",t)},expression:"subItem.content"}}):t("el-input",{attrs:{type:"textarea",placeholder:"请输入"+i.name,autosize:{minRows:6,maxRows:10}},model:{value:i.content,callback:function(t){e.$set(i,"content",t)},expression:"subItem.content"}})],1)})),1)]:[t("el-tabs",{attrs:{type:"card"}},[t("el-tab-pane",{attrs:{label:a.typeName}},[a.uploadType?[t("Upload",{attrs:{type:"1"==a.uploadType?"image":"2"==a.uploadType?"video":"3"==a.uploadType?"audio":"image",action:"/mkt-term-svc/api/uploadScriptMaterial"},model:{value:e.scriptList[r],callback:function(t){e.$set(e.scriptList,r,t)},expression:"scriptList[i]"}}),t("el-form-item",{staticClass:"el-form-item-link-url",attrs:{label:"跳转链接：",rules:[{required:!0,message:"请输入链接地址",trigger:"blur"}]}},[t("el-input",{attrs:{placeholder:"请输入链接地址"},model:{value:a.linkUrl,callback:function(t){e.$set(a,"linkUrl",t)},expression:"item.linkUrl"}})],1)]:t("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:8},placeholder:"请输入"+a.typeName},model:{value:a.content,callback:function(t){e.$set(a,"content",t)},expression:"item.content"}})],2)],1)]],2)],1)})),1)},i=[],l=a("ceb0"),o=a("eae4"),n={components:{Editor:l["a"],Upload:o["a"]},model:{prop:"value",event:"change"},props:{value:{type:Array,default:()=>[]}},watch:{scriptList:{handler(e){this.$emit("change",e)},deep:!0}},data(){return{scriptList:[{typeId:"2",typeName:"推荐用语",content:"",uploadType:"",uploadFileUrl:"",uploadFileName:"",list:[]}],richTextActive:"0-0"}},methods:{},created(){this.value&&this.value.length&&(this.scriptList=JSON.parse(JSON.stringify(this.value)))}},s=n,m=(a("1c07"),a("2877")),c=Object(m["a"])(s,r,i,!1,null,"d31d9c80",null);t["a"]=c.exports},"7a69":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ProductDialog"},[t("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"选渠道",name:"channel"}},[t("div",{staticClass:"Channel-list"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.channelLoading,expression:"channelLoading"}],staticClass:"Channel"},[t("el-checkbox-group",{attrs:{disabled:e.isAI},on:{change:e.setTab},model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},e._l(e.SelectBuList,(function(a){return t("el-checkbox",{key:a.channelId,attrs:{label:a.channelId}},[e._v(e._s(a.channelName))])})),1)],1),t("div",{staticClass:"TabsCenter",attrs:{"element-loading-text":"正在校验保存中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"}},[t("el-tabs",{attrs:{type:"card",closable:!e.isAI,"before-leave":e.beforeLeave},on:{"tab-remove":e.removeTab,"tab-click":e.TabClick},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},e._l(e.editableTabs,(function(a,r){return t("el-tab-pane",{key:a.channelId,attrs:{label:a.channelName,name:a.channelId}},[t("div",{staticClass:"TabPane"},[t(a.component,{ref:"Component"+a.channelId,refInFor:!0,tag:"component",attrs:{channelNewData:a,adivListCB:a.adivList,id:a.channelId,deleteSub:e.deleteSub},on:{saveChannelData:e.saveChannelData,beforeLeave:e.beforeLeave,disableAddAdivFn:t=>{e.addBtnDisabled=t}}})],1)])})),1)],1)])])],1),e.editableTabs.length>0?t("div",{staticClass:"Product-button"},[e.showAddAdiv?t("el-button",{attrs:{disabled:e.addBtnDisabled,size:"medium"},on:{click:e.addPosition}},[e._v("添加运营位")]):e._e(),t("el-button",{attrs:{type:"success",size:"medium"},on:{click:e.saveChannel}},[e._v("确定")])],1):e._e()],1)},i=[],l=(a("14d9"),a("3c7a")),o=a("68e8"),n=a("138c"),s=a("4cb2"),m=a("3390"),c=a("7940"),u=a("c88b"),d=a("2486"),h=a("df4d"),p=a("6401"),C=a("3719"),v=a("a3cc"),f=a("9747"),b=a("4db8"),g=a("7112"),x=a("9c4a"),E=a("5ac7"),F=a("43fd"),y=a("b605"),I=a("4b54"),k=a("ecb5"),w=a("87ac"),_=a("e404"),N=a("9547"),S=a("14ea"),L=a("2ad0"),T=a("7ec3"),D=a("eafd"),$=a("9101"),O=a("9dc5"),A=a("d83e"),j=a("317a"),q=a("f04e"),P=a("521b"),M=a("523c"),V=a("4a44"),U=a("20d5"),R=a("0d29"),G=a("76a4"),W=a("a5b3"),B=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mutiple-wrap-content"},[t("Tips",{attrs:{id:e.id}}),t("div",{staticClass:"option"},[t("span",[e._v("推送方式：")]),t("el-radio-group",{model:{value:e.columnExt1,callback:function(t){e.columnExt1=t},expression:"columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.channelNewData.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.channelNewData.channelFlag}},[e._v("偏好推送")])],1)],1),t("transition-group",{attrs:{name:"fade"}},[e.positionList.length?e._l(e.positionList,(function(a,r){return t("div",{key:a.id,staticClass:"position-content",class:[1===e.positionList.length?"no-border":"",r>=e.currentIndex&&e.showMoveAnimation?"move":""]},[e.positionList.length>1?t("i",{staticClass:"el-icon-close",on:{click:function(t){return e.closePosition(r)}}}):e._e(),t(e.component,{ref:"comRef",refInFor:!0,tag:"component",attrs:{columnExt1:e.columnExt1,channelNewData:a.channelNewData,id:a.id,deleteSub:e.deleteSub,colAdivInfo:a,selectedAdivId:e.selectedAdivId},on:{changeAdiv:t=>e.changeAdiv(t,r),saveChannelData:e.saveChannelData,beforeLeave:e.beforeLeave}})],1)})):e._e()],2)],1)},z=[],H=a("0fea"),J=a("5e05"),Y=a("5ed5"),Q={name:"MutiplePositionComponent",components:{WillBuyApp:W["a"],ServiceHall:G["a"],Tips:Y["a"]},props:["channelNewData","id","deleteSub","adivListCB"],data(){return{component:null,positionList:[],adivList:[],currentIndex:0,showMoveAnimation:!1,columnExt1:"1",selectedAdivId:new Set,adivInfoList:new Array}},watch:{positionList:{handler(e){this.$emit("disableAddAdivFn",e.length===this.adivList.length);let t=new Set;e.forEach(e=>{e.selectedAdivId&&t.add(e.selectedAdivId)}),this.selectedAdivId=t},deep:!0}},created(){var e;this.component=906==this.channelNewData.channelId?"ServiceHall":"WillBuyApp",this.columnExt1=this.channelNewData.columnExt1||(null===(e=this.channelNewData.channelConf)||void 0===e||null===(e=e.channelExtConf)||void 0===e?void 0:e.columnExt1)||"1",this.channelNewData.channelFlag||(this.columnExt1="1"),this.echoData(),this.getAdivList()},methods:{saveChannelData(e,t){if(this.SubInstall(!1)){this.adivInfoList=[];for(let e=0;e<this.positionList.length;e++)this.adivInfoList.push(JSON.parse(JSON.stringify(this.$refs.comRef[e].CrmFrom)));this.adivInfoList.some(e=>!e)||this.$emit("saveChannelData",t,this.adivInfoList)}},beforeLeave(){this.$emit("beforeLeave")},SubInstall(e=!0){let t=[];for(let a=0;a<this.$refs.comRef.length;a++)t.push(this.$refs.comRef[a].SubInstall(e));return!t.some(e=>!1===e)},async getAdivList(){try{const e=await Object(H["i"])(J["a"].common.queryAdivInfo,{channelId:this.id});this.adivList=e;let t=JSON.parse(JSON.stringify(e));for(let a of this.positionList)a.adivList=t}catch(e){}},closePosition(e){this.currentIndex=e,this.showMoveAnimation=!0,this.positionList.splice(e,1),setTimeout(()=>{this.showMoveAnimation=!1},500)},addPosition(){if(!this.SubInstall(!1))return void this.$message.warning("请先填写完整当前运营位信息");let e=JSON.parse(JSON.stringify(this.adivList)),t=JSON.parse(JSON.stringify(this.channelNewData));t.adivInfo.adivId=null,t.adivInfo.adivName=null;let a={id:Date.now()+Math.floor(16777216*Math.random()).toString(16),selectedAdivId:null,adivList:e,channelNewData:t};this.positionList.push(a)},changeAdiv(e,t){this.$set(this.positionList[t],"selectedAdivId",e);let a=new Set;this.positionList.forEach(e=>{e.selectedAdivId&&a.add(e.selectedAdivId)}),this.selectedAdivId=a},echoData(){if(this.adivListCB&&this.adivListCB.length>0){let e=this.adivListCB;for(let t=0;t<e.length;t++){let a={id:Date.now()+Math.floor(16777216*Math.random()).toString(16),selectedAdivId:e[t].adivInfo.adivId,adivList:[],channelNewData:JSON.parse(JSON.stringify(e[t]))};this.positionList.push(a)}}else{let e={id:Date.now()+Math.floor(16777216*Math.random()).toString(16),selectedAdivId:null,adivList:[],channelNewData:JSON.parse(JSON.stringify(this.channelNewData))};this.positionList.push(e)}}}},K=Q,X=(a("458b"),a("2877")),Z=Object(X["a"])(K,B,z,!1,null,"18d5c31c",null),ee=Z.exports,te=(a("eced"),a("8864"),a("d39c")),ae=a("31b1"),re={props:{node:{type:Object,required:!0}},components:{MutiplePositionComponent:ee,CrmOperationDesk:o["a"],MarketingCall:n["a"],levelCall:s["a"],remind:m["a"],colorPlat:c["a"],ShortMessage:u["a"],GroupHand:d["a"],SparkAlliance:h["a"],SMS:p["a"],tinyOffice:C["a"],WX:v["a"],IOPInternet:f["a"],CustomerService:b["a"],DefaultItem:g["a"],Incoming:U["a"],ProductApp:R["a"],ServiceHall:G["a"],WillBuyApp:W["a"],ContentSMS:x["a"],MobileVideo:E["a"],PushNotification:F["a"],FiveCloudCard:y["a"],FiveMessage:I["a"],MessageEntrainment:k["a"],IVRsales:L["a"],OutboundMarking:w["a"],CustomerPass:_["a"],GridPass:N["a"],Linestore:S["a"],BelieveWithMe:T["a"],FindOneLevel:D["a"],MiguChannel:$["a"],EnterpriseWeChat:O["a"],OutboundForEight:A["a"],shortOffice:j["a"],GuangDianTong:q["a"],GovernmentEnterprise:M["a"],ChinaMobileApp:P["a"],Zhuangweisuixiao:V["a"]},data(){return{channelLoading:!1,activeName:"channel",isAI:!1,checkList:[],lastCheckList:[],deleteFlag:!1,filteValue:[],SelectBuList:[],editableTabsValue:"",channelFlag:null,editableTabsInfo:{},editableTabs:[],currentView:[],channelData:[],likeList:[],deleteSub:"",buttonType:!1,showAddAdiv:!1,addBtnDisabled:!1}},computed:{isEdit(){return"Channel"===this.node.type}},watch:{editableTabsValue(e){const t=["906","922","962","966","961","963","965"];t.includes(e.toString())?this.showAddAdiv=!0:this.showAddAdiv=!1}},async created(){this.getChannelList(),this.handleCompatibility()},mounted(){},methods:{initChannelList(){const{businessData:{channelList:e}}=this.node;e&&e.length&&e.forEach(e=>{e.component=Object(l["a"])(e.channelId)});const t=e[0]||{};this.checkList=e.map(e=>e.channelId),this.lastCheckList=[...this.checkList],this.editableTabs=e,this.editableTabsInfo=t,this.editableTabsValue=t.channelId},setTab(e){this.lastCheckList.forEach(t=>{const a=e.indexOf(t)<0;if(a){const e=this.editableTabs.findIndex(e=>e.channelId===t);if(this.editableTabs=this.editableTabs.filter(e=>e.channelId!==t),this.editableTabs.length){const t=e>=this.editableTabs.length?this.editableTabs[e-1]:this.editableTabs[e];this.editableTabsInfo=t,this.editableTabsValue=t.channelId}else this.editableTabsInfo=null,this.editableTabsValue=""}}),e.forEach(e=>{const t=this.lastCheckList.indexOf(e)<0;if(t){const t=this.SelectBuList.find(t=>t.channelId===e);this.addTab(t)}}),this.lastCheckList=[...e]},TabClick(e){this.buttonType=!1;const t=["906","922","962","966","961","963","965"];if(t.includes(e.name)){const t=e.$children[0];this.addBtnDisabled=t.positionList.length===t.adivList.length}},beforeLeave(){return!0},addTab(e){this.editableTabs.push({component:Object(l["a"])(e.channelId),channelId:e.channelId,channelName:e.channelName,adivInfo:e.adivInfo||{adivId:"",adivName:""},channelConf:{},channelFlag:!1}),this.editableTabsInfo=e,this.editableTabsValue=e.channelId},removeTab(e){const t=this.editableTabs.findIndex(t=>t.channelId===e);if(this.checkList=this.checkList.filter(t=>t!==e),this.lastCheckList=this.lastCheckList.filter(t=>t!==e),this.editableTabs=this.editableTabs.filter(t=>t.channelId!==e),this.editableTabs.length){const e=t>=this.editableTabs.length?this.editableTabs[t-1]:this.editableTabs[t];this.editableTabsInfo=e,this.editableTabsValue=e.channelId}else this.editableTabsInfo=null,this.editableTabsValue=""},async getChannelByCust(e){this.SelectBuList=e},getChannelList(){this.channelLoading=!0,Object(H["i"])(te["a"].seapi.getOnlineChannelsByUser,{onlineStatus:"1"}).then(async e=>{await this.getChannelByCust(e),this.$forceUpdate()}).then(()=>{this.isEdit&&this.initChannelList()}).finally(()=>{this.channelLoading=!1})},saveChannelData(e,t){const a=this.editableTabs.find(t=>t.channelId===e.channelId);Object.assign(a,e),t&&(a.adivList=t)},CurrentSettings(e=!0){if(void 0===this.$refs["Component"+this.editableTabsValue])return!0;if(["808","906","922"].includes(this.editableTabsValue)){if(this.buttonType){if(this.deleteFlag)return this.$refs["Component"+this.editableTabsValue][0].SubInstall(e);{let t=[];if(0===this.filteValue.length)return this.$refs["Component"+this.editableTabsValue][0].SubInstall(e);this.filteValue.forEach(a=>{t.push(this.$refs["Component"+a][0].SubInstall(e))});const a=t.every(e=>!0===e);return a}}if(this.deleteFlag)return!0;{let t=[];if(0===this.filteValue.length)return this.$refs["Component"+this.editableTabsValue][0].SubInstall(e);this.filteValue.forEach(a=>{t.push(this.$refs["Component"+a][0].SubInstall(e))});const a=t.some(e=>1==e);return a}}return this.$refs["Component"+this.editableTabsValue][0].SubInstall(e)},async saveChannel(){let e=!0;for(let t=0;t<this.editableTabs.length;t++){let a=this.$refs["Component"+this.editableTabs[t].channelId][0].SubInstall(!1);if("[object Promise]"===Object.prototype.toString.call(a)&&(a=await a),!a){e=!1;const a=this.editableTabs[t];this.editableTabsInfo=a,this.editableTabsValue=a.channelId;break}}e?this.ChannelSubmit():this.$alert("请先完善渠道配置项信息!","添加失败",{confirmButtonText:"确定",customClass:"errorPrompt"})},async ChannelSubmit(){for(let t=0;t<this.editableTabs.length;t++)this.$refs["Component"+this.editableTabs[t].channelId][0].SubInstall(!0);const e=this.editableTabs.map(e=>({...e,channelConf:{...e.channelConf,updateCycle:+e.UPDATE_CYCLE||e.channelConf.updateCycle,wavesChannelPid:null,wavesRuleId:null}}));this.$emit("save","channel",{channelList:e})},addTab2(e){this.deleteFlag=!1;const t=this.likeList.some(t=>t.channelId===e.channelId),a=["808","906","922"],r=this.editableTabs.some(e=>a.includes(e.channelId)),i=this.editableTabs.some(t=>e.channelId===t.channelId);if(!this.CurrentSettings(!1))return this.$message.error("请先完成当前渠道配置项信息"),void(e.channelId!==this.editableTabsValue&&!1===i&&(e.checked=!1));let o=this.editableTabs.filter(t=>t.channelId===e.channelId);if(o.length>0)return void(a.includes(e.channelId)&&a.forEach(e=>{this.editableTabs.some(t=>t.channelId===e)||this.$refs["Selectbutton"].Unhighlight(e)}));let n=e.channelId;if(a.includes(n))if(r)this.editableTabs.push({channelId:e.channelId,channelName:e.channelName,adivInfo:{},channelConf:{},channelFlag:t}),this.editableTabsValue=n,this.editableTabsInfo=e,this.currentView.push(Object(l["a"])(n)),a.forEach(e=>{this.editableTabs.some(t=>t.channelId===e)||this.$refs["Selectbutton"].Unhighlight(e)});else{let t=[];this.SelectBuList.forEach(e=>{"808"!==e.channelId&&"906"!==e.channelId&&"922"!==e.channelId||t.push(e)}),t=t.map(e=>(this.likeList.some(t=>e.channelId===t.channelId)?e.channelFlag=!0:e.channelFlag=!1,e)),t.forEach(e=>{this.editableTabs.push({channelId:e.channelId,channelName:e.channelName,adivInfo:{},channelConf:{},channelFlag:e.channelFlag}),this.currentView.push(Object(l["a"])(e.channelId))}),this.filteValue=t.map(e=>e.channelId),this.editableTabsValue=n,this.editableTabsInfo=e}else this.editableTabs.push({channelId:e.channelId,channelName:e.channelName,adivInfo:{},channelConf:{},channelFlag:t}),this.editableTabsValue=n,this.editableTabsInfo=e,this.currentView.push(Object(l["a"])(n));const s=["801","964","960"];s.includes(e.channelId.toString())&&this.remindTip(e);const m=["906","922","962","966","961","963","965"];m.includes(e.channelId.toString())&&(this.showAddAdiv=!0)},async remindTip(e){var t;let a=null===(t=this.SceneNodeData[0][1])||void 0===t?void 0:t.NodeObj[0],r=null===a||void 0===a?void 0:a.customNum,i=null===a||void 0===a?void 0:a.updateCycle,l=1===i?"未完成部分将在次日继续推送。":"未完成部分将不再推送，次日按更新客群推送。";try{const t=await Object(H["i"])(ae["a"].channel.queryChannelExecInfo,{channelId:e.channelId});if(t.execCapacity=t.execCapacity||0,t.execNum=t.execNum||0,t.noExecNum=t.noExecNum||0,r<=t.execCapacity-t.execNum-t.noExecNum)return;this.$message({message:`该触点当前待推送信息 ${t.noExecNum} 条，\n                        当日该触点实际还能支撑推送约 ${t.execCapacity-t.execNum} 条，\n                        如增加本策略推送任务，今日可能无法完成推送，${l}`,type:"warning",customClass:"message-remind",duration:5e3,offset:60,showClose:!0})}catch{}},addPosition(){this.$refs["Component"+this.editableTabsValue][0].addPosition()},handleCompatibility(){var e;const{type:t}=this.$route.query;this.$store.commit("extendData/SET_CUSTGOUPSOURCE",1);const a=null===(e=this.node.nodeLines.find(e=>"Product"===e.nodeType))||void 0===e?void 0:e.nodeId,r=$graph.findDataById(a).businessData;if("1"===t||"2"===t){var i;this.isAI=!0;let e=null===(i=this.node.nodeLines.find(e=>"AiCustomer"===e.nodeType))||void 0===i?void 0:i.nodeId;var l;if(!e)e=null===(l=this.node.nodeLines.find(e=>"Customer"===e.nodeType||"AiScene"===e.nodeType))||void 0===l?void 0:l.nodeId,this.isAI=!1;const t=$graph.findDataById(e).businessData;return void this.$store.commit("MarkPl/replaceSceneNodeData",{customer:[t.customerInfo],product:r.productList.map(e=>({...e,flag:"product"}))})}const o=this.node.nodeLines.findIndex(e=>"Scene"===e.nodeType),n=$graph.findDataById(this.node.nodeLines[o].nodeId),{customerInfo:s={customSourceId:"2"},attrType:m}=n.businessData;this.$store.commit("MarkPl/replaceSceneNodeData",{customer:[s],product:r.productList.map(e=>({...e,flag:"product"}))})}}},ie=re,le=(a("dcfa"),a("9de8"),Object(X["a"])(ie,r,i,!1,null,"31a0d058",null));t["default"]=le.exports},"7b33":function(e,t,a){},"7b5a":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"Selected"},[e._m(0),t("div",{staticClass:"title label"},[t("span",[e._v(e._s(e.title))])]),t("div",{staticClass:"label"},e._l(e.newLabel,(function(a){return t("el-tag",{key:a[e.Default.id],staticClass:"tag-success",attrs:{type:"success",closable:"","disable-transitions":""},on:{close:function(t){return e.handleClose(a)}}},[e._v(" "+e._s(a[e.Default.value])+" ")])})),1),e.showHistoryBtn?t("el-button",{staticStyle:{"margin-left":"auto"},attrs:{type:"primary"},on:{click:function(t){return e.$emit("openHistory")}}},[e._v(" 营销历史 ")]):e._e()],1)])},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"Selected-icon label"},[t("i",{staticClass:"iconfont icongonggongtubiao-huitiaoliangcedianzhui"})])}],l={props:{showHistoryBtn:{type:Boolean,default:()=>!1},Label:{type:Array,default:()=>[]},Default:{type:Object,default:()=>({id:"id",value:"value"})},isPulldown:{type:Boolean,default:()=>!0},ismutex:{type:Boolean,default:()=>!0},title:{type:String,default:()=>"已选产品"},labelFlag:{type:String,default:()=>"product"}},watch:{Label(e,t){0!==e.length?e[0].customerFlag?this.newLabel=this.Label:this.newLabel=e.filter(e=>(void 0===e.flag&&(e.flag=this.labelFlag),e.flag===this.flag)):this.newLabel=this.Label},labelFlag(e,t){this.flag=e,this.newLabel=this.Label.filter(t=>t.flag===e)}},mounted(){this.newLabel=this.Label.filter(e=>e.flag===this.flag)},data(){return{SetMeal:!1,flag:"product",newLabel:[]}},methods:{handleClose(e){this.$emit("close",e)}},created(){}},o=l,n=(a("0924"),a("c37e"),a("2877")),s=Object(n["a"])(o,r,i,!1,null,"88aeb586",null);t["a"]=s.exports},"7b98":function(e,t,a){"use strict";a("eb28")},"7ec3":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"150px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1)],1),e.showExt18?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1)],1):e._e(),e.CrmFrom.adivInfo.adivId?t("el-col",{attrs:{span:24}},[t("UseScript",{ref:"useScript",attrs:{"label-width":"150px","channel-id":e.channelNewData.channelId,"channel-name":e.channelNewData.channelName,"script-id":e.CrmFrom.columnExt19,CrmFrom:e.CrmFrom},on:{change:e.changeScript}})],1):e._e(),"9241"!==e.CrmFrom.adivInfo.adivId?[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"营销用语：",prop:"EXEC_CONTENT"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{id:"smsDetail",type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.EXEC_CONTENT,callback:function(t){e.$set(e.CrmFrom,"EXEC_CONTENT",t)},expression:"CrmFrom.EXEC_CONTENT"}})],1)],1),t("el-col",{attrs:{span:24}},[1==e.custgroupSource?t("el-form-item",{attrs:{label:"营销用语替换变量：","label-width":"148px"}},[t("DNAReplaceVar",{on:{getVar:e.getContent}})],1):t("el-form-item",{attrs:{label:"营销用语替换变量：","label-width":"148px"}},e._l(e.replaceVar,(function(a){return t("el-tag",{key:a.id,attrs:{type:"info"},on:{click:function(t){return e.getContent(a.attrCol)}}},[e._v(e._s(a.attrColName))])})),1)],1)]:e._e(),"9241"===e.CrmFrom.adivInfo.adivId?[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"需求类型：",prop:"columnExt2"}},[t("el-select",{attrs:{placeholder:"请选择需求类型"},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}},e._l(e.requirement,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"客服文档：",prop:"columnExt3"}},[t("Upload",{attrs:{accept:".doc, .docx, .pdf",action:e.action,fileList:e.fileList,limit:1},on:{changeFile:e.changeFile}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"图片：",prop:"columnExt4"}},[t("Upload",{ref:"uploadImgRef",attrs:{accept:"image/*",tip:"只能上传png,jpg,jpeg文件，且不超过5M",action:e.action,fileList:e.imgList,limit:1,rules:{size:5242880}},on:{changeFile:e.changeImage}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"宣传文案：",prop:"columnExt7"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{type:"textarea",placeholder:"请输入宣传文案"},model:{value:e.CrmFrom.columnExt7,callback:function(t){e.$set(e.CrmFrom,"columnExt7",t)},expression:"CrmFrom.columnExt7"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"链接：",prop:"columnExt6"}},[t("el-input",{attrs:{placeholder:"请输入链接"},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt6,callback:function(t){e.$set(e.CrmFrom,"columnExt6",t)},expression:"CrmFrom.columnExt6"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"承载渠道：",prop:"columnExt8"}},[t("el-checkbox-group",{on:{change:e.checkChange},model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[t("el-checkbox",{attrs:{label:"和我信通讯模块"}}),t("el-checkbox",{attrs:{label:"微信营业厅"}}),t("el-checkbox",{attrs:{label:"江西移动官网（掌端）"}})],1)],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"活动主题：",prop:"columnExt9"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{placeholder:"请输入活动主题"},model:{value:e.CrmFrom.columnExt9,callback:function(t){e.$set(e.CrmFrom,"columnExt9",t)},expression:"CrmFrom.columnExt9"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"目标用户提取口径：",prop:"columnExt10"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.columnExt10,callback:function(t){e.$set(e.CrmFrom,"columnExt10",t)},expression:"CrmFrom.columnExt10"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"备注：",prop:"columnExt11"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.columnExt11,callback:function(t){e.$set(e.CrmFrom,"columnExt11",t)},expression:"CrmFrom.columnExt11"}})],1)],1)]:e._e()],2)],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("0557"),s=a("f1ce"),m=a("5ed5"),c=a("98d2"),u=a("d443"),d=a("6501"),h=a("b893"),p=a("00b8");const C=o["a"].common.queryAdivInfo;var v={props:["channelNewData","id","deleteSub"],components:{materialList:s["a"],Tips:m["a"],UseScript:c["a"],Upload:u["a"],DNAReplaceVar:d["a"]},data(){return{CrmFrom:{adivInfo:{},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",standard:"",CustomerRules:"",IF_HAVE_VAR:"0",columnExt2:"",columnExt3:"",columnExt4:"",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt9:"",columnExt10:"",columnExt11:"",columnExt18:"0",columnExt19:"",columnExt20:"",materialName:"",EXEC_CONTENT:""},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{EXEC_CONTENT:[{required:!0,message:"请输入营销用语",trigger:"blur"}],columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],columnExt2:[{required:!0,message:"请选择需求类型",trigger:"blur"}],columnExt7:[{required:!0,message:"请输入宣传文案",trigger:"blur"}],columnExt8:[{required:!0,message:"请选择承载渠道",trigger:"blur"}],columnExt9:[{required:!0,message:"请输入活动主题",trigger:"blur"}],columnExt10:[{required:!0,message:"请输入目标用户提取口径",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],replaceVar:[],checkList:[],requirement:[{label:"业务办理",value:"1"},{label:"活动宣传",value:"2"}],fileList:[],imgList:[],ShortMsgContent:""}},watch:{channelNewData:{handler(){var e;this.CrmFrom=Object(h["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"EXEC_CONTENT",this.channelNewData.EXEC_CONTENT||""),this.$set(this.CrmFrom,"columnExt7",this.CrmFrom.columnExt7||(null===(e=this.CrmFrom.channelConf)||void 0===e||null===(e=e.channelExtConf)||void 0===e?void 0:e.columnExt7)||""),this.checkList=this.CrmFrom.columnExt8?this.CrmFrom.columnExt8.split(","):[],this.fileList=this.CrmFrom.columnExt3?[{fileName:this.getFileNameByUrl(this.CrmFrom.columnExt3),url:this.CrmFrom.columnExt3}]:[],this.imgList=this.CrmFrom.columnExt4?[{fileName:this.getFileNameByUrl(this.CrmFrom.columnExt4),url:this.CrmFrom.columnExt4}]:[],this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0},CrmFrom:{handler(e,t){},deep:!0},deleteSub(){},SMS_CONTENT(e){if(e){const t=/\$[a-zA-Z0-9_\u4e00-\u9fa5]+\$/g,a=e.match(t);a&&a.length>0?this.CrmFrom.IF_HAVE_VAR="1":this.CrmFrom.IF_HAVE_VAR="0"}else this.CrmFrom.IF_HAVE_VAR="0"}},computed:{header(){return window.sessionStorage.getItem("IOP_TOKEN")},action(){return n["a"].commonConfig.baseURL+"/plan-svc/api/action/tactics/tacticsCreate/jx/fileUpload"},SMS_CONTENT(){return this.CrmFrom.EXEC_CONTENT},custgroupSource(){return this.$store.state.extendData.custgroupSource}},created(){var e;this.getOptionData(),this.listCustAttr(),this.CrmFrom=Object(h["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"EXEC_CONTENT",this.CrmFrom.EXEC_CONTENT||""),this.$set(this.CrmFrom,"columnExt7",this.CrmFrom.columnExt7||(null===(e=this.CrmFrom.channelConf)||void 0===e||null===(e=e.channelExtConf)||void 0===e?void 0:e.columnExt7)||""),this.checkList=this.CrmFrom.columnExt8?this.CrmFrom.columnExt8.split(","):[],this.fileList=this.CrmFrom.columnExt3?[{fileName:this.getFileNameByUrl(this.CrmFrom.columnExt3),url:this.CrmFrom.columnExt3}]:[],this.imgList=this.CrmFrom.columnExt4?[{fileName:this.getFileNameByUrl(this.CrmFrom.columnExt4),url:this.CrmFrom.columnExt4}]:[],this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(C,{channelId:this.id}).then(e=>{this.adivList=e})},changeAid(e){const t=this.adivList.find(t=>t.adivId===e);this.$set(this.CrmFrom,"adivInfo",{adivId:(null===t||void 0===t?void 0:t.adivId)||"",adivName:(null===t||void 0===t?void 0:t.adivName)||""}),this.CrmFrom.columnExt19="",this.$refs.useScript&&this.$nextTick(()=>{this.$refs.useScript.getScriptList()}),this.$forceUpdate()},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},async listCustAttr(){var e;const t=null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId;await Object(l["i"])(o["a"].common.listCustAttr+"?custGroupId="+t).then(e=>{this.replaceVar=e})},getContent(e){let t="$"+e+"$";e=t,this.CrmFrom.EXEC_CONTENT||(this.CrmFrom.EXEC_CONTENT=""),this.ShortMsgContent=e;const a=document.querySelector("#smsDetail");if(a.selectionStart||0===a.selectionStart){var r=a.selectionStart,i=a.selectionEnd;this.CrmFrom={...this.CrmFrom,EXEC_CONTENT:a.value.substring(0,r)+e+a.value.substring(i,a.value.length)},this.$nextTick(),a.focus(),a.setSelectionRange(i+e.length,i+e.length)}else this.CrmFrom.EXEC_CONTENT+=e},selectMaterial(e){this.$refs["material"].getMaterialList(),this.$refs["material"].showDialog(e)},checkChange(e,t){this.CrmFrom.columnExt8=e.join(",")},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}},changeFile(e){e.length>0?this.CrmFrom.columnExt3=e[0].url:this.CrmFrom.columnExt3=""},changeImage(e){e.length>0?this.CrmFrom.columnExt4=e[0].url:this.CrmFrom.columnExt4=""},getFileNameByUrl(e){return e.split("/").pop()},changeScript(e){var t;(this.CrmFrom.columnExt19=e.scriptId,"8"==e.contentType||"9"==e.contentType)&&(null===(t=this.$refs.uploadImgRef)||void 0===t||t.clearFileList(),this.$nextTick(()=>{this.imgList=e.marketingWords[0].uploadFileUrl?[{fileName:e.marketingWords[0].uploadFileName,url:e.marketingWords[0].uploadFileUrl}]:[]}));this.CrmFrom=Object(p["a"])(e,this.CrmFrom),this.$forceUpdate()}}},f=v,b=(a("3d00"),a("2877")),g=Object(b["a"])(f,r,i,!1,null,"07846e72",null);t["a"]=g.exports},"854d":function(e,t,a){"use strict";a("df2f")},"856c":function(e,t,a){e.exports=a.p+"img/loading.315fa32e.gif"},"863d":function(e,t,a){},"864b":function(e,t,a){"use strict";a("3193")},"866a":function(e,t,a){},"87ac":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("div",{staticStyle:{display:"flex","justify-content":"end"}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"外呼类型：",prop:"columnExt3"}},[t("el-select",{attrs:{placeholder:"请选择外呼类型"},on:{change:e.changeOutbound},model:{value:e.CrmFrom.columnExt3,callback:function(t){e.$set(e.CrmFrom,"columnExt3",t)},expression:"CrmFrom.columnExt3"}},e._l(e.outboundType,(function(e){return t("el-option",{key:e.enumId,attrs:{label:e.enumValue,value:e.enumValue}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"标准化素材：",prop:"columnExt20"}},[t("div",{staticClass:"select-material",on:{click:function(t){return e.selectMaterial(!0)}}},[e._v(e._s(e.CrmFrom.materialName||"请选择"))])])],1),"调研类_地市"==e.CrmFrom.columnExt3?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"地市：",prop:"columnExt8"}},[t("el-select",{staticStyle:{width:"189px"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择地市",disabled:"999"!=e.cityId},model:{value:e.citySelect,callback:function(t){e.citySelect=t},expression:"citySelect"}},e._l(e.cityList,(function(e){return t("el-option",{key:e.cityId,attrs:{label:e.cityName,value:e.cityId}})})),1)],1)],1):e._e(),e.showExt18?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1)],1):e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"营销用语：",prop:"columnExt2","label-width":"148px"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],ref:"wording",attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"标签属性：","label-width":"148px"}},[t("div",{staticClass:"label-content"},[t("div",{staticClass:"label"},["variable"==e.lableProp?t("div",{staticClass:"label-item"},e._l(e.labelConfig[e.lableProp],(function(a){return t("span",{key:a.id,on:{click:function(t){return e.addWord(a.attrCol)}}},[e._v(" "+e._s(a.attrColName)+" ")])})),0):t("div",{staticClass:"label-item"},e._l(e.labelConfig[e.lableProp],(function(a){return t("span",{key:a.labelId,class:[e.selectLabelList.some(e=>e.labelId==a.labelId)?"active":""],on:{click:function(t){return e.pushPoint(a)}}},[e._v(e._s(a.labelName)+" ")])})),0)]),t("el-radio-group",{attrs:{size:"mini"},model:{value:e.lableProp,callback:function(t){e.lableProp=t},expression:"lableProp"}},[t("el-radio-button",{attrs:{label:"variable"}},[e._v("营销变量")]),t("el-radio-button",{attrs:{label:"touchPoint"}},[e._v("推送至触点")])],1)],1)])],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"营销(服务)目标客户及提取原则：",prop:"columnExt4","label-width":"148px"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{id:"smsDetail",type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleTextareaKeydown.apply(null,arguments)}},model:{value:e.CrmFrom.columnExt4,callback:function(t){e.$set(e.CrmFrom,"columnExt4",t)},expression:"CrmFrom.columnExt4"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"任务描述及要求：",prop:"columnExt5","label-width":"148px"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{id:"smsDetail",type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"说明任务完成目标，例如：办理合约等"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleTextareaKeydown.apply(null,arguments)}},model:{value:e.CrmFrom.columnExt5,callback:function(t){e.$set(e.CrmFrom,"columnExt5",t)},expression:"CrmFrom.columnExt5"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"外呼需求附件（含需求正文、外呼脚本、客服文档等）：",prop:"columnExt6","label-width":"148px"}},[t("el-upload",{staticClass:"upload-demo",attrs:{action:e.action,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"before-remove":e.beforeRemove,multiple:"",limit:1,"on-exceed":e.handleExceed,headers:{Authorization:e.header},"file-list":e.fileList}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)],1)],1)],1),t("materialList",{ref:"material",attrs:{adivId:e.CrmFrom.adivInfo.adivId,channelId:e.id},on:{addMaterial:e.addMaterial}})],1)},i=[],l=(a("14d9"),a("0fea")),o=a("5e05"),n=a("a454"),s=a("f1ce"),m=a("5ed5"),c=a("b893"),u=a("0557");const d=o["a"].common.getSysEnum,h=o["a"].common.queryAdivInfo,p=o["a"].common.queryHallInfo;var C={props:["channelNewData","id","deleteSub"],components:{materialList:s["a"],Tips:m["a"]},data(){return{CrmFrom:{adivInfo:{adivName:""},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",columnExt3:"",standard:"",CustomerRules:"",marketingWords:"",columnExt2:"",columnExt4:"",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt9:"",columnExt18:"0",checked:Boolean},showExt18:!1,checkColumnExt18:!1,fileList:[],citySelect:[],pass:!0,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],columnExt3:[{required:!0,message:"请选择外呼类型",trigger:"blur"}],columnExt2:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],columnExt4:[{required:!0,message:"请输入营销(服务)目标客户及提取原则",trigger:"blur"}],columnExt5:[{required:!0,message:"请输入任务描述及要求",trigger:"blur"}],columnExt6:[{required:!0,message:"请选择要上传的文件",trigger:"blur"}],columnExt8:[{required:!0,message:"请选择地市",trigger:"change"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],outboundType:[],cityList:[],labelConfig:{variable:[],touchPoint:[{labelName:"可呼时段",labelId:"id123"}],availableLabelIdList:[]},lableProp:"variable",selectLabelList:[]}},watch:{channelNewData:{handler(){this.CrmFrom=Object(c["d"])(this.channelNewData),this.CrmFrom=Object(c["d"])(this.channelNewData),this.CrmFrom.columnExt6&&(this.fileList=[{name:this.CrmFrom.columnExt6}]),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt2",this.CrmFrom.columnExt2||""),this.$set(this.CrmFrom,"columnExt8",this.CrmFrom.columnExt8||""),this.CrmFrom.columnExt8&&(this.citySelect=this.CrmFrom.columnExt8.split(",")),this.checkColumnExt18=this.CrmFrom.columnExt18>0,this.getLabelList(),this.listCustAttr()},deep:!0},citySelect:{handler(e,t){0==e.length?(this.CrmFrom.columnExt8="",this.CrmFrom.columnExt9="全部"):(this.CrmFrom.columnExt8=e.join(","),this.CrmFrom.columnExt9=e.map(e=>this.cityList.find(t=>t.cityId==e).cityName).join(","))},deep:!0}},computed:{header(){return window.sessionStorage.getItem("IOP_TOKEN")},action(){return u["a"].commonConfig.baseURL+"/element-svc/api/jx/file/upload"},cityId(){return window.sessionStorage.getItem("cityId")}},mounted(){this.getOptionData(),this.getSysEnum(),this.CrmFrom=Object(c["d"])(this.channelNewData),this.CrmFrom.columnExt6&&(this.fileList=[{name:this.CrmFrom.columnExt6}]),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt2",this.CrmFrom.columnExt2||""),this.$set(this.CrmFrom,"columnExt8",this.CrmFrom.columnExt8||""),this.CrmFrom.columnExt8&&(this.citySelect=this.CrmFrom.columnExt8.split(",")),this.checkColumnExt18=this.CrmFrom.columnExt18>0,this.getLabelList(),this.listCustAttr()},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){Object(l["i"])(n["a"].user.citySelectData).then(e=>{this.cityList=e.filter(e=>"-1"!=e.cityId&&"999"!=e.cityId)}),await Object(l["i"])(d,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(h,{channelId:this.id}).then(e=>{this.adivList=e}),await Object(l["i"])(p,{}).then(e=>{this.attributionList=e})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},handleRemove(e,t){},handleExceed(e,t){this.$message.warning(`当前限制选择 1个文件，本次选择了 ${e.length} 个文件，共选择了 ${e.length+t.length} 个文件`)},beforeRemove(e,t){return this.$confirm(`确定移除 ${e.name}？`)},handleSuccess(e){this.CrmFrom={...this.CrmFrom,columnExt6:e.data.fileName}},onUploadBeforeSend(e){let t=e.name.substring(e.name.lastIndexOf(".")+1);const a="xls"===t,r="xlsx"===t,i="png"===t,l="jpg"===t,o="doc"===t;let n=e.size/1024/1024<5?1:0;0===n&&this.$message({message:"上传文件大小不能超过5MB!",type:"error"}),a||r||i||l||o||this.$message.error("请上传正确的文件格式");let s=a||r||i||l||o;return s},selectMaterial(e){this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}},async getSysEnum(){await Object(l["i"])(o["a"].common.getSysEnum,{enumType:"10085_wh_type"}).then(e=>{this.outboundType=e})},async listCustAttr(){var e;const t=null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId;try{const e=await Object(l["i"])(o["a"].common.listCustAttr+"?custGroupId="+t);this.labelConfig.variable=e}catch(a){}},async getLabelList(){try{var e;const t=await Object(l["i"])(n["a"].custgroup.getLabelByChannelId,{channelId:this.id,customGroupId:null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId});this.labelConfig.touchPoint=t.allLabelInfoList.filter(e=>t.availableLabelIdList.includes(e.labelId)),this.CrmFrom.columnExt7&&(this.selectLabelList=this.labelConfig.touchPoint.filter(e=>this.CrmFrom.columnExt7.split(",").includes(e.labelId)))}catch(t){this.labelConfig.touchPoint=[]}},addWord(e){let t=this.$refs.wording.$el.querySelector(".el-textarea__inner");void 0===this.CrmFrom.columnExt2&&(this.CrmFrom.columnExt2=""),this.CrmFrom.columnExt2+=e,this.$forceUpdate(),t.focus()},pushPoint(e){this.selectLabelList.some(t=>t.labelId==e.labelId)?this.selectLabelList=this.selectLabelList.filter(t=>t.labelId!=e.labelId):this.selectLabelList.push(e),this.CrmFrom.columnExt7=this.selectLabelList.map(e=>e.labelId).join(",")},handleTextareaKeydown(){let e=arguments[0];if("Enter"===e.key||"Enter"===e.code||13==e.keyCode)return e.returnValue=!1,!1},changeOutbound(e){"调研类_地市"==e?"999"==this.cityId?(this.CrmFrom.columnExt8="",this.CrmFrom.columnExt9="",this.citySelect=[]):(this.CrmFrom.columnExt8=this.cityId,this.CrmFrom.columnExt9=this.cityList.find(e=>e.cityId==this.cityId).cityName,this.citySelect=[this.cityId]):(this.CrmFrom.columnExt8="",this.CrmFrom.columnExt9="")}},created(){}},v=C,f=(a("2ec7"),a("2877")),b=Object(f["a"])(v,r,i,!1,null,"084511de",null);t["a"]=b.exports},8864:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"f",(function(){return i})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return n})),a.d(t,"e",(function(){return s}));const r={product:"0",customer:"1",helpDoc:"2"},i={auto:-1,exist:1},l={auto:-1,group:0,label:1},o={auto:-1,exist:1},n={default:0,manual:1},s={num:0,score:1}},8914:function(e,t,a){"use strict";a("3f74")},"89b7":function(e,t,a){"use strict";a("7900")},"8c8d":function(e,t,a){"use strict";a("65e9")},"8d22":function(e,t,a){"use strict";a("1a65")},"8eb2":function(e,t,a){},9011:function(e,t,a){},9044:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.DataFrom.adivId,callback:function(t){e.$set(e.DataFrom,"adivId",t)},expression:"DataFrom.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1)],1)},i=[],l=a("0fea"),o=a("5e05");const n=o["a"].common.queryAdivInfo;var s={props:["CrmFrom","FromData"],data(){return{DataFrom:{},adivList:[]}},mounted(){this.getAdivInfo()},methods:{async getAdivInfo(){await Object(l["i"])(n,{channelId:this.FromData.channelId}).then(e=>{this.adivList=e,this.DataFrom=this.CrmFrom,"adivId"in this.DataFrom&&""!==this.DataFrom.adivId&&this.changeAid(this.DataFrom.adivId,1)})},changeAid(e,t){var a="",r="",i={};this.adivList.forEach(t=>{e===t.adivId&&(a=t.adivName,r=t.configId,i=t)}),this.DataFrom=Object.assign({},this.DataFrom,{adivId:e,adivName:a}),this.$emit("update:CrmFrom",this.DataFrom),this.$emit("getConfiguration",{configid:r,zt:t}),this.$emit("getadivObj",i)}}},m=s,c=a("2877"),u=Object(c["a"])(m,r,i,!1,null,"268ff5b3",null);t["a"]=u.exports},9101:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("div",{staticStyle:{display:"flex","justify-content":"end"}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择短信类型"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"标准化素材：",prop:"columnExt20"}},[t("div",{staticClass:"select-material",on:{click:function(t){return e.selectMaterial(!0)}}},[e._v(e._s(e.CrmFrom.materialName||"请选择"))])])],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"选择素材：",prop:"columnExt4"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:e.changeMater},model:{value:e.CrmFrom.columnExt4,callback:function(t){e.$set(e.CrmFrom,"columnExt4",t)},expression:"CrmFrom.columnExt4"}},e._l(e.MaterList,(function(e){return t("el-option",{key:e.materialId,attrs:{label:e.materialName,value:e.materialId}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[e.url?t("el-button",{staticStyle:{"margin-left":"50px"},attrs:{size:"mini"},on:{click:e.onPreview}},[e._v("预览")]):e._e(),t("el-image",{directives:[{name:"show",rawName:"v-show",value:e.previewflag,expression:"previewflag"}],ref:"preview",staticStyle:{width:"100px",height:"100px"},attrs:{src:e.url,"preview-src-list":e.srcList}})],1),e.showExt18?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1)],1):e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推荐用语：",prop:"EXEC_CONTENT","label-width":"148px"}},[t("el-input",{attrs:{id:"smsDetail",type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.EXEC_CONTENT,callback:function(t){e.$set(e.CrmFrom,"EXEC_CONTENT",t)},expression:"CrmFrom.EXEC_CONTENT"}}),t("div",{staticClass:"button"},[t("div",{staticClass:"sub-otton",on:{click:function(t){return e.openDilog(!0)}}},[e._v("营销用语模板")]),t("div",{staticClass:"sub-otton",on:{click:function(t){return e.openDilog(!1)}}},[e._v("自定义短信用语")])])],1)],1)],1)],1),t("ShortMessageList",{ref:"messageList",attrs:{tableData:e.tableData,cols:e.cols,channelId:e.id},on:{getSmsContentTemplateList:e.getSmsContentTemplateList,addShortMessage:e.addShortMessage}}),t("materialList",{ref:"material",attrs:{adivId:e.CrmFrom.adivInfo.adivId,channelId:e.id},on:{addMaterial:e.addMaterial}})],1)},i=[],l=(a("88a7"),a("271a"),a("5494"),a("0fea")),o=a("5e05"),n=(a("d212"),a("d39c")),s=(a("0b16"),a("c3eb")),m=a("f1ce"),c=a("5ed5"),u=(a("0557"),a("b893"));o["a"].common.getSysEnum;const d=o["a"].common.queryAdivInfo;o["a"].common.queryHallInfo;var h={props:["channelNewData","id","deleteSub"],components:{ShortMessageList:s["a"],materialList:m["a"],Tips:c["a"]},data(){return{CrmFrom:{adivInfo:{adivName:""},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",columnExt2:"",columnExt3:"",standard:"",CustomerRules:"",marketingWords:"",EXEC_CONTENT:"",showScene:!1,columnExt4:"",columnExt18:"0",columnExt20:""},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],columnExt4:[{required:!0,message:"请选择素材",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],EXEC_CONTENT:[{required:!0,message:"请输入短信推荐用语",trigger:"blur"}],num:[{required:!0,message:"请填写次数",trigger:"blur"}],CEP_EVENT_ID:[{required:!0,message:"请选择复杂事件场景",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],tableData:[],MaterList:[],cols:[{label:"模板编号",props:"id"},{label:"模板内容",props:"content"}],url:"",srcList:[],previewflag:!1,toolTopContent:"IOP免打扰时间段为21:00-8:00,在此期间将不会主动推送营销信息给客户。周期性客群如当天任务没有发送完成,将不会在第二天发送,第二天直接使用更新后客群发送。"}},watch:{channelNewData:{handler(){this.CrmFrom=Object(u["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0},CrmFrom:{handler(e,t){JSON.parse(JSON.stringify(e))},deep:!0},deleteSub(){}},computed:{EXEC_CONTENT(){return this.CrmFrom.EXEC_CONTENT}},mounted(){this.getOptionData(),this.getMater(),this.CrmFrom=Object(u["d"])(this.channelNewData),setTimeout(()=>{this.srcList=this.MaterList.filter(e=>{var t;return e.materialId===(null===(t=this.channelNewData.channelConf.channelExtConf)||void 0===t?void 0:t.columnExt4)}).map(e=>e.resourceUrl),this.url=this.srcList[0]},1e3),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(d,{channelId:this.id}).then(e=>{this.adivList=e})},async getMater(){await Object(l["i"])(o["a"].common.getMater,{channelId:this.id,positionId:this.CrmFrom.adivInfo.adivId}).then(e=>{this.MaterList=e})},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t}),"8012"===this.CrmFrom.adivInfo.adivId||"9012"===this.CrmFrom.adivInfo.adivId?this.CrmFrom.showScene=!0:this.CrmFrom.showScene=!1},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},openDilog(e){this.$refs["messageList"].showDialog(e)},async getSmsContentTemplateList(e){await Object(l["i"])(o["a"].common.getSmsContentTemplateList,e).then(e=>{e.width=570,this.tableData=e})},addShortMessage(e){this.CrmFrom={...this.CrmFrom,EXEC_CONTENT:e.row.content}},selectMaterial(e){this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}},async onPreview(){if(this.CrmFrom.columnExt4)try{const{data:e}=await Object(l["b"])(n["a"].seapi.downloadChanPromptFile,{fileUrlAndName:this.CrmFrom.columnExt2}),t=new Blob([e],{type:e.type});let a=URL.createObjectURL(t);this.srcList=[a],this.$refs.preview.clickHandler()}catch(e){}else this.$message.error("请先选择素材")},changeMater(e){this.srcList=this.MaterList.filter(t=>t.materialId===e).map(e=>e.resourceUrl);const t=this.MaterList.filter(t=>t.materialId===e);this.CrmFrom.columnExt3=t[0].materialName,this.CrmFrom.columnExt2=this.srcList[0],this.url=this.srcList[0]}},created(){}},p=h,C=(a("0ef1"),a("2877")),v=Object(C["a"])(p,r,i,!1,null,"277ec8d2",null);t["a"]=v.exports},9192:function(e,t,a){},9193:function(e,t,a){"use strict";a("53e3")},9547:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.channelNewData.channelId},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1)],1),t("el-col",{attrs:{span:24}},["8082"!=e.CrmFrom.adivInfo.adivId?t("el-form-item",{attrs:{label:"营销类型：",prop:"saleType"}},[t("el-select",{attrs:{disabled:"",placeholder:"请选择营销类型"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.saleType,callback:function(t){e.$set(e.CrmFrom,"saleType",t)},expression:"CrmFrom.saleType"}},e._l(e.saleList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e()],1),"8082"!=e.CrmFrom.adivInfo.adivId&&"1"==e.CrmFrom.saleType?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"复杂事件场景：",prop:"CEP_EVENT_ID"}},[t("div",[t("div",{staticStyle:{display:"flex","justify-content":"space-between","max-width":"375px"}},[t("div",{staticClass:"add-botton"},[t("span",{on:{click:function(t){return e.openSceneDilog(!0)}}},[e._v(e._s(e.CrmFrom.sceneParams.eventName||"添加"))]),t("i",{directives:[{name:"show",rawName:"v-show",value:e.CrmFrom.sceneParams.eventName,expression:"CrmFrom.sceneParams.eventName"}],staticClass:"el-icon-close",on:{click:e.removeEvent}})]),t("el-checkbox",{model:{value:e.CrmFrom.checked,callback:function(t){e.$set(e.CrmFrom,"checked",t)},expression:"CrmFrom.checked"}},[e._v("取消推荐规则设置")])],1),"JX0000000001"===e.customGroupId?t("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("该活动没有限定客群，触发事件即发送，请慎重选择事件！")]):e._e(),e.CrmFrom.checked?t("div",{staticClass:"select"},[t("div",{staticClass:"setRules"},[t("p",[e._v("已选择事件："+e._s(e.CrmFrom.sceneParams.eventName||""))])]),t("div",[t("span",[e._v("取消推荐时间：")]),t("el-select",{attrs:{placeholder:"请选择执行端口",size:"mini"},model:{value:e.CrmFrom.columnExt4,callback:function(t){e.$set(e.CrmFrom,"columnExt4",t)},expression:"CrmFrom.columnExt4"}},e._l(e.columnExt4List,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]):e._e()])])],1):e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"任务类型：",prop:"columnExt6"}},[t("el-select",{attrs:{placeholder:"请选择任务类型"},on:{change:e.changeAlarm},model:{value:e.CrmFrom.columnExt6,callback:function(t){e.$set(e.CrmFrom,"columnExt6",t)},expression:"CrmFrom.columnExt6"}},e._l(e.alarmType,(function(e){return t("el-option",{key:e.typeCode,attrs:{label:e.typeName,value:e.typeCode}})})),1)],1)],1),e.showExt18?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级模型")])],1):e._e()],1)],1):e._e(),e.CrmFrom.adivInfo.adivId?t("el-col",{attrs:{span:24}},[t("UseScript",{ref:"useScript",attrs:{"label-width":"145px","channel-id":e.channelNewData.channelId,"channel-name":e.channelNewData.channelName,"script-id":e.CrmFrom.columnExt19,CrmFrom:e.CrmFrom},on:{change:e.changeScript}}),t("el-form-item",{attrs:{label:"营销用语：",prop:"columnExt2"}},[e.isStrArr?t("Face2FaceWords",{attrs:{marketingWords:e.CrmFrom.columnExt2}}):t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}})],1)],1):e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"短信内容：",prop:"columnExt5"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt5,callback:function(t){e.$set(e.CrmFrom,"columnExt5",t)},expression:"CrmFrom.columnExt5"}})],1)],1)],1)],1),t("ComplexScene",{ref:"SceneDialog",on:{addScene:e.addScene}})],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("aedd"),s=a("f1ce"),m=a("5ed5"),c=a("98d2"),u=a("cd74"),d=a("b893"),h=a("00b8");o["a"].common.getSysEnum;const p=o["a"].common.queryAdivInfo,C=o["a"].common.getAlarmType;o["a"].common.queryHallInfo;var v={props:["channelNewData","id","deleteSub"],components:{ComplexScene:n["a"],materialList:s["a"],Tips:m["a"],UseScript:c["a"],Face2FaceWords:u["a"]},data(){return{CrmFrom:{adivInfo:{},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",standard:"",CustomerRules:"",marketingWords:"",columnExt2:"",columnExt3:"",columnExt4:"7",columnExt6:"",CEP_EVENT_ID:"",CEP_SCENE_NAME:"",sceneParams:{eventName:""},materialName:"",columnExt20:"",columnExt7:"",columnExt5:"",columnExt9:"1",columnExt18:"0",columnExt19:""},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],columnExt2:[{required:!0,message:"请输入营销用语",trigger:"blur"}],columnExt6:[{required:!0,message:"请选择任务类型",trigger:"change"}],columnExt9:[{required:!0,message:"请选择营销类型",trigger:"blur"}],CEP_EVENT_ID:[{required:!0,message:"请选择实时事件",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],alarmType:[],columnExt4List:[{label:"1天",value:"1"},{label:"2天",value:"2"},{label:"3天",value:"3"},{label:"4天",value:"4"},{label:"5天",value:"5"},{label:"6天",value:"6"},{label:"7天",value:"7"}],saleList:[{label:"实时营销",value:"1"},{label:"批量营销",value:"2"}],isStrArr:!1}},computed:{checked(){return this.CrmFrom.checked},customGroupId(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId}},watch:{channelNewData:{handler(){if(this.CrmFrom=Object(d["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt2",this.CrmFrom.columnExt2||""),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"columnExt9",this.CrmFrom.columnExt9||"1"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.checkColumnExt18=this.CrmFrom.columnExt18>0,this.CrmFrom.columnExt19&&this.CrmFrom.columnExt2)try{this.isStrArr=this.CrmFrom.columnExt2.includes("</header>")}catch(e){}},deep:!0},checked(e){this.CrmFrom=e?{...this.CrmFrom,columnExt3:"1"}:{...this.CrmFrom,columnExt3:"0"}}},created(){if(this.getOptionData(),this.CrmFrom=Object(d["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt2",this.CrmFrom.columnExt2||""),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"columnExt9",this.CrmFrom.columnExt9||"1"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.checkColumnExt18=this.CrmFrom.columnExt18>0,this.CrmFrom.columnExt19&&this.CrmFrom.columnExt2)try{this.isStrArr=this.CrmFrom.columnExt2.includes("</header>")}catch(e){}},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(p,{channelId:this.id}).then(e=>{this.adivList=e}),await Object(l["i"])(C+"?pcode=GWLX").then(e=>{this.alarmType=e})},changeAid(e){const t=this.adivList.find(t=>t.adivId===e);this.$set(this.CrmFrom,"adivInfo",{adivId:(null===t||void 0===t?void 0:t.adivId)||"",adivName:(null===t||void 0===t?void 0:t.adivName)||""}),this.removeEvent(),this.CrmFrom.checked=!1,this.CrmFrom.saleType="8082"==e?"":"1",this.isStrArr=!1,this.CrmFrom.columnExt19="",this.CrmFrom.columnExt2="",this.CrmFrom.columnExt5="",this.$refs.useScript&&this.$nextTick(()=>{this.$refs.useScript.getScriptList()})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},openSceneDilog(e){this.$refs["SceneDialog"].showDialog(e)},addScene(e){this.CrmFrom={...this.CrmFrom,CEP_EVENT_ID:e.eventId,CEP_SCENE_NAME:e.eventName,sceneParams:e}},removeEvent(){this.CrmFrom.sceneParams={eventName:""},this.CrmFrom.CEP_EVENT_ID="",this.CrmFrom.CEP_SCENE_NAME=""},selectMaterial(e){this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}},changeAlarm(e){this.CrmFrom.columnExt7=this.alarmType.filter(t=>t.typeCode===e)[0].typeName,this.$forceUpdate()},changeScript(e){if(this.CrmFrom.columnExt19=e.scriptId,!e.scriptId&&this.isStrArr)return this.$set(this.CrmFrom,"columnExt2",""),this.$set(this.CrmFrom,"columnExt5",""),void(this.isStrArr=!1);this.isStrArr=!1,e.contentType<5&&(this.isStrArr=!0),this.CrmFrom=Object(h["a"])(e,this.CrmFrom),this.$forceUpdate()}}},f=v,b=(a("afa6"),a("2877")),g=Object(b["a"])(f,r,i,!1,null,"10417d0a",null);t["a"]=g.exports},"95b7":function(e,t,a){"use strict";a("52f7")},"96d7":function(e,t,a){"use strict";a("226f")},9747:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"CrmFrom",attrs:{"label-width":"130px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{attrs:{label:"选择素材：",prop:"materialId"}},[t("el-select",{attrs:{placeholder:"请选择素材"},model:{value:e.CrmFrom.materialId,callback:function(t){e.$set(e.CrmFrom,"materialId",t)},expression:"CrmFrom.materialId"}},e._l(e.matList,(function(e){return t("el-option",{key:e.ID,attrs:{label:e.NAME,value:e.ID}})})),1),t("el-button",{staticClass:"ml-10",attrs:{type:"primary"},on:{click:e.showImage}},[e._v("预览")])],1),t("el-form-item",{attrs:{label:"推荐用语：",prop:"channelConf.execContent"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.channelConf.execContent,callback:function(t){e.$set(e.CrmFrom.channelConf,"execContent",t)},expression:"CrmFrom.channelConf.execContent"}})],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05");const n=o["a"].common.getSysEnum,s=o["a"].common.queryAdivInfo,m=o["a"].common.queryHallInfo;var c={props:["channelNewData"],data(){return{CrmFrom:{adivInfo:{},channelConf:{},channelId:"",channelName:"",attributionInfo:{},materialId:null},CrmFromRules:{materialId:[{required:!0,message:"请选择素材",trigger:"blur,change"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[]}},mounted(){this.getOptionData(),this.CrmFrom=JSON.parse(JSON.stringify(this.channelNewData))},methods:{async getOptionData(){await Object(l["i"])(n,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(s,{channelId:this.CrmFrom.channelId}).then(e=>{this.adivList=e}),await Object(l["i"])(m,{}).then(e=>{this.attributionList=e})},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},changeAttribution(e){var t="";this.attributionList.forEach(a=>{e===a.adivId&&(t=a.attributionName)}),this.CrmFrom.attributionInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,attributionName:t})},changeTime(){this.timeIdList.forEach(e=>{e.enumKey===this.CrmFrom.timeId&&(this.CrmFrom.timeName=e.enumValue)})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e}},created(){}},u=c,d=a("2877"),h=Object(d["a"])(u,r,i,!1,null,"0ab312bb",null);t["a"]=h.exports},"98d2":function(e,t,a){"use strict";var r=function(){var e,t=this,a=t._self._c;return a("el-form",{ref:"ruleForm",attrs:{"label-width":t.labelWidth,"label-position":t.labelPosition,model:t.form,rules:t.rules}},[a("el-form-item",{attrs:{label:"引用营销话术：",prop:"scriptId"}},[a("el-select",{attrs:{placeholder:"请选择营销话术",clearable:""},on:{change:t.changeScript},model:{value:t.form.scriptId,callback:function(e){t.$set(t.form,"scriptId",e)},expression:"form.scriptId"}},[a("el-option",{attrs:{value:"never",disabled:""}},[a("div",{staticClass:"search"},[a("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],attrs:{size:"mini",placeholder:"请输入关键字"},model:{value:t.keyword,callback:function(e){t.keyword="string"===typeof e?e.trim():e},expression:"keyword"}},[a("i",{staticClass:"el-input__icon el-icon-search cursor-pointer",attrs:{slot:"suffix"},on:{click:t.getScriptList},slot:"suffix"})])],1)]),[t.loading?a("el-option-group",[a("el-option",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-spinner":"el-icon-loading",value:""}})],1):a("el-option-group",t._l(t.scriptList,(function(e){return a("el-option",{key:e.scriptId,attrs:{value:e.scriptId,label:e.scriptName}},[a("div",{staticClass:"el-option__content"},[a("span",[t._v(t._s(e.scriptName))]),a("span",{staticClass:"recommend"},[a("span",{staticClass:"score"},[t._v(t._s(e.score))]),e.score>9?a("img",{attrs:{src:t.good}}):t._e()])])])})),1),t.loading||0!==t.scriptList.length?t._e():a("el-option",{attrs:{value:"empty",disabled:""}},[a("div",{staticClass:"empty"},[t._v(" 暂无数据 ")])])]],2),t.form.scriptId?a("span",{staticClass:"preview-btn",on:{click:function(e){t.viewVisible=!0}}},[t._v(" 预览 ")]):t._e(),a("span",{staticStyle:{float:"right"}},[t.form.scriptId&&t.form.contentType>4?a("el-button",{staticStyle:{"margin-right":"1px"},attrs:{type:"primary"},on:{click:function(e){t.compareVisible=!0}}},[t._v("话术比对")]):t._e(),a("el-button",{attrs:{type:"primary",loading:t.saveLoading},on:{click:function(e){return t.syncScript(!1)}}},[t._v("同步至话术库")])],1),t.showMarketingWords?a("div",{staticClass:"desc"},[t._v("面对面营销语暂不支持修改和同步")]):t._e()],1),a("CompareDialog",{attrs:{dialogVisible:t.compareVisible,"channel-data":t.CrmFrom,"script-data":t.form},on:{"update:dialogVisible":function(e){t.compareVisible=e},"update:dialog-visible":function(e){t.compareVisible=e}}}),a("ScriptViewDialog",{attrs:{dialogVisible:t.viewVisible,id:t.form.scriptId,enableEvaluate:""},on:{"update:dialogVisible":function(e){t.viewVisible=e},"update:dialog-visible":function(e){t.viewVisible=e}}}),a("BaseDialog",{attrs:{title:"内容类型",width:"400px","confirm-button-text":"确 定","confirm-loading":t.saveLoading},on:{confirm:t.saveContentType,close:function(e){t.contentTypeVisible=!1}},model:{value:t.contentTypeVisible,callback:function(e){t.contentTypeVisible=e},expression:"contentTypeVisible"}},[a("el-form",{ref:"contentForm",staticClass:"content-form",attrs:{model:t.form,rules:t.rules}},[a("el-form-item",{attrs:{label:"内容类型：",prop:"contentType"}},[a("el-select",{attrs:{placeholder:"请选择内容类型"},model:{value:t.form.contentType,callback:function(e){t.$set(t.form,"contentType",e)},expression:"form.contentType"}},t._l(t.channelContentType[(null===(e=t.CrmFrom.adivInfo)||void 0===e?void 0:e.adivId)||t.channelId+"1"],(function(e){return a("el-option",{key:e.contentType,attrs:{label:e.contentName,value:e.contentType,disabled:Number(e.contentType)<5}})})),1)],1)],1)],1)],1)},i=[],l=a("0fea"),o=a("cdbb"),n=a("ac7c"),s=a("5a4a"),m=a("00b8"),c=a("d4f7"),u=a.n(c),d=a("79a2"),h=a("2102"),p=function(){var e=this,t=e._self._c;return t("BaseDialog",{attrs:{title:"话术内容⽐对",visible:e.dialogVisible,width:"80%",top:"8vh","confirm-button-text":"关 闭","show-cancel-button":!1},on:{confirm:e.close,close:e.close}},[e.dialogVisible?t("div",{staticClass:"compare-text-container"},e._l(2,(function(a){return t("section",[t("header",[e._v(e._s(1===a?"引用":"配置")+"话术内容")]),t("main",e._l(e.scriptData.marketingWords,(function(r,i){var l,o;return t("div",{key:i},[t("div",{staticClass:"title"},[e._v(e._s(r.typeName))]),null!==(l=r.list)&&void 0!==l&&l.length||r.uploadType?null!==(o=r.list)&&void 0!==o&&o.length?[t("div",{staticClass:"content"})]:e._e():[t("div",{staticClass:"content"},[t("div",{staticClass:"content-text",domProps:{innerHTML:e._s(e.diffText(r.content,e.curScriptData.marketingWords[i].content)[a-1])}})])]],2)})),0)])})),0):e._e()])},C=[],v=a("ea45"),f={components:{BaseDialog:v["a"]},props:{dialogVisible:{type:Boolean,default:!1},channelData:{type:Object,default:()=>({})},scriptData:{type:Object,default:()=>({})}},watch:{dialogVisible(e){if(e){const e=JSON.parse(JSON.stringify(this.scriptData));this.curScriptData=Object(m["b"])(this.channelData,e)}}},data(){return{curScriptData:{}}},methods:{close(){this.$emit("update:dialogVisible",!1)},diffText(e,t){return Object(s["b"])(e,t)}}},b=f,g=(a("5985"),a("3074"),a("2877")),x=Object(g["a"])(b,p,C,!1,null,"fae4a1d2",null),E=x.exports,F=a("1bd8"),y={components:{MarketingWords:d["a"],MarketingWordsPreview:h["a"],CompareDialog:E,ScriptViewDialog:F["a"],BaseDialog:v["a"]},props:{CrmFrom:{type:Object,default:()=>({})},scriptId:{type:String||void 0,default:""},channelId:{type:String,default:""},channelName:{type:String,default:""},labelWidth:{type:String,default:"110px"},labelPosition:{type:String,default:"right"}},computed:{planObj(){const e=this.$store.state.MarkPl.SceneNodeData,t=this.$store.state.MarkPl.CurrentNode.id;let a="",r="";return e.forEach(e=>{e.forEach(i=>{i.id===t&&(a=e[0].NodeObj[0].planId,r=e[0].NodeObj[0].planName)})}),{planId:a,planName:r}},showMarketingWords(){const e=["1","2","3","4"],t=this.form.contentType+"";return e.includes(t)}},data(){return{good:u.a,CONTENT_TYPE:n["a"],loading:!1,keyword:"",scriptList:[],channelContentType:{},form:{scriptId:"",contentType:"",marketingWords:[{typeId:"3",typeName:"推荐语",content:""}]},rules:{contentType:[{required:!0,message:"请选择内容类型",trigger:"change"}]},viewVisible:!1,saveLoading:!1,compareVisible:!1,contentTypeVisible:!1}},methods:{async getChannelContentType(){try{let e=await Object(l["i"])(o["a"].queryChannelContentType,[this.channelId]);e=e.flat();for(let t of e){const e=t.adivId||this.channelId+"1";this.$set(this.channelContentType,e,[...this.channelContentType[e]||[],t])}}catch(e){}},notifyUpdate(e={scriptId:"",contentType:void 0}){e.scriptId||e.contentType||(this.form={scriptId:"",contentType:"",marketingWords:[{typeId:"3",typeName:"推荐语",content:""}]}),this.$emit("change",e)},async getScriptList(){try{var e;this.loading=!0;const t=await Object(l["i"])(o["a"].queryChannelIdAndPlan,{planId:this.planObj.planId,channelId:this.channelId,adivId:(null===(e=this.CrmFrom.adivInfo)||void 0===e?void 0:e.adivId)||this.channelId+"1",scriptKey:this.keyword});if(this.scriptList=[],this.scriptList=t.sort((e,t)=>e.score===t.score?new Date(t.updateTime||null).getTime()-new Date(e.updateTime||null).getTime():Number(t.score)-Number(e.score)),!this.scriptList.length)return;if(this.scriptId)return this.changeScript(this.scriptId)}catch(t){this.scriptList=[]}finally{this.loading=!1}},async changeScript(e){if(!e)return void this.notifyUpdate();const t=this.scriptList.find(t=>t.scriptId===e);t&&(this.form=Object(s["c"])(t),this.notifyUpdate(this.form))},changeContentType(e){const t=this.CONTENT_TYPE.find(t=>t.value===e);this.$set(this.form,"marketingWords",t.marketingWords)},async syncScript(e=!1){if(this.form.contentType&&Number(this.form.contentType)<5)return this.$message.error("该话术类型不支持同步");if(!e&&!this.CrmFrom.columnExt19||!this.form.contentType)return void(this.contentTypeVisible=!0);this.fillContentByChannel();const t=Object(s["e"])(this.form);if(t)try{let e;if(this.saveLoading=!0,this.form.scriptId){var a;e={...this.form,businessId:"",scriptId:"",parentId:this.form.parentId||this.form.scriptId,scriptType:"2",scriptTypeStr:"个性化话术",cityId:sessionStorage.getItem("cityId"),channelId:this.channelId,channelName:this.channelName,adivId:null===(a=this.CrmFrom.adivInfo)||void 0===a?void 0:a.adivId,planId:this.planObj.planId,planName:this.planObj.planName,marketingWords:this.form.marketingWords,scriptStatus:"0",score:null}}else{var r;const t={channelId:this.channelId,channelName:this.channelName,adivId:null===(r=this.CrmFrom.adivInfo)||void 0===r?void 0:r.adivId,planId:this.planObj.planId,planName:this.planObj.planName,scriptType:"1",scriptName:"【策略同步】"+this.planObj.planName+"-"+this.channelName,scriptType:"1",scriptTypeStr:"标准话术",contentType:this.form.contentType};e={...t,marketingWords:this.form.marketingWords}}e=Object(s["d"])(e);const t=await Object(l["i"])(o["a"].saveScript,e);t.length?(this.$message.success("同步成功"),this.form.scriptId="",this.notifyUpdate(this.form)):this.$message.error(res.message)}catch(i){}finally{this.saveLoading=!1}},saveContentType(){this.$refs.contentForm.validate(e=>{e&&(this.changeContentType(this.form.contentType),this.syncScript(!0),this.$nextTick(()=>{this.contentTypeVisible=!1}))})},fillContentByChannel(){this.form=Object(m["b"])(this.CrmFrom,this.form),this.$forceUpdate()}},created(){this.getScriptList(),this.getChannelContentType()}},I=y,k=(a("492d"),Object(g["a"])(I,r,i,!1,null,"6a029e06",null));t["a"]=k.exports},"9a5b":function(e,t,a){},"9c4a":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"150px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"短信类型：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择短信类型"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"标准化素材：",prop:"columnExt20"}},[t("div",{staticClass:"select-material",on:{click:function(t){return e.selectMaterial(!0)}}},[e._v(e._s(e.CrmFrom.materialName||"请选择"))])])],1),e.CrmFrom.showScene?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"复杂事件场景：",prop:"CEP_EVENT_ID"}},[t("div",[t("div",{staticStyle:{display:"flex","justify-content":"space-between","max-width":"375px"}},[t("div",{staticClass:"add-botton"},[t("span",{on:{click:function(t){return e.openSceneDilog(!0)}}},[e._v(e._s(e.CrmFrom.sceneParams.eventName||"添加"))]),t("i",{directives:[{name:"show",rawName:"v-show",value:e.CrmFrom.sceneParams.eventName,expression:"CrmFrom.sceneParams.eventName"}],staticClass:"el-icon-close",on:{click:e.removeEvent}})]),t("el-checkbox",{model:{value:e.CrmFrom.checked,callback:function(t){e.$set(e.CrmFrom,"checked",t)},expression:"CrmFrom.checked"}},[e._v("取消推荐规则设置")])],1),"JX0000000001"===e.customGroupId?t("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("该活动没有限定客群，触发事件即发送，请慎重选择事件！")]):e._e(),e.CrmFrom.checked?t("div",{staticClass:"select"},[t("div",{staticClass:"setRules"},[t("p",[e._v("已选择事件："+e._s(e.CrmFrom.sceneParams.eventName||""))])]),t("div",[t("span",[e._v("取消推荐时间：")]),t("el-select",{attrs:{placeholder:"请选择执行端口",size:"mini"},model:{value:e.CrmFrom.columnExt4,callback:function(t){e.$set(e.CrmFrom,"columnExt4",t)},expression:"CrmFrom.columnExt4"}},e._l(e.columnExt4List,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]):e._e()])])],1):e._e(),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"执行端口：",prop:"columnExt2"}},[t("el-select",{attrs:{placeholder:"请选择执行端口"},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}},e._l(e.SubChannelOptions,(function(e){return t("el-option",{key:e.channelId,attrs:{label:e.channelName,value:e.channelId}})})),1)],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"测试短信接收号码：",prop:"productNo"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"允许添加多个测试号码，请以英文状态下的逗号“,”分割"},model:{value:e.CrmFrom.productNo,callback:function(t){e.$set(e.CrmFrom,"productNo",t)},expression:"CrmFrom.productNo"}})],1)],1),e.showExt18?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1)],1):e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"短信推荐用语：",prop:"execContent"}},[t("el-input",{attrs:{id:"smsDetail",type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.execContent,callback:function(t){e.$set(e.CrmFrom,"execContent",t)},expression:"CrmFrom.execContent"}}),t("div",{staticClass:"button"},[t("div",{staticClass:"sub-otton",on:{click:function(t){return e.openDilog(!0)}}},[e._v("营销用语模板")]),t("div",{staticClass:"sub-otton",on:{click:function(t){return e.openDilog(!1)}}},[e._v("自定义短信用语")])])],1)],1),t("el-col",{attrs:{span:24}},[1==e.custgroupSource?t("el-form-item",{attrs:{label:"营销用语替换变量："}},[t("DNAReplaceVar",{on:{getVar:e.getContent}})],1):t("el-form-item",{attrs:{label:"营销用语替换变量："}},e._l(e.replaceVar,(function(a){return t("el-tag",{key:a.id,attrs:{type:"info"},on:{click:function(t){return e.getContent(a.attrCol)}}},[e._v(e._s(a.attrColName))])})),1)],1),1!=e.custgroupSource?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"发送周期：",prop:"UPDATE_CYCLE"}},[t("div",{staticStyle:{display:"flex",width:"100px"}},[t("el-tag",{attrs:{type:"1"===e.CrmFrom.UPDATE_CYCLE?"":"info"},on:{click:function(t){return e.getTags("1")}}},[e._v("一次性")]),1!==e.updateCycle?t("el-tag",{staticStyle:{"margin-left":"10px"},attrs:{type:"0"===e.CrmFrom.UPDATE_CYCLE?"":"info"},on:{click:function(t){return e.getTags("0")}}},[e._v("周期性")]):e._e()],1)])],1):e._e(),1!==e.updateCycle&&0==e.CrmFrom.UPDATE_CYCLE||1==e.custgroupSource?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"频次配置：",prop:e.CrmFrom.FREQUENCY?"num":"FREQUENCY"}},[t("div",{staticStyle:{display:"flex"}},[t("el-select",{attrs:{placeholder:"请选择天数"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.FREQUENCY,callback:function(t){e.$set(e.CrmFrom,"FREQUENCY",t)},expression:"CrmFrom.FREQUENCY"}},e._l(e.dateList,(function(e){return t("el-option",{key:e.cycleId,attrs:{label:e.cycleName,value:e.cycle}})})),1),t("el-input",{staticStyle:{width:"100px",margin:"0px 20px"},attrs:{type:"text",rows:8,placeholder:""},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.num,callback:function(t){e.$set(e.CrmFrom,"num",t)},expression:"CrmFrom.num"}}),e._v("次 ")],1)])],1):e._e()],1)],1),t("el-button",{staticStyle:{position:"relative",left:"500px"},attrs:{type:"primary",size:"mini",round:""},on:{click:e.sendShortText}},[e._v("测试短信")]),t("ShortMessageList",{ref:"messageList",attrs:{tableData:e.tableData,cols:e.cols,channelId:e.id},on:{getSmsContentTemplateList:e.getSmsContentTemplateList,addShortMessage:e.addShortMessage}}),t("ChainedDialog",{ref:"chainedDialog"}),t("ComplexScene",{ref:"SceneDialog",on:{addScene:e.addScene}}),t("materialList",{ref:"material",attrs:{channelId:e.id,adivId:e.CrmFrom.adivInfo.adivId},on:{addMaterial:e.addMaterial}})],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("c3eb"),s=a("006c"),m=a("aedd"),c=a("f1ce"),u=a("5ed5"),d=a("6501"),h=a("b893");const p=o["a"].common.getSysEnum,C=o["a"].common.queryAdivInfo,v=o["a"].common.queryHallInfo;var f={props:["channelNewData","id","deleteSub"],components:{ShortMessageList:n["a"],ChainedDialog:s["a"],ComplexScene:m["a"],materialList:c["a"],Tips:u["a"],DNAReplaceVar:d["a"]},data(){return{CrmFrom:{adivInfo:{adivName:""},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",columnExt3:"0",standard:"",CustomerRules:"",marketingWords:"",execContent:"",columnExt2:"",IF_HAVE_VAR:"0",FREQUENCY:"",UPDATE_CYCLE:"1",CEP_EVENT_ID:"",CEP_SCENE_NAME:"",num:"",textShortMessage:"",productNo:"",columnExt4:"7",showScene:!1,sceneParams:{eventName:""},checked:Boolean,columnExt18:"0",columnExt20:""},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],execContent:[{required:!0,message:"请输入短信推荐用语",trigger:"blur"}],UPDATE_CYCLE:[{required:!0,message:"请选择发送周期",trigger:"blur"}],FREQUENCY:[{required:!0,message:"请选择频次配置",trigger:"blur"}],num:[{required:!0,message:"请填写次数",trigger:"blur"}],CEP_EVENT_ID:[{required:!0,message:"请选择复杂事件场景",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择短信类型",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],tableData:[],cols:[{label:"模板编号",props:"id"},{label:"模板内容",props:"content"}],SubChannelOptions:[],replaceVar:[],ShortMsgContent:"",tagList:[{label:"一次性",id:0},{label:"周期性",id:1}],tagIndex:1,dateList:[],columnExt4List:[{label:"1天",value:"1"},{label:"2天",value:"2"},{label:"3天",value:"3"},{label:"4天",value:"4"},{label:"5天",value:"5"},{label:"6天",value:"6"},{label:"7天",value:"7"}]}},watch:{channelNewData:{handler(){this.CrmFrom=Object(h["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt3","0"),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"UPDATE_CYCLE","1"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0},CrmFrom:{handler(e,t){JSON.parse(JSON.stringify(e))},deep:!0},deleteSub(){},checked(e){this.CrmFrom=e?{...this.CrmFrom,columnExt3:"1"}:{...this.CrmFrom,columnExt3:"0"}},execContent(e){if(e){const t=/\$[a-zA-Z0-9_\u4e00-\u9fa5]+\$/g,a=e.match(t);a&&a.length>0?this.CrmFrom.IF_HAVE_VAR="1":this.CrmFrom.IF_HAVE_VAR="0"}else this.CrmFrom.IF_HAVE_VAR="0"},showSceneFlag(e){this.CrmFrom="8012"===e||"9012"===e?{...this.CrmFrom,showScene:!0}:{...this.CrmFrom,showScene:!1,CEP_EVENT_ID:"",CEP_SCENE_NAME:"",sceneParams:{eventName:""},checked:""}}},computed:{execContent(){return this.CrmFrom.execContent},updateCycle(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.updateCycle},customGroupId(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId},custgroupSource(){return this.$store.state.extendData.custgroupSource},checked(){return this.CrmFrom.checked},showSceneFlag(){return this.CrmFrom.adivInfo.adivId}},mounted(){this.getOptionData(),this.getlistSubChannel(),this.listCustAttr(),this.getDateList(),this.CrmFrom=Object(h["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt3","0"),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"UPDATE_CYCLE","1"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(p,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(C,{channelId:this.id}).then(e=>{this.adivList=e}),await Object(l["i"])(v,{}).then(e=>{this.attributionList=e})},changeAid(e){this.removeEvent(),this.CrmFrom.checked=!1;var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t}),this.CrmFrom.sceneParams={...this.CrmFrom.sceneParams},"8012"===this.CrmFrom.adivInfo.adivId||"9012"===this.CrmFrom.adivInfo.adivId?this.CrmFrom.showScene=!0:this.CrmFrom.showScene=!1},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?("801"!==this.id||this.CrmFrom.execContent.endsWith(" 如需退订此消息，请回复TD【中国移动】")||(this.CrmFrom.execContent+=" 如需退订此消息，请回复TD【中国移动】"),this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},openDilog(e){this.$refs["messageList"].showDialog(e)},addShortMessage(e){this.CrmFrom={...this.CrmFrom,execContent:e.row.content}},async getSmsContentTemplateList(e){await Object(l["i"])(o["a"].common.getSmsContentTemplateList,e).then(e=>{e.width=570,this.tableData=e})},openChainedDilog(e){this.$refs["chainedDialog"].showDialog(e)},openSceneDilog(e){this.$refs["SceneDialog"].showDialog(e)},addScene(e){this.CrmFrom={...this.CrmFrom,CEP_EVENT_ID:e.eventId,CEP_SCENE_NAME:e.eventName,sceneParams:e}},removeEvent(){this.CrmFrom.sceneParams={eventName:""},this.CrmFrom.CEP_EVENT_ID="",this.CrmFrom.CEP_SCENE_NAME=""},async getlistSubChannel(){await Object(l["i"])(o["a"].common.getlistSubChannel+"?parentId="+this.id).then(e=>{this.SubChannelOptions=e||[]})},async listCustAttr(){var e;const t=null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId;await Object(l["i"])(o["a"].common.listCustAttr+"?custGroupId="+t).then(e=>{this.replaceVar=e})},getContent(e){let t="$"+e+"$";e=t,this.ShortMsgContent=e;const a=document.querySelector("#smsDetail");if(a.selectionStart||0===a.selectionStart){var r=a.selectionStart,i=a.selectionEnd;this.CrmFrom={...this.CrmFrom,execContent:a.value.substring(0,r)+e+a.value.substring(i,a.value.length)},this.$nextTick(),a.focus(),a.setSelectionRange(i+e.length,i+e.length)}else this.CrmFrom.execContent+=e},getTags(e){this.CrmFrom={...this.CrmFrom,UPDATE_CYCLE:e},0==e&&(this.CrmFrom.FREQUENCY=null,this.CrmFrom.num=""),this.$forceUpdate()},async getDateList(){await Object(l["i"])(o["a"].common.getDateList).then(e=>{this.dateList=e})},async sendShortText(){const e={content:this.CrmFrom.execContent,productNo:this.CrmFrom.productNo,spCode:this.CrmFrom.columnExt2};let t=!0;for(let a in e)e[a]||(t=!1);t?await Object(l["i"])(o["a"].common.sendShortText,e).then(e=>{this.$message.success(e.message)}):this.$message.error("请选择或填写，测试短信接受号码、执行端口、短信内容")},selectMaterial(e){this.$refs["material"].getMaterialList(),this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}}},created(){}},b=f,g=(a("b4c7"),a("2877")),x=Object(g["a"])(b,r,i,!1,null,"38db317d",null);t["a"]=x.exports},"9d33":function(e,t,a){},"9dc5":function(e,t,a){"use strict";var r=function(){var e,t,a,r,i,l,o=this,n=o._self._c;return n("div",{staticStyle:{width:"100%"}},[n("Tips",{attrs:{id:o.id},on:{getChannelDetail:o.getChannelDetail}}),n("div",{staticStyle:{display:"flex","justify-content":"end"}}),n("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:o.CrmFrom,rules:o.CrmFromRules}},[n("el-row",[n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[n("el-radio-group",{model:{value:o.CrmFrom.columnExt1,callback:function(e){o.$set(o.CrmFrom,"columnExt1",e)},expression:"CrmFrom.columnExt1"}},[n("el-radio",{attrs:{label:"1",disabled:!o.CrmFrom.channelFlag}},[o._v("全量推送")]),n("el-radio",{attrs:{label:"0",disabled:!o.CrmFrom.channelFlag}},[o._v("偏好推送")])],1)],1)],1),n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[n("el-select",{attrs:{placeholder:"请选择短信类型"},on:{change:o.changeAid},model:{value:o.CrmFrom.adivInfo.adivId,callback:function(e){o.$set(o.CrmFrom.adivInfo,"adivId",e)},expression:"CrmFrom.adivInfo.adivId"}},o._l(o.adivList,(function(e){return n("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1)],1),o.xhlist.includes(o.CrmFrom.adivInfo.adivId)?[n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"素材：",prop:"columnExt16.columnExt4"}},[n("div",{staticClass:"sucai"},[n("div",{staticClass:"select-material",on:{click:function(e){o.dialogVisible=!0}}},[o.CrmFrom.columnExt16.columnExt5?n("div",{staticClass:"m-name"},[o._v(o._s(o.CrmFrom.columnExt16.columnExt5))]):n("span",[o._v("选择素材")])]),null!==(e=o.CrmFrom.columnExt16)&&void 0!==e&&e.columnExt4?n("el-popover",{attrs:{placement:"left",width:"220",trigger:"click"}},[n("div",[n("div",[o._v("素材描述："+o._s(o.CrmFrom.columnExt16.columnExt9||"--"))]),n("el-image",{staticStyle:{width:"200px",height:"200px"},attrs:{src:o.CrmFrom.columnExt16.columnExt6,"preview-src-list":[o.CrmFrom.columnExt16.columnExt6]}})],1),n("el-button",{attrs:{slot:"reference",type:""},slot:"reference"},[o._v("预览")])],1):o._e()],1)])],1),"9330101"==o.CrmFrom.adivInfo.adivId?[n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"复杂事件场景：",prop:"CEP_EVENT_ID"}},[n("div",[n("div",{staticStyle:{display:"flex","justify-content":"space-between","max-width":"375px"}},[n("div",{staticClass:"add-botton"},[n("span",{on:{click:function(e){return o.openSceneDilog(!0)}}},[o._v(o._s(o.CrmFrom.sceneParams.eventName||"添加"))]),n("i",{directives:[{name:"show",rawName:"v-show",value:o.CrmFrom.sceneParams.eventName,expression:"CrmFrom.sceneParams.eventName"}],staticClass:"el-icon-close",on:{click:o.removeEvent}})]),n("el-checkbox",{on:{change:o.changeCheck},model:{value:o.CrmFrom.checked,callback:function(e){o.$set(o.CrmFrom,"checked",e)},expression:"CrmFrom.checked"}},[o._v("取消推荐规则设置")])],1),"JX0000000001"===o.customGroupId?n("div",{staticStyle:{color:"red","font-size":"12px"}},[o._v("该活动没有限定客群，触发事件即发送，请慎重选择事件！")]):o._e(),o.CrmFrom.checked?n("div",{staticClass:"select"},[n("div",{staticClass:"setRules"},[n("p",[o._v("已选择事件："+o._s(o.CrmFrom.sceneParams.eventName))])]),n("div",[n("span",[o._v("取消推荐时间：")]),n("el-select",{attrs:{placeholder:"请选择取消时间",size:"mini"},model:{value:o.CrmFrom.columnExt16.columnExt3,callback:function(e){o.$set(o.CrmFrom.columnExt16,"columnExt3",e)},expression:"CrmFrom.columnExt16.columnExt3"}},o._l(o.columnExt3List,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]):o._e()])])],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"活动停止方式：",prop:"columnExt16.columnExt11"}},[n("el-select",{model:{value:o.CrmFrom.columnExt16.columnExt11,callback:function(e){o.$set(o.CrmFrom.columnExt16,"columnExt11",e)},expression:"CrmFrom.columnExt16.columnExt11"}},[n("el-option",{attrs:{label:"活动结束时间",value:0}}),n("el-option",{attrs:{label:"超过时间停止发送",value:1}})],1)],1)],1),1==o.CrmFrom.columnExt16.columnExt11?n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"延后时间：",prop:"columnExt16.columnExt12"}},[n("el-input",{staticStyle:{width:"130px"},attrs:{placeholder:"请输入延后时间"},on:{input:o.toNum},model:{value:o.CrmFrom.columnExt16.columnExt12,callback:function(e){o.$set(o.CrmFrom.columnExt16,"columnExt12",e)},expression:"CrmFrom.columnExt16.columnExt12"}}),o._v(" 分钟 ")],1)],1):o._e()]:o._e(),o.showExt18?n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"智能话术："}},[n("el-checkbox",{on:{change:()=>o.CrmFrom.columnExt18=o.checkColumnExt18?"1":"0"},model:{value:o.checkColumnExt18,callback:function(e){o.checkColumnExt18=e},expression:"checkColumnExt18"}},[o._v("启用")]),o.checkColumnExt18?n("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(e){return o.$forceUpdate()}},model:{value:o.CrmFrom.columnExt18,callback:function(e){o.$set(o.CrmFrom,"columnExt18",e)},expression:"CrmFrom.columnExt18"}},[n("el-radio",{attrs:{label:"1"}},[o._v("省端模型")]),n("el-radio",{attrs:{label:"2"}},[o._v("一级IOP模型")])],1):o._e()],1)],1):o._e(),n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"营销话术：",prop:"columnExt16.columnExt1"}},[n("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:6,placeholder:"您还可以输入300个字"},model:{value:o.CrmFrom.columnExt16.columnExt1,callback:function(e){o.$set(o.CrmFrom.columnExt16,"columnExt1",e)},expression:"CrmFrom.columnExt16.columnExt1"}})],1)],1)]:[n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"物料：",prop:"columnExt4"}},[n("el-select",{attrs:{placeholder:"请选择物料",filterable:""},on:{change:o.changeMater},model:{value:o.CrmFrom.columnExt4,callback:function(e){o.$set(o.CrmFrom,"columnExt4",e)},expression:"CrmFrom.columnExt4"}},o._l(o.material,(function(e){return n("el-option",{key:e.matId,attrs:{label:e.matName,value:e.matId,disabled:e.disabled}})})),1),o.validText?n("span",{staticStyle:{"padding-left":"10px"}},["正在校验"==o.validText?n("i",{staticClass:"el-icon-loading",staticStyle:{color:"#2f87ec"}}):o._e(),n("span",{style:{color:"校验异常"==o.validText?"red":"#4093ff"}},[o._v(o._s(o.validText))])]):o._e()],1)],1),n("el-col",{directives:[{name:"show",rawName:"v-show",value:o.CrmFrom.columnExt4&&o.previewflag,expression:"CrmFrom.columnExt4 && previewflag"}],attrs:{span:24}},[n("el-form-item",{attrs:{label:"预览："}},[n("el-image",{ref:"preview",staticStyle:{width:"100px",height:"100px"},attrs:{src:o.url,"preview-src-list":o.srcList}})],1)],1),n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"产品价格：",prop:"columnExt3"}},[n("el-input",{attrs:{placeholder:"请输入产品价格"},model:{value:o.CrmFrom.columnExt3,callback:function(e){o.$set(o.CrmFrom,"columnExt3",e)},expression:"CrmFrom.columnExt3"}})],1)],1),n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"URL链接：",prop:"columnExt6"}},[n("el-input",{attrs:{placeholder:"请输入URL链接"},model:{value:o.CrmFrom.columnExt6,callback:function(e){o.$set(o.CrmFrom,"columnExt6",e)},expression:"CrmFrom.columnExt6"}})],1)],1)]],2)],1),n("WXMaterialList",{attrs:{"dialog-visible":o.dialogVisible,"current-mat":{id:null===(t=o.CrmFrom.columnExt16)||void 0===t?void 0:t.columnExt4,title:null===(a=o.CrmFrom.columnExt16)||void 0===a?void 0:a.columnExt5,content:null===(r=o.CrmFrom.columnExt16)||void 0===r?void 0:r.columnExt9,picUrl:null===(i=o.CrmFrom.columnExt16)||void 0===i?void 0:i.columnExt6},"current-type-id":null===(l=o.CrmFrom.columnExt16)||void 0===l?void 0:l.columnExt7},on:{"update:dialogVisible":function(e){o.dialogVisible=e},"update:dialog-visible":function(e){o.dialogVisible=e},change:o.selectMat}}),n("ComplexScene",{ref:"SceneDialog",on:{addScene:o.addScene}})],1)},i=[],l=(a("88a7"),a("271a"),a("5494"),function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"选择素材","append-to-body":"",width:"80%",top:"10vh",visible:e.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("main",[t("div",{staticClass:"top"},[t("div",{staticClass:"search"},[t("span",[t("label",[e._v("素材名称：")]),t("el-input",{attrs:{clearable:"",placeholder:"请输入素材名称"},model:{value:e.keyWords,callback:function(t){e.keyWords=t},expression:"keyWords"}})],1),t("span",[t("label",[e._v("素材类型：")]),t("el-select",{on:{change:e.changeType},model:{value:e.query.categoryId,callback:function(t){e.$set(e.query,"categoryId",t)},expression:"query.categoryId"}},e._l(e.materialTypeList,(function(e){return t("el-option",{key:e.categoryId,attrs:{label:e.name,value:e.categoryId}})})),1)],1),t("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("搜索")])],1),t("div",{staticClass:"left"},[t("LabelScreen",{attrs:{title:"已选素材",Default:{id:"id",value:"title"},Label:e.selectList},on:{close:function(t){e.selectList=[]}}})],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","max-height":"350"}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),t("el-table-column",{attrs:{label:"素材类型",align:"center",width:"100","show-overflow-tooltip":""}},[[e._v(" "+e._s(e.currentType.name)+" ")]],2),t("el-table-column",{attrs:{label:"素材ID",prop:"id","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"素材名称",prop:"title","min-width":"200","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"素材内容",align:"center",width:"70"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-popover",{attrs:{placement:"top",width:"220",trigger:"click"}},[t("div",[t("div",[e._v("素材描述："+e._s(a.content||"--"))]),t("el-image",{attrs:{src:a.picUrl,"preview-src-list":[a.picUrl]}})],1),t("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("查看")])],1)]}}])}),t("el-table-column",{attrs:{label:"素材价格",prop:"price",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"推荐标识",prop:"referenceStatusName",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"开始时间",prop:"beginTime",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"结束时间",prop:"endTime",align:"center","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"操作",width:"70",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.add(a.row)}}},[e._v("添加")])]}}])})],1),t("el-pagination",{attrs:{size:"small","current-page":e.query.current,"page-sizes":[10,20,30,40],"page-size":e.query.size,"pager-count":5,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)])}),o=[],n=a("7b5a"),s=a("0fea"),m=a("5e05"),c={name:"WXMaterialList",components:{LabelScreen:n["a"]},props:{dialogVisible:{type:Boolean,default:!1},currentTypeId:{type:Number|String,default:""},currentMat:{type:Object,default:()=>{}}},data(){return{loading:!1,tableData:[],keyWords:"",query:{search:"",materialType:"",categoryId:"",current:1,size:10},total:0,materialTypeList:[],currentType:"",selectList:[]}},methods:{async getMaterialType(){try{var e;const t=await Object(s["i"])(m["a"].common.queryMaterialType);let a=(null===(e=JSON.parse(t))||void 0===e?void 0:e.data)||[];this.materialTypeList=a.filter(e=>2!=e.materialType),this.materialTypeList.length>0&&(this.currentType=this.materialTypeList[0],this.query.materialType=this.currentType.materialType,this.query.categoryId=this.currentType.categoryId,this.currentTypeId&&(this.currentType=this.materialTypeList.find(e=>e.categoryId===this.currentTypeId),this.query.materialType=this.currentType.materialType,this.query.categoryId=this.currentType.categoryId))}catch(t){}},changeType(e){this.currentType=this.materialTypeList.find(t=>t.categoryId===e)||{},this.query.materialType=this.currentType.materialType},async getList(){try{this.loading=!0;const{records:e,total:t}=await Object(s["i"])(m["a"].common.queryMaterialInfos,this.query);this.tableData=e,this.total=t}catch(e){}finally{this.loading=!1}},handleSizeChange(e){this.query.current=1,this.query.size=e,this.getList()},handleCurrentChange(e){this.query.current=e,this.getList()},search(){this.query.current=1,this.query.search=this.keyWords,this.getList()},add(e){this.selectList=[e]},cancel(){this.selectList=[],this.$emit("update:dialogVisible",!1)},confirm(){this.$emit("change",this.selectList,this.currentType),this.$emit("update:dialogVisible",!1)}},watch:{dialogVisible(e){e&&0===this.tableData.length&&this.getList(),e&&this.currentMat.id&&0===this.selectList.length&&this.$nextTick(()=>{this.$set(this.selectList,0,this.currentMat)})}},created(){this.getMaterialType()}},u=c,d=(a("12ed"),a("2877")),h=Object(d["a"])(u,l,o,!1,null,"0d6156c8",null),p=h.exports,C=a("aedd"),v=a("856c"),f=a.n(v),b=a("5ed5"),g=a("b893");const x=m["a"].common.queryAdivInfo;var E={props:["channelNewData","id","deleteSub"],components:{Tips:b["a"],WXMaterialList:p,ComplexScene:C["a"]},computed:{customGroupId(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId}},data(){return{xhlist:[9330101,"9330101",9330102,"9330102"],xhsslist:[9330101,"9330101"],CrmFrom:{adivInfo:{adivName:""},channelId:"",channelName:"",sucai:{matId:"",matName:""},CEP_EVENT_ID:"",CEP_SCENE_NAME:"",sceneParams:{eventName:"",eventId:""},checked:!1,columnExt1:"1",columnExt3:"",columnExt4:"",standard:"",CustomerRules:"",marketingWords:"",columnExt2:"",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt9:"",columnExt10:"",columnExt11:{},columnExt12:{},columnExt13:{},columnExt14:{},columnExt16:{columnExt1:"",columnExt2:"",columnExt3:"",columnExt4:"",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt9:"",columnExt10:"",columnExt11:0,columnExt12:""},columnExt18:"0"},showExt18:!1,checkColumnExt18:!1,material:[],columnExt3List:[{label:"1天",value:"1"},{label:"2天",value:"2"},{label:"3天",value:"3"},{label:"4天",value:"4"},{label:"5天",value:"5"},{label:"6天",value:"6"},{label:"7天",value:"7"}],CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],columnExt4:[{required:!0,message:"请选择物料",trigger:"blur"}],columnExt3:[{required:!0,message:"请填写产品价格",trigger:"blur"}],columnExt6:[{required:!0,message:"请填写URL连接",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},columnExt16:{columnExt1:[{required:!0,message:"请输入营销用语",trigger:"blur"}],columnExt4:[{required:!0,message:"请选择素材",trigger:"blur"}],columnExt11:[{required:!0,message:"请选择活动停止方式",trigger:"blur"}],columnExt12:[{required:!0,message:"请输入延后时间",trigger:"blur"}]},CEP_EVENT_ID:[{required:!0,message:"请选择实时事件",trigger:"blur"}]},adivList:[],url:"",srcList:[],previewflag:!1,validText:"",dialogVisible:!1}},watch:{channelNewData:{handler(){this.CrmFrom=Object(g["d"])(this.channelNewData),this.url=this.CrmFrom.columnExt10,this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.CrmFrom.columnExt16&&"string"==typeof this.CrmFrom.columnExt16&&(this.CrmFrom.columnExt16=JSON.parse(this.CrmFrom.columnExt16)),this.$set(this.CrmFrom,"columnExt16",this.CrmFrom.columnExt16||{columnExt1:"",columnExt2:"",columnExt3:"",columnExt4:"",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt9:"",columnExt10:"",columnExt11:0,columnExt12:""}),this.$set(this.CrmFrom,"checked",1==this.CrmFrom.columnExt16.columnExt2),this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0}},created(){var e;this.getOptionData(),this.getAllDataView();let t={...this.CrmFrom,...this.channelNewData};this.CrmFrom=Object(g["d"])(t),this.url=this.CrmFrom.columnExt10,this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.CrmFrom.columnExt16&&"string"==typeof this.CrmFrom.columnExt16&&(this.CrmFrom.columnExt16=JSON.parse(this.CrmFrom.columnExt16)),this.$set(this.CrmFrom,"columnExt16",this.CrmFrom.columnExt16||{columnExt1:"",columnExt2:"",columnExt3:"",columnExt4:"",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt9:"",columnExt10:"",columnExt11:0,columnExt12:""}),this.$set(this.CrmFrom,"checked",1==(null===(e=this.CrmFrom.columnExt16)||void 0===e?void 0:e.columnExt2)),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(s["i"])(x,{channelId:this.id}).then(e=>{this.adivList=e})},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t}),this.removeEvent(),this.CrmFrom.checked=!1,this.xhlist.includes(e)?(this.CrmFrom.columnExt2="",this.CrmFrom.columnExt3="",this.CrmFrom.columnExt4="",this.CrmFrom.columnExt5="",this.CrmFrom.columnExt6="",this.CrmFrom.columnExt7="",this.CrmFrom.columnExt8="",this.CrmFrom.columnExt9="",this.CrmFrom.columnExt10="",this.CrmFrom.columnExt11="",this.CrmFrom.columnExt12="",this.CrmFrom.columnExt13="",this.CrmFrom.columnExt14="",this.CrmFrom.columnExt15="",this.CrmFrom.columnExt16.columnExt2="",this.CrmFrom.columnExt16.columnExt3="",this.CrmFrom.columnExt16.columnExt11=this.xhsslist.includes(e)?0:""):this.CrmFrom.columnExt16={columnExt1:"",columnExt2:"",columnExt3:"",columnExt4:"",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt9:"",columnExt10:"",columnExt11:0,columnExt12:""}},changeCheck(e){this.$set(this.CrmFrom.columnExt16,"columnExt2",e?"1":"0")},toNum(e){let t=e.replace(/^(0+)|[^\d]+/g,"");this.CrmFrom.columnExt16.columnExt12=parseInt(t)||""},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{if(t){const t=JSON.parse(JSON.stringify(this.CrmFrom));"object"==typeof t.columnExt16&&(t.columnExt16=JSON.stringify(t.columnExt16)),this.$emit("saveChannelData",t),e=!0}else e=!1}),e},async getAllDataView(){await Object(s["i"])(m["a"].common.getAllDataView,{keyWords:"",pageNum:1}).then(e=>{this.material=e.recordList})},async changeMater(e){const t=this.material.filter(t=>t.matId===e)[0];this.validText="正在校验";let a="";this.previewflag=!0,this.url=f.a;try{const{matUrl:e}=await Object(s["i"])(m["a"].common.downLoadMatUrl,{matUrl:t.matUrl});a="物料图片名称已获取",Object(s["b"])(m["a"].common.loadImage,{picName:e}).then(({data:e})=>{const t=new Blob([e],{type:e.type});this.url=URL.createObjectURL(t),this.srcList=[this.url]}).catch(e=>{this.url=""});const r=await Object(s["i"])(m["a"].common.validChannelAdvidIdAvailable,{channelId:this.CrmFrom.channelId,channelAdivdId:t.matId,matUrl:e});1==r?(a="物料可以正常使用",this.validText=""):a="当前物料已被使用"}catch(r){this.validText="校验异常",""==a?this.url="":"物料图片名称已获取"==a&&(a="校验异常")}if("当前物料已被使用"==a)return this.validText="",this.$alert("当前物料已被使用，请重新选择","提示",{confirmButtonText:"确定",customClass:"errorPrompt",callback:e=>{let a=this.material.find(e=>e.matId==t.matId);this.$set(a,"disabled",!0),this.CrmFrom={...this.CrmFrom,columnExt4:"",columnExt5:"",columnExt2:"",columnExt7:"",columnExt8:"",columnExt9:"",columnExt10:"",columnExt11:"",columnExt12:"",columnExt13:"",columnExt14:""},this.url="",this.srcList=[],this.previewflag=!1}});this.CrmFrom={...this.CrmFrom,columnExt5:t.matName,columnExt2:+t.ifJb>=0?t.ifJb:"1",columnExt7:t.jbType,columnExt8:t.jbShow,columnExt9:t.jbText,columnExt10:t.jbPicSrc,columnExt11:JSON.stringify(t.searchInfo),columnExt12:JSON.stringify(t.ugInfo),columnExt13:JSON.stringify(t.cardInfo),columnExt14:JSON.stringify(t.generalInfo)}},openSceneDilog(e){this.$refs["SceneDialog"].showDialog(e)},addScene(e){this.CrmFrom={...this.CrmFrom,CEP_EVENT_ID:e.eventId,CEP_SCENE_NAME:e.eventName,sceneParams:e}},removeEvent(){this.CrmFrom.sceneParams={eventName:"",eventId:""},this.CrmFrom.CEP_EVENT_ID="",this.CrmFrom.CEP_SCENE_NAME=""},selectMat(e,t){if(e.length){let a=e[0];const{id:r,title:i,content:l,picUrl:o}=a;this.CrmFrom.columnExt16={...this.CrmFrom.columnExt16,columnExt4:r,columnExt5:i,columnExt6:o,columnExt7:t.categoryId,columnExt8:t.materialType,columnExt9:l,columnExt10:t.name}}else this.CrmFrom.columnExt16={...this.CrmFrom.columnExt16,columnExt4:"",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt9:"",columnExt10:"",columnExt11:0,columnExt12:""}}}},F=E,y=(a("7248"),Object(d["a"])(F,r,i,!1,null,"c3cdc640",null));t["a"]=y.exports},"9de8":function(e,t,a){"use strict";a("a66e")},a365:function(e,t,a){},a3cc:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"CrmFrom",attrs:{"label-width":"150px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{attrs:{label:"产品图片URL：",prop:"channelConf.materialDisplayUrl"}},[t("el-input",{model:{value:e.CrmFrom.channelConf.materialDisplayUrl,callback:function(t){e.$set(e.CrmFrom.channelConf,"materialDisplayUrl",t)},expression:"CrmFrom.channelConf.materialDisplayUrl"}})],1),t("el-form-item",{attrs:{label:"互联网产品跳转URL："}},[t("el-input",{model:{value:e.CrmFrom.channelConf.materialClickUrl,callback:function(t){e.$set(e.CrmFrom.channelConf,"materialClickUrl",t)},expression:"CrmFrom.channelConf.materialClickUrl"}})],1),t("el-form-item",{attrs:{label:"推荐用语：",prop:"channelConf.execContent"}},[t("el-input",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.CrmFrom.channelConf.execContent,callback:function(t){e.$set(e.CrmFrom.channelConf,"execContent",t)},expression:"CrmFrom.channelConf.execContent"}})],1),t("el-form-item",{attrs:{label:"时机选择："}},[t("el-select",{attrs:{placeholder:"请选择"},on:{click:e.changeTime},model:{value:e.CrmFrom.channelConf.timeId,callback:function(t){e.$set(e.CrmFrom.channelConf,"timeId",t)},expression:"CrmFrom.channelConf.timeId"}},e._l(e.timeIdList,(function(e){return t("el-option",{key:e.enumKey,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("el-form-item",{attrs:{label:"时机描述："}},[t("el-input",{attrs:{type:"textarea",maxlength:"240","show-word-limit":""},model:{value:e.CrmFrom.channelConf.timeDistindes,callback:function(t){e.$set(e.CrmFrom.channelConf,"timeDistindes",t)},expression:"CrmFrom.channelConf.timeDistindes"}})],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05");const n=o["a"].common.getSysEnum,s=o["a"].common.queryAdivInfo,m=o["a"].common.queryHallInfo;var c={props:["channelNewData"],data(){return{CrmFrom:{adivInfo:{},channelConf:{},channelId:"",channelName:"",attributionInfo:{}},CrmFromRules:{adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}],materialDisplayUrl:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[]}},mounted(){this.getOptionData(),this.CrmFrom=JSON.parse(JSON.stringify(this.channelNewData))},methods:{async getOptionData(){await Object(l["i"])(n,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(s,{channelId:this.CrmFrom.channelId}).then(e=>{this.adivList=e}),await Object(l["i"])(m,{}).then(e=>{this.attributionList=e})},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},changeAttribution(e){var t="";this.attributionList.forEach(a=>{e===a.adivId&&(t=a.attributionName)}),this.CrmFrom.attributionInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,attributionName:t})},changeTime(){this.timeIdList.forEach(e=>{e.enumKey===this.CrmFrom.timeId&&(this.CrmFrom.timeName=e.enumValue)})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e}},created(){}},u=c,d=a("2877"),h=Object(d["a"])(u,r,i,!1,null,"c964ca44",null);t["a"]=h.exports},a5b3:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"95%"}},[t("Tips",{attrs:{id:e.channelNewData.channelId},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[e._e(),t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.colAdivInfo.adivList,(function(a){return t("el-option",{key:a.adivId,attrs:{label:a.adivName,value:a.adivId,disabled:e.selectedAdivId.has(a.adivId)}})})),1)],1),t("el-form-item",{attrs:{label:"标准化素材：",prop:"columnExt20"}},[t("div",{staticClass:"select-material",on:{click:function(t){return e.selectMaterial(!0)}}},[e._v(e._s(e.CrmFrom.materialName||"请选择"))])]),e.showExt18?t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1):e._e(),t("el-form-item",{attrs:{label:"推荐用语：",prop:"execContent"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.execContent,callback:function(t){e.$set(e.CrmFrom,"execContent",t)},expression:"CrmFrom.execContent"}})],1)],1),t("materialList",{ref:"material",attrs:{channelId:e.CrmFrom.channelId,adivId:e.CrmFrom.adivInfo.adivId},on:{addMaterial:e.addMaterial}})],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("b893"),s=a("f1ce"),m=a("5ed5");a("0b16");const c=o["a"].common.getSysEnum,u=(o["a"].common.queryAdivInfo,o["a"].common.queryHallInfo);var d={props:["channelNewData","id","deleteSub","columnExt1","colAdivInfo","selectedAdivId"],components:{materialList:s["a"],Tips:m["a"]},data(){return{CrmFrom:{adivInfo:{},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",standard:"",CustomerRules:"",execContent:"",columnExt18:"0",columnExt20:""},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],execContent:[{required:!0,message:"请输入营销话术",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],attributionList:[]}},watch:{columnExt1(e,t){this.CrmFrom.columnExt1=e}},mounted(){this.getOptionData(),this.CrmFrom=JSON.parse(JSON.stringify(Object(n["d"])(this.channelNewData))),this.$set(this.CrmFrom,"columnExt1",this.columnExt1),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(c,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(u,{}).then(e=>{this.attributionList=e})},changeAid(e){var t="";this.colAdivInfo.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t}),this.$emit("changeAdiv",e)},SubInstall(e=!0){var t=!0;return this.$refs.CrmFrom.validate(a=>{a||("906"===this.id||"922"===this.id)&&this.CrmFrom.execContent&&this.CrmFrom.adivInfo.adivId?(e&&this.$emit("saveChannelData",this.colAdivInfo.id,this.CrmFrom),t=!0):t=!1}),t},selectMaterial(e){this.$refs["material"].getMaterialList(),this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}}},created(){}},h=d,p=(a("3aeb"),a("2877")),C=Object(p["a"])(h,r,i,!1,null,"1aa78f3e",null);t["a"]=C.exports},a66e:function(e,t,a){},aa07:function(e,t,a){},aabc:function(e,t,a){"use strict";a("66d1")},ab51:function(e,t,a){},ac9f:function(e,t,a){},ae3d:function(e,t,a){},aedd:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"1000px",modal:!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"search_box"},[t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticClass:"input-search",attrs:{placeholder:"请输入事件名称编码"},model:{value:e.queryForm.keyWords,callback:function(t){e.$set(e.queryForm,"keyWords","string"===typeof t?t.trim():t)},expression:"queryForm.keyWords"}},[t("i",{staticClass:"el-input__icon el-icon-search cursor-pointer",attrs:{slot:"suffix"},on:{click:function(t){return e.searchList()}},slot:"suffix"})])],1),t("div",{staticClass:"content"},[t("div",{staticClass:"tree"},[t("div",{staticClass:"search_box"},[t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticClass:"input-search",staticStyle:{width:"80%",margin:"0 auto"},attrs:{placeholder:"输入事件类型名称"},model:{value:e.keyWords,callback:function(t){e.keyWords="string"===typeof t?t.trim():t},expression:"keyWords"}},[t("i",{staticClass:"el-input__icon el-icon-search cursor-pointer",attrs:{slot:"suffix"},on:{click:e.initChannel},slot:"suffix"})])],1),t("el-tree",{ref:"vueTree",attrs:{props:e.props,data:e.channelList,"node-key":"id",accordion:"","highlight-current":"","icon-class":"iconfont icongonggongtubiao-shouqi Treecolor"},on:{"node-click":e.TreeNodeClick},scopedSlots:e._u([{key:"default",fn:function({node:a,data:r}){return t("div",{staticClass:"custom-tree-node"},[t("span",[e._v(e._s(a.label))]),t("span",[e._v(e._s(r.num))])])}}])})],1),t("div",{staticClass:"content-table"},[t("el-table",{staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.chainedData},on:{"row-click":e.singleElection}},[t("el-table-column",{attrs:{align:"center",width:"55",label:"选择"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-radio",{staticClass:"radio",attrs:{label:a.row.eventId},model:{value:e.templateSelection,callback:function(t){e.templateSelection=t},expression:"templateSelection"}},[e._v(" ")])]}}])}),t("el-table-column",{attrs:{prop:"eventId",label:"事件编码","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"eventName",label:"事件名称","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"firstClassName",label:"一级分类"}}),t("el-table-column",{attrs:{prop:"createUserName",label:"创建人"}}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间","show-overflow-tooltip":""}})],1)],1)]),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.queryForm.current,"page-size":e.queryForm.size,layout:"total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)])],1)},i=[],l=a("0fea"),o=(a("d370"),a("5e05")),n=a("b893"),s={props:{title:{type:String,default:"复杂事件场景实例"}},data(){return{dialogVisible:!1,tagsList:[],queryForm:{keyWords:"",current:1,size:10,status:"1",classifyId:""},total:0,chainedData:[],props:{label:"label",children:"children",num:"num"},channelList:[],templateSelection:"",checkList:[],keyWords:""}},created(){this.getChainedList(this.queryForm),this.initChannel()},methods:{async getChainedList(e){let t=await Object(l["i"])(o["a"].common.getSceneList,e);this.chainedData=t.records,this.total=t.total},searchList(){this.getChainedList(this.queryForm)},showDialog(e){this.dialogVisible=e},handleCurrentChange(e){this.queryForm.current=e,this.getChainedList(this.queryForm)},handleSizeChange(e){this.queryForm.size=e,this.getChainedList(this.queryForm)},copyItem(e){},addItem(e){this.$set(this.tagsList,0,e)},handleClose(e){this.tagsList.splice(this.tagsList.indexOf(e),1)},async initChannel(){await Object(l["i"])(o["a"].common.getSceneTypeList,{keyWords:this.keyWords}).then(e=>{this.initAdivInfo(e)})},async initAdivInfo(e){let t=e.map(e=>({id:e.id,label:e.label,children:e.children,parentId:e.parentId}));t=[{label:"全部",id:"-1",parentId:"-2",children:t}],t.forEach(e=>{e.children=e.children.map(e=>({id:e.id,label:e.label,children:e.children,parentId:e.parentId}))}),this.channelList=Object(n["f"])(t,"id","parentId","children","-2")},TreeNodeClick(e){"全部"===e.label?(this.queryForm={...this.queryForm,classifyId:"",current:1},this.getChainedList(this.queryForm)):(this.queryForm={...this.queryForm,classifyId:e.id},this.getChainedList(this.queryForm))},singleElection(e){this.templateSelection=e.eventId,this.checkList=this.chainedData.filter(t=>t.eventId===e.eventId)},clearEvent(){this.templateSelection="",this.checkList=[],this.$forceUpdate()},submit(){this.$emit("addScene",this.checkList[0]),this.dialogVisible=!1}}},m=s,c=(a("8914"),a("2877")),u=Object(c["a"])(m,r,i,!1,null,"5a199ac2",null);t["a"]=u.exports},afa6:function(e,t,a){"use strict";a("ac9f")},b1d2a:function(e,t,a){},b1d3:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALgAAAD2CAMAAABSv73pAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACalBMVEUAAABrbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG5rbG4AAACmE6HhAAAAzHRSTlMABSNUmPAeLPIlBHct5jU/SFNfTEBreAmFAJQBowOEswZQwwlF1Q075xIy+RcqHSMkHCwW9TQR4j4M0UcIv1IFr10Dn2oBkHYAgoQAdZIBaKEDXLEFUcIJRtMNPOURM/gXKx0jJB0rFvc0EeQ9DNJGCMFRBbFcA6FoAZJ1AISDAHaRAWmgA12vBVLACEfRDD3jETT2FiwcJCMdKhf5MxLmPA3URQnDUAayWwOiZ2wBk3QZxAEAhYEDfgV3y9m41mkC1CBiRxGqLWKrCQmv49X6AAAAAWJLR0QAiAUdSAAAAAlwSFlzAAAA/AAAAPwARztR4QAAA1xJREFUeNrt1WVz20AUheETql27KTllZmZmZmZmZmZmZmZmZmZu90e1ycS9bmNPM65k752c96tmr56RdiWAMcYYYzmvhMSk5BTjVrlcc3u8rqEzyu0O2+d3l/2rPK64U113G5PXBbj7zzu9fI67PTFxG5PfYXeCy+dSKuAsPDFWbmMKOgpPCo4NOPwqM0r7Q17IydHJbrr/gpvCDo4O/i+LxAJuihZzbHRwpCvuLHBTvIRSuClZShW8tMjLlNUETysn8vIVNMFRUeSVKmuCo4rIq1bTBEd1kdeoqQmOWiEfl9qa4KgTIq+rCY56IfL6muBo0FDkjTTB0biJyJtqgqNZc5G30ARHy1Yib60JjjZtRd5OExztO4i8oyY4OnUWeRdNcHTtJvLuPRTBgZ4i79VbExx9RN63nyY4+ot8wEBNcAwS+eAhmuAYKvJhwzXBMULkI0dpgmO0yMeM1QTHOJGb8ZrgmBAin6gJjkkh8sma4JgyVeTTNMExfYbIZ2qCY9Zskc/RBMfceSKfrwmOBQtFvkgTHIuXiHypJjiWLRf5Ck1wrFwl8tVrFMGBtSJft14THBtEvnGTJjg2i3zLVk1wbBP59h2a4Ngp8l27NcGxR+R792mCY7/IDxzUBMchkZvDmuA4EiI/qgmOYyHy45rgOHFS5Kc0wXH6jMjPaoLj3HmRX9AEx8VLIr+sCY4rV0V+TRMc12+I/Gbc4LeiWHv7jsjvxhp+L3P6/QdRLH74SOSPYwx/Ehz/9Fk0y5+LPMZwvPh955evouh13OBvjEPFGv72nVI43muF44NWOD5qhePTZ6Vw4MvXbzrh/xPhhBNuaYQTTrilEU444ZZGOOGEWxrhhBNuaYQTTrilEU444ZZGOOGEWxrhhBNuaYQTTrilEU444ZZGOOGEWxrhhBNuaYQTTrilEU444ZZGOOGEWxrhhBNuaYQTTrilEU444ZZGOOGEWxrhhBNuaYQTTrilEU444ZZGOOGEWxrhhBNuaYQTTrilEU444ZZGOOE5FZ6SeeF7vIER+hEJnpx5IRBvYYQCkeBJxmp5IOJWTjQ6ygJP8MablK28WV+GJ96mbOUJs4388UZlI3+4/e9LjTfrn6X6wp5cn+3P3B/enb7PbT6hXg8YY4wxltP6CRgictp+5LVmAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE2LTAxLTA4VDAwOjU5OjI3KzA4OjAwYw2MzAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNi0wMS0wOFQwMDo1OToyNyswODowMBJQNHAAAABjdEVYdHN2Zzpjb21tZW50ACBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE3LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIG+eZkEAAAAYdEVYdHN2Zzp0aXRsZQBEb2N1bWVudC1lbXB0ed4yOrcAAAAASUVORK5CYII="},b4c7:function(e,t,a){"use strict";a("863d")},b605:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id}}),t("el-form",{ref:"CrmFrom",attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"应用号：",prop:"columnExt5"}},[t("el-select",{attrs:{placeholder:"请选择应用号"},model:{value:e.CrmFrom.columnExt5,callback:function(t){e.$set(e.CrmFrom,"columnExt5",t)},expression:"CrmFrom.columnExt5"}},e._l(e.ApplicationNumList,(function(e){return t("el-option",{key:e.applicationId,attrs:{label:e.applicationName,value:e.applicationId}})})),1)],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"模板ID：",prop:"columnExt6"}},[t("el-input",{attrs:{type:"text","show-word-limit":"",placeholder:"请输入模板ID"},model:{value:e.CrmFrom.columnExt6,callback:function(t){e.$set(e.CrmFrom,"columnExt6",t)},expression:"CrmFrom.columnExt6"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"发送参数类型：",prop:"columnExt7"}},[t("el-select",{attrs:{placeholder:"请选择发送参数类型"},on:{change:e.changeSendParams},model:{value:e.CrmFrom.columnExt7,callback:function(t){e.$set(e.CrmFrom,"columnExt7",t)},expression:"CrmFrom.columnExt7"}},e._l(e.sendParamsList,(function(e){return t("el-option",{key:e.enumId,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1)],1),t("el-col",{attrs:{span:24}},[1!=e.custgroupSource||1!=e.CrmFrom.columnExt7&&2!=e.CrmFrom.columnExt7?e._e():t("el-form-item",{attrs:{label:1==e.CrmFrom.columnExt7?"个性变量：":"通用变量：",prop:"columnExt8"}},[t("div",{staticClass:"tag1"},[t("div",[0===e.varList.length?t("div",{staticClass:"placeholder"},[e._v("请添加变量")]):e._e(),e._l(e.varList,(function(a,r){return t("el-tag",{key:a.varValue,attrs:{type:"success",closable:""},on:{close:function(t){return e.removeVar(r)}}},[e._v(" "+e._s(a.varName)+" ")])}))],2),t("div",{staticClass:"varList"},[t("DNAReplaceVar",{on:{getVar:e.addVar}})],1)])])],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"营销类型：",prop:"saleType"}},[t("el-select",{attrs:{placeholder:"请选择营销类型"},on:{change:e.changeSaleType},model:{value:e.CrmFrom.saleType,callback:function(t){e.$set(e.CrmFrom,"saleType",t)},expression:"CrmFrom.saleType"}},e._l(e.saleList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),"1"==e.CrmFrom.saleType?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"复杂事件场景：",prop:"CEP_EVENT_ID"}},[t("div",[t("div",{staticStyle:{display:"flex","justify-content":"space-between","max-width":"375px"}},[t("div",{staticClass:"add-botton"},[t("span",{on:{click:function(t){return e.openSceneDilog(!0)}}},[e._v(e._s(e.CrmFrom.sceneParams.eventName||"添加"))]),t("i",{directives:[{name:"show",rawName:"v-show",value:e.CrmFrom.sceneParams.eventName,expression:"CrmFrom.sceneParams.eventName"}],staticClass:"el-icon-close",on:{click:e.removeEvent}})]),t("el-checkbox",{model:{value:e.CrmFrom.checked,callback:function(t){e.$set(e.CrmFrom,"checked",t)},expression:"CrmFrom.checked"}},[e._v("取消推荐规则设置")])],1),"JX0000000001"===e.customGroupId?t("div",{staticStyle:{color:"red","font-size":"12px"}},[e._v("该活动没有限定客群，触发事件即发送，请慎重选择事件！")]):e._e(),e.CrmFrom.checked?t("div",{staticClass:"select"},[t("div",{staticClass:"setRules"},[t("p",[e._v("已选择事件："+e._s(e.CrmFrom.sceneParams.eventName))])]),t("div",[t("span",[e._v("取消推荐时间：")]),t("el-select",{attrs:{placeholder:"请选择执行端口",size:"mini"},model:{value:e.CrmFrom.columnExt4,callback:function(t){e.$set(e.CrmFrom,"columnExt4",t)},expression:"CrmFrom.columnExt4"}},e._l(e.columnExt4List,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]):e._e()])])],1):e._e(),1!==e.updateCycle?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"频次配置：",prop:e.CrmFrom.FREQUENCY?"FREQUENCY":"num"}},[t("div",{staticStyle:{display:"flex"}},[t("el-select",{attrs:{placeholder:"请选择天数"},model:{value:e.CrmFrom.FREQUENCY,callback:function(t){e.$set(e.CrmFrom,"FREQUENCY",t)},expression:"CrmFrom.FREQUENCY"}},e._l(e.dateList,(function(e){return t("el-option",{key:e.cycleId,attrs:{label:e.cycleName,value:e.cycle}})})),1),t("el-input",{staticStyle:{width:"100px",margin:"0px 20px"},attrs:{type:"text",rows:8,placeholder:""},model:{value:e.CrmFrom.num,callback:function(t){e.$set(e.CrmFrom,"num",t)},expression:"CrmFrom.num"}}),e._v("次 ")],1)])],1):e._e()],1)],1),t("ComplexScene",{ref:"SceneDialog",on:{addScene:e.addScene}})],1)},i=[],l=(a("d9e2"),a("14d9"),a("0fea")),o=a("5e05"),n=a("b893"),s=(a("0b16"),a("aedd")),m=a("5ed5"),c=a("6501");const u=o["a"].common.getSysEnum;o["a"].common.queryAdivInfo,o["a"].common.queryHallInfo;var d={props:["channelNewData","id","deleteSub"],components:{ComplexScene:s["a"],Tips:m["a"],DNAReplaceVar:c["a"]},data(){return{CrmFrom:{channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",standard:"",CustomerRules:"",marketingWords:"",FREQUENCY:"",num:"",CEP_EVENT_ID:"",CEP_SCENE_NAME:"",SMS_CONTENT:"",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt4:"7",columnExt2:"",IF_HAVE_VAR:"0",sceneParams:{eventName:""},checked:Boolean,channelAdivId:""},CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],CEP_EVENT_ID:[{required:!0,message:"请选择复杂事件场景",trigger:"blur"}],FREQUENCY:[{required:!0,message:"请选择频次配置",trigger:"blur"}],num:[{required:!0,message:"请填写次数",trigger:"blur"}],columnExt5:[{required:!0,message:"请选择应用号",trigger:"blur"}],columnExt6:[{required:!0,message:"请填写模板ID",trigger:"blur"}],columnExt7:[{required:!0,message:"请选择发送参数类型",trigger:"blur"}],columnExt8:[{required:!0,validator:(e,t,a)=>{0===t.length?a(new Error("请选择变量")):a()},trigger:"change"}],saleType:[{required:!0,message:"请选择营销类型",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择营销类型",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],varList:[],showScene:!0,dateList:[],replaceVar:[],columnExt4List:[{label:"1天",value:"1"},{label:"2天",value:"2"},{label:"3天",value:"3"},{label:"4天",value:"4"},{label:"5天",value:"5"},{label:"6天",value:"6"},{label:"7天",value:"7"}],saleList:[{label:"实时营销",value:"1"},{label:"批量营销",value:"2"}],msgTypeList:[{label:"补发消息",value:"1"},{label:"追尾消息",value:"2"}],ShortMsgContent:"",ApplicationNumList:[],SysEnumList:[],sendParamsList:[]}},watch:{channelNewData:{handler(){this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.varList=JSON.parse(this.CrmFrom.columnExt8||"[]")},deep:!0},CrmFrom:{handler(e,t){},deep:!0},deleteSub(){},checked(e){this.CrmFrom=e?{...this.CrmFrom,columnExt3:"1"}:{...this.CrmFrom,columnExt3:"0"}},SMS_CONTENT(e){if(val){const e=/\$[a-zA-Z0-9_\u4e00-\u9fa5]+\$/g,t=val.match(e);t&&t.length>0?this.CrmFrom.IF_HAVE_VAR="1":this.CrmFrom.IF_HAVE_VAR="0"}else this.CrmFrom.IF_HAVE_VAR="0"}},computed:{updateCycle(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.updateCycle},customGroupId(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId},SMS_CONTENT(){return this.CrmFrom.columnExt2},checked(){return this.CrmFrom.checked},custgroupSource(){return this.$store.state.extendData.custgroupSource}},created(){this.getOptionData(),this.getDateList(),this.getApplicationNumInfo(),this.CrmFrom=Object(n["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:"",eventId:""}),this.varList=JSON.parse(this.CrmFrom.columnExt8||"[]")},methods:{async getOptionData(){Object(l["i"])(u,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),Object(l["i"])(u,{enumType:"5g_cloud_send_param_type"}).then(e=>{this.sendParamsList=e})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},changeSaleType(e){this.removeEvent(),this.CrmFrom.checked=!1},openSceneDilog(e){this.$refs["SceneDialog"].showDialog(e)},addScene(e){this.CrmFrom={...this.CrmFrom,CEP_EVENT_ID:e.eventId,CEP_SCENE_NAME:e.eventName,sceneParams:e}},removeEvent(){this.CrmFrom.sceneParams={eventName:""},this.CrmFrom.CEP_EVENT_ID="",this.CrmFrom.CEP_SCENE_NAME=""},async getDateList(){await Object(l["i"])(o["a"].common.getDateList).then(e=>{this.dateList=e})},async listCustAttr(){var e;const t=null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId;await Object(l["i"])(o["a"].common.listCustAttr+"?custGroupId="+t).then(e=>{this.replaceVar=e})},getContent(e){const t=this.replaceVar.filter(t=>t.id===e)[0].attrCol;this.ShortMsgContent=t;const a=document.querySelector("#smsDetail");if(a.selectionStart||0===a.selectionStart){var r=a.selectionStart,i=a.selectionEnd;this.CrmFrom={...this.CrmFrom,columnExt2:a.value.substring(0,r)+t+a.value.substring(i,a.value.length)},this.$nextTick(),a.focus(),a.setSelectionRange(i+t.length,i+t.length)}else this.CrmFrom.columnExt2+=t},async getApplicationNumInfo(){await Object(l["i"])(o["a"].common.getApplicationNumInfo,{channelId:this.id}).then(e=>{this.ApplicationNumList=e})},changeSendParams(e){this.CrmFrom.IF_HAVE_VAR="0"===e?"0":"1",this.varList=[],this.CrmFrom.columnExt8=""},addVar(e,t){if(this.varList.some(t=>t.varValue==e))return;const a={varName:t.fieldName,varValue:t.field};this.varList.push(a),this.CrmFrom.columnExt8=JSON.stringify(this.varList)},removeVar(e){this.varList.splice(e,1),this.CrmFrom.columnExt8=JSON.stringify(this.varList),0===this.varList.length&&(this.CrmFrom.columnExt8="")}}},h=d,p=(a("4239"),a("2877")),C=Object(p["a"])(h,r,i,!1,null,"0089cb57",null);t["a"]=C.exports},b62e:function(e,t,a){"use strict";a("bb6e")},b953:function(e,t,a){"use strict";a("aa07")},bb6e:function(e,t,a){},bc05:function(e,t,a){"use strict";a("2d81")},c0ec:function(e,t,a){"use strict";a("17e3")},c126:function(e,t,a){},c37e:function(e,t,a){"use strict";a("c56f")},c3eb:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"模板列表",visible:e.dialogVisible,width:e.tableData.width+"px",modal:!1,top:"25vh",left:"25vw","custom-class":"dialog"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData.records}},[t("el-table-column",{attrs:{type:"index",label:"序号"}}),e._l(e.cols,(function(e){return t("el-table-column",{key:e.props,attrs:{prop:e.props,label:e.label,"show-overflow-tooltip":"content"===e.props}})})),t("el-table-column",{attrs:{property:"address",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{staticClass:"text-sm mr-16",attrs:{type:"primary",underline:!1},on:{click:function(t){return e.addShortMessage(a)}}},[e._v("添加 ")])]}}])})],2),t("div",{staticClass:"pager"},[t("el-pagination",{attrs:{"current-page":e.pageData.currentPage,"page-sizes":e.pageData.pageSizeList,"page-size":e.pageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.tableData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)],1)],1)},i=[],l={props:["tableData","cols","channelId"],data(){return{pageData:{current:1,pageSizeList:[5,10,15,20],size:5,keyWords:"",planId:""},dialogVisible:!1}},created(){this.$emit("getSmsContentTemplateList",this.pageData)},methods:{handleCurrentChange(e){this.pageData.current=e,this.$emit("getSmsContentTemplateList",this.pageData)},handleSizeChange(e){this.pageData.size=e,this.$emit("getSmsContentTemplateList",this.pageData)},showDialog(e){this.dialogVisible=e},addShortMessage(e){this.$emit("addShortMessage",e)}}},o=l,n=(a("864b"),a("2877")),s=Object(n["a"])(o,r,i,!1,null,"2671bee6",null);t["a"]=s.exports},c56f:function(e,t,a){},c691:function(e,t,a){"use strict";a("b1d2a")},c87e:function(e,t,a){"use strict";a("3a17")},c88b:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"CrmFrom",attrs:{"label-width":"150px",model:e.CrmFrom,rules:e.CrmFromRules}},[e.isadivInfo?t("adivInfo",{attrs:{CrmFrom:e.CrmFrom.adivInfo,FromData:e.CrmFrom},on:{"update:CrmFrom":function(t){return e.$set(e.CrmFrom,"adivInfo",t)},"update:crm-from":function(t){return e.$set(e.CrmFrom,"adivInfo",t)},getConfiguration:e.getConfiguration,getadivObj:e.getadivObj}}):e._e(),t("el-form-item",{attrs:{label:"优先级：",prop:"channelConf.priorityOrder"}},[t("div",{staticClass:"block"},[t("el-slider",{attrs:{"show-input":""},model:{value:e.CrmFrom.channelConf.priorityOrder,callback:function(t){e.$set(e.CrmFrom.channelConf,"priorityOrder",t)},expression:"CrmFrom.channelConf.priorityOrder"}})],1)]),1001===e.curAdivInfo.execType?t("el-form-item",{attrs:{label:"复杂事件场景：",prop:"channelConf.cepEventId"}},[void 0!==e.CrmFrom.channelConf.cepEventId?t("el-tag",{staticClass:"cepEventIdTag",attrs:{size:"medium"}},[e._v(e._s(e.CrmFrom.channelConf.cepEventId))]):e._e(),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.cepEventIdVisible=!0}}},[e._v("添加")])],1):e._e(),t("el-form-item",{attrs:{label:"流量激发活动：",prop:"channelConf.ifHaveVar"}},[t("el-radio-group",{model:{value:e.CrmFrom.channelConf.ifHaveVar,callback:function(t){e.$set(e.CrmFrom.channelConf,"ifHaveVar",t)},expression:"CrmFrom.channelConf.ifHaveVar"}},[t("el-radio",{attrs:{label:!0}},[e._v("是")]),t("el-radio",{attrs:{label:!1}},[e._v("否")])],1)],1),t("el-form-item",{attrs:{label:"推荐用语：",prop:"channelConf.execContent"}},[t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],attrs:{type:"textarea",rows:4,"show-word-limit":"",maxlength:500},model:{value:e.CrmFrom.channelConf.execContent,callback:function(t){e.$set(e.CrmFrom.channelConf,"execContent",t)},expression:"CrmFrom.channelConf.execContent"}})],1),e.CrmFrom.channelConf.ifHaveVar?t("el-form-item",{attrs:{label:"短信用语变量："}},[t("ul",{staticClass:"variableLabl"},e._l(e.variable,(function(a){return t("li",{key:a.label},[e._v(" "+e._s(a.name)+" ")])})),0)]):e._e(),t("el-form-item",{attrs:{label:"执行时间："}},[e.isadivInfo?t("ExecutionTime",{key:e.execution,attrs:{form:e.TimeForm},on:{onChange:e.onChange}},[t("el-button",[e._v("执行时间")])],1):e._e()],1),e.isadivInfo?t("configurationSheet",{ref:"configurationSheet",attrs:{CrmFrom:e.CrmFrom.channelConf},on:{configGsheet:e.configGsheet,"update:CrmFrom":function(t){return e.$set(e.CrmFrom,"channelConf",t)},"update:crm-from":function(t){return e.$set(e.CrmFrom,"channelConf",t)}}}):e._e()],1),t("el-dialog",{attrs:{title:"复杂事件实列",width:"1100px",visible:e.cepEventIdVisible,"append-to-body":"","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.cepEventIdVisible=t}}},[e.cepEventIdVisible?t("complexEvents",{ref:"complexEvents",attrs:{cepEventId:e.CrmFrom.channelConf.cepEventId}}):e._e(),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.cepEventIdVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.SubEvents}},[e._v("保 存")])],1)],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("57d8"),s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"complexEvents"},[t("div",{staticClass:"tree"},[t("el-tree",{ref:"vueTree",attrs:{props:e.props,data:e.channelList,"node-key":"id",accordion:"","highlight-current":"","icon-class":"iconfont icongonggongtubiao-shouqi Treecolor"},on:{"node-click":e.TreeNodeClick},scopedSlots:e._u([{key:"default",fn:function({node:a}){return t("div",{staticClass:"custom-tree-node"},[t("span",[e._v(e._s(a.label))])])}}])})],1),t("div",{staticClass:"table"},[t("div",{staticClass:"search_box"},[t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticClass:"input-search",attrs:{placeholder:"请输入事件编号或名称"},model:{value:e.queryForm.keyWords,callback:function(t){e.$set(e.queryForm,"keyWords","string"===typeof t?t.trim():t)},expression:"queryForm.keyWords"}},[t("i",{staticClass:"el-input__icon el-icon-search cursor-pointer",attrs:{slot:"suffix"},on:{click:e.QuerykeyWords},slot:"suffix"})])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"Mp-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.tableRowClassName,height:"calc(100vh - 470px)"}},[t("el-table-column",{attrs:{prop:"eventId",label:"事件编码"}}),t("el-table-column",{attrs:{prop:"eventName",label:"事件名称"}}),t("el-table-column",{attrs:{prop:"firstClassName",label:"一级分类"}}),t("el-table-column",{attrs:{prop:"secondClassName",label:"二级分类"}}),t("el-table-column",{attrs:{prop:"createUserName",label:"创建人"}}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}}),t("el-table-column",{attrs:{prop:"approveTime",label:"审批时间"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-radio",{attrs:{label:a.row.eventId},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(""))])]}}])})],1),t("div",{staticClass:"pager"},[t("el-pagination",{attrs:{"current-page":e.pageData.currentPage,"page-sizes":e.pageData.size,"page-size":e.pageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pageData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])},m=[],c=a("d370"),u={props:["cepEventId"],data(){return{queryForm:{classifyId:"",keyWords:"",status:""},tableData:[],loading:!1,props:{label:"label",children:"children",num:"num"},pageData:{currentPage:1,pageSize:10,pageSizeList:[10,20,30,40],total:0},channelList:[],radio:""}},mounted(){null!==this.cepEventId&&void 0!==this.cepEventId&&(this.radio=this.cepEventId),this.queryEvents(),this.queryCepEventTypeList()},methods:{queryCepEventTypeList(){Object(l["i"])(c["a"].mpapi.queryCepEventTypeList,{statTime:""}).then(e=>{this.channelList=e,this.loading=!1})},queryEvents(){Object(l["i"])(c["a"].mpapi.queryEvents,{...this.queryForm,current:this.pageData.currentPage,size:this.pageData.pageSize}).then(e=>{this.tableData=e.records,this.loading=!1,this.pageData.total=e.total})},QuerykeyWords(){this.pageData.current=1,this.queryEvents()},tableRowClassName(e){const t=e.rowIndex%2;return 0===t?"gray-row":""},TreeNodeClick(e){},handleSizeChange(e){this.pageData.pageSize=e,this.queryEvents()},handleCurrentChange(e){this.pageData.currentPage=e,this.queryEvents()}}},d=u,h=(a("d5cd"),a("40ca"),a("2877")),p=Object(h["a"])(d,s,m,!1,null,"7c362d85",null),C=p.exports,v=a("9044"),f=function(){var e=this,t=e._self._c;return t("div",[t("el-popover",{attrs:{placement:"top-start",trigger:"click"}},[t("div",{staticClass:"ExcutionTime"},[t("div",{staticClass:"Time"},[t("div",{staticClass:"title"},[t("span",[e._v("月执行时间")]),t("span",[t("el-checkbox",{on:{change:function(t){return e.SelectAll(e.month,31,"Month")}},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}},[e._v("全选")])],1)]),t("div",{staticClass:"MonthTable"},[t("ul",e._l(7,(function(e){return t("li",{key:e})})),0),t("ul",e._l(35,(function(a){return t("li",{key:a,class:e.isMonth(a)?"bg":"",on:{click:function(t){return e.SingleChoice(a,"Month")}}},[e._v(" "+e._s(a>31?"":a)+" ")])})),0),t("ul",e._l(7,(function(e){return t("li",{key:e})})),0)])]),t("div",{staticClass:"Time"},[t("div",{staticClass:"title"},[t("span",[e._v("周执行时间")]),t("span",[t("el-checkbox",{on:{change:function(t){return e.SelectAll(e.week,7,"Week")}},model:{value:e.week,callback:function(t){e.week=t},expression:"week"}},[e._v("全选")])],1)]),t("div",{staticClass:"WeekTable"},[t("ul",e._l(7,(function(a){return t("li",{key:a,class:e.isWeek(a)?"bg":"",on:{click:function(t){return e.SingleChoice(a,"Week")}}},[e._v(" 星期"+e._s(e.WeekList[a-1])+" ")])})),0)])]),t("div",{staticClass:"Time Day"},[t("div",{staticClass:"title"},[t("span",[e._v("天执行时间")]),t("span",[t("el-checkbox",{on:{change:function(t){return e.SelectAll(e.day,48,"Day")}},model:{value:e.day,callback:function(t){e.day=t},expression:"day"}},[e._v("全选")])],1)]),t("div",{staticClass:"DayTable"},[t("ul",[t("li",[t("div",[t("el-checkbox",{on:{change:function(t){return e.DaySelect(e.isbeforeDawn,16,"beforeDawn")}},model:{value:e.isbeforeDawn,callback:function(t){e.isbeforeDawn=t},expression:"isbeforeDawn"}},[e._v("凌晨(0点~8点)")])],1),t("ul",{staticClass:"DayTableTimeSlot"},e._l(e.beforeDawn,(function(a,r){return t("li",{key:a,class:e.isDay(r,0)?"bg":"",on:{click:function(t){return e.SingleChoice(r,"beforeDawn")}}},[e._v(e._s(a))])})),0)]),t("li",[t("div",[t("el-checkbox",{on:{change:function(t){return e.DaySelect(e.isDayList,16,"DayList")}},model:{value:e.isDayList,callback:function(t){e.isDayList=t},expression:"isDayList"}},[e._v("白天(8点~16点)")])],1),t("ul",{staticClass:"DayTableTimeSlot"},e._l(e.DayList,(function(a,r){return t("li",{key:a,class:e.isDay(r,16)?"bg":"",on:{click:function(t){return e.SingleChoice(r,"DayList")}}},[e._v(e._s(a))])})),0)]),t("li",[t("div",[t("el-checkbox",{on:{change:function(t){return e.DaySelect(e.isnight,16,"night")}},model:{value:e.isnight,callback:function(t){e.isnight=t},expression:"isnight"}},[e._v("夜间(16点~24点)")])],1),t("ul",{staticClass:"DayTableTimeSlot"},e._l(e.night,(function(a,r){return t("li",{key:a,class:e.isDay(r,32)?"bg":"",on:{click:function(t){return e.SingleChoice(r,"night")}}},[e._v(e._s(a))])})),0)])])])])]),e._t("default",null,{slot:"reference"})],2)],1)},b=[],g=(a("14d9"),{props:["form"],data(){return{month:!1,week:!1,day:!1,isbeforeDawn:!1,isDayList:!1,isnight:!1,WeekList:["一","二","三","四","五","六","日"],TimeList:[],beforeDawn:[],night:[],DayList:[],isWeekSelect:"0000000",isMonthSelect:"0000000000000000000000000000000",isDaySelect:"000000000000000000000000000000000000000000000000"}},computed:{isWeek:function(){return e=>"1"===this.isWeekSelect[e-1]},isMonth:function(){return e=>"1"===this.isMonthSelect[e-1]},isDay:function(){return(e,t)=>"1"===this.isDaySelect[e+t]}},mounted(){var e=this.getTimeList(24,30);e.push("23:30~00:00"),this.beforeDawn=e.slice(0,16),this.DayList=e.slice(16,32),this.night=e.slice(32,48),""!==this.form.dayMask&&(this.isMonthSelect=this.form.dayMask,this.month=this.verificationStr(this.isMonthSelect)),""!==this.form.weekMask&&(this.isWeekSelect=this.form.weekMask,this.week=this.verificationStr(this.isWeekSelect)),""!==this.form.minute10Mask&&(this.isDaySelect=this.form.minute10Mask,this.day=this.verificationStr(this.isDaySelect),this.isbeforeDawn=this.verificationStr(this.isDaySelect.substring(0,16)),this.isDayList=this.verificationStr(this.isDaySelect.substring(16,32)),this.isnight=this.verificationStr(this.isDaySelect.substring(32,this.isDaySelect.length))),this.Change()},methods:{SelectAll(e,t,a){for(var r="",i=0;i<t;i++)r+=e?1:0;"Month"===a?this.isMonthSelect=r:"Week"===a?this.isWeekSelect=r:(this.isDaySelect=r,this.isbeforeDawn=this.day,this.isDayList=this.day,this.isnight=this.day),this.Change()},DaySelect(e,t,a){for(var r="",i=this.isDaySelect,l=0;l<t;l++)r+=e?1:0;this.isDaySelect="beforeDawn"===a?r+i.substring(16,i.length):"DayList"===a?i.substring(0,16)+r+i.substring(32,i.length):i.substring(0,32)+r,this.Change()},SingleChoice(e,t){"Month"===t?(this.isMonthSelect=this.replaceStr(this.isMonthSelect,e-1),this.month=this.verificationStr(this.isMonthSelect)):"Week"===t?(this.isWeekSelect=this.replaceStr(this.isWeekSelect,e-1),this.week=this.verificationStr(this.isWeekSelect)):"beforeDawn"===t?(this.isDaySelect=this.replaceStr(this.isDaySelect,e),this.isbeforeDawn=this.verificationStr(this.isDaySelect.substring(0,16)),this.day=this.verificationStr(this.isDaySelect)):"DayList"===t?(this.isDaySelect=this.replaceStr(this.isDaySelect,e+16),this.isDayList=this.verificationStr(this.isDaySelect.substring(16,32)),this.day=this.verificationStr(this.isDaySelect)):(this.isDaySelect=this.replaceStr(this.isDaySelect,e+32),this.isnight=this.verificationStr(this.isDaySelect.substring(32,this.isDaySelect.length)),this.day=this.verificationStr(this.isDaySelect)),this.Change()},Change(){var e={week:this.isWeekSelect,day:this.isDaySelect,Month:this.isMonthSelect};this.$emit("onChange",e)},verificationStr(e){const t=e.split("");var a=t.filter(e=>"1"!==e);return 0===a.length},replaceStr(e,t){const a=e.split("");return a[t]="1"===a[t]?"0":"1",a.join("")},getTimeList(e,t){for(var a=60,r=[],i=[],l=0;l<e;l++){var o="";o=l<10?"0"+l:""+l;for(var n=0;n<a;n++)if(n%t===0){var s=n<10?":0"+n:":"+n;s=o+s,r.length>0&&i.push(r[r.length-1]+"~"+s),r.push(s)}}return i}}}),x=g,E=(a("95b7"),Object(h["a"])(x,f,b,!1,null,"f02c07f0",null)),F=E.exports;const y=o["a"].common.getSysEnum;var I={components:{configurationSheet:n["a"],adivInfo:v["a"],complexEvents:C,ExecutionTime:F},props:["channelNewData"],data(){return{CrmFrom:{adivInfo:{},channelConf:{ifHaveVar:!1,priorityOrder:0},channelId:"",channelName:""},CrmFromRules:{adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],priorityOrder:[{required:!0,message:"请输入优先等级",trigger:"blur"}],cepEventId:[{required:!0,message:"请选择复杂事件",trigger:"blur"}],ifHaveVar:[{required:!0,message:"请选择流量激发活动",trigger:"blur"}]}},timeIdList:[],adivList:[],isadivInfo:!1,variable:[{name:"APP名称",label:"$APP_NAME$"},{name:"内容热点",label:"$CONTENT_HOT_SPOT$"},{name:"内容标签",label:"$CONTENT_LABEL$"},{name:"内容主题",label:"$CONTENT_SUBJECT$"}],cepEventIdVisible:!1,TimeForm:{weekMask:"",dayMask:"",minute10Mask:""},curAdivInfo:{},execution:1}},mounted(){this.getOptionData();var e=Object.assign({},this.CrmFrom.channelConf);this.CrmFrom=JSON.parse(JSON.stringify(this.channelNewData)),this.CrmFrom.channelConf=Object.assign({},{...e,...this.channelNewData.channelConf});var t=new Date,a=t.getDate()-1,r="0000000000000000000000000000000";this.TimeForm={weekMask:this.CrmFrom.channelConf.executeTimeWeek||"1111111",dayMask:this.CrmFrom.channelConf.executeTimeMonth||this.replaceStr(r,a),minute10Mask:this.CrmFrom.channelConf.executeTimeDay||"000000000000000011111111111111111111111100000000"},this.isadivInfo=!0},methods:{async getOptionData(){await Object(l["i"])(y,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e})},getConfiguration(e){if(1!==e.zt){this.CrmFrom.channelConf={priorityOrder:0,ifHaveVar:!1};var t=new Date,a=t.getDate()-1,r="0000000000000000000000000000000";this.TimeForm={weekMask:"1111111",dayMask:this.replaceStr(r,a),minute10Mask:"000000000000000011111111111111111111111100000000"}}this.execution++,this.$refs.configurationSheet.lookSchedulingInfo(e.configid)},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},changeTime(){this.timeIdList.forEach(e=>{e.enumKey===this.CrmFrom.timeId&&(this.CrmFrom.timeName=e.enumValue)})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},configGsheet(e){this.CrmFrom.channelConf=Object.assign(this.CrmFrom.channelConf,e),this.CrmFrom=JSON.parse(JSON.stringify(this.CrmFrom))},onChange(e){this.CrmFrom.channelConf.executeTimeDay=e.day,this.CrmFrom.channelConf.executeTimeMonth=e.Month,this.CrmFrom.channelConf.executeTimeWeek=e.week},SubEvents(){this.CrmFrom.channelConf.cepEventId=this.$refs.complexEvents.radio,this.CrmFrom.channelConf=Object.assign({},this.CrmFrom.channelConf),this.cepEventIdVisible=!1},getadivObj(e){this.curAdivInfo=e},replaceStr(e,t){const a=e.split("");return a[t]="1"===a[t]?"0":"1",a.join("")}},created(){}},k=I,w=(a("0dd9"),a("7032"),Object(h["a"])(k,r,i,!1,null,"6c38c9aa",null));t["a"]=w.exports},c98a:function(e,t,a){"use strict";a("a365")},cd74:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mk-content"},[t("div",{staticClass:"mk-html-content",domProps:{innerHTML:e._s(e.marketingWords)}})])},i=[],l={props:{marketingWords:{type:String,default:""}},methods:{}},o=l,n=(a("4880"),a("2877")),s=Object(n["a"])(o,r,i,!1,null,"539dcce2",null);t["a"]=s.exports},d1a4:function(e,t,a){"use strict";a("d4be")},d212:function(e,t,a){"use strict";const r="/mcd-eval/action",i="/plan-svc/api",l="/element-svc/api";t["a"]={effectAppraisal:{queryActServiceTypeInfo:r+"/effectEvaluate/activity/queryActServiceTypeInfo.do",queryUserCityInfo:r+"/effectEvaluate/activity/queryUserCityInfo.do",queryChannelInfo:r+"/effectEvaluate/activity/queryChannelInfo.do",queryPlanTypeInfo:r+"/effectEvaluate/activity/queryPlanTypeInfo.do",queryActServiceTypeIndicatorInfo:r+"/effectEvaluate/activity/queryActServiceTypeIndicatorInfo.do",saveViewIndicatorInfo:r+"/effectEvaluate/activity/saveViewIndicatorInfo.do",listCampInfo:r+"/effectEvaluate/activity/listCampInfo.do",listPlanInfo:r+"/effectEvaluate/product/listPlanInfo.do",channelOrSceneAppraise:r+"/appraisal/channelOrSceneAppraise.do",pagelist:i+"/singleUser/pagelist",queryPage:"/eval-svc/eval5g/queryPage",export:"/eval-svc/eval5g/export",queryPageCloud:"/eval-svc/eval/5gcloud/queryPage",export5gCloudEvalListData:"/eval-svc/eval/5gcloud/export5gCloudEvalListData",exportIvr:"/eval-svc/reportIvr/export",queryPageIvr:"/eval-svc/reportIvr/queryPage",querySystemUsageCityList:i+"/action/systemUsage/querySystemUsageCityList",querySystemUsageDeptList:i+"/action/systemUsage/querySystemUsageDeptList",querySystemUsagePersonageList:i+"/action/systemUsage/querySystemUsagePersonageList",getUsageCityDetailList:i+"/action/systemUsage/getUsageCityDetailList",getUsageDeptDetailList:i+"/action/systemUsage/getUsageDeptDetailList",getUsagePersonageDetailList:i+"/action/systemUsage/getUsagePersonageDetailList",exportReport:"/eval-svc/report/export",queryPageReport:"/eval-svc/report/queryPage",batchDeleteMaterial:l+"/mcdDimMaterial/jx/batchDeleteMaterial",deleteMaterial:l+"/mcdDimMaterial/jx/deleteMaterial",getIntelligentMatchingMaterialList:l+"/mcdDimMaterial/jx/getIntelligentMatchingMaterialList",getMaterial:l+"/mcdDimMaterial/jx/getMaterial",loadImage:l+"/mcdDimMaterial/jx/loadImage",materialImportTemplateDownload:l+"/mcdDimMaterial/jx/materialImportTemplateDownload",queryChannel:l+"/mcdDimMaterial/jx/queryChannel",queryContact:l+"/mcdDimMaterial/jx/queryContact",queryMaterialPageList:l+"/mcdDimMaterial/jx/queryMaterialPageList",queryPosition:l+"/mcdDimMaterial/jx/queryPosition",removeMaterialById:l+"/mcdDimMaterial/jx/removeMaterialById",saveOrUpdateMaterial:l+"/mcdDimMaterial/jx/saveOrUpdateMaterial",updateMaterialStatus:l+"/mcdDimMaterial/jx/updateMaterialStatus",uploadMaterialPicture:l+"/mcdDimMaterial/jx/uploadMaterialPicture",uploadMaterialsFile:l+"/mcdDimMaterial/jx/uploadMaterialsFile",uploadMaterialVideo:l+"/mcdDimMaterial/jx/uploadMaterialVideo",exportMaterialsFile:l+"/mcdDimMaterial/jx/exportMaterialsFile",queryChart:"/eval-svc/home/eval/queryChart",monthEffect:"/eval-svc/home/eval/month/effect",dayEffect:"/eval-svc/home/eval/day/effect",getTacticsListByCityId:"/eval-svc/home/eval/getTacticsListByCityId",queryChannelRadarMap:"/eval-svc/eval/queryChannelRadarMap",queryMonitor:"/plan-svc/api/monitor/queryMonitor",getCaliberInfo:"/plan-svc/api/kpi/getCaliberInfo",updateCaliberInfo:"/plan-svc/api/kpi/updateCaliberInfo",queryChannelEval:"/eval-svc/evaluate/channel/jx/list",exportChannelEval:"/eval-svc/evaluate/channel/jx/exportChannelEval",campEval:"/eval-svc/eval/campEval",exportActivityEval:"/eval-svc/eval/export",exportEffectEval:"/eval-svc/effect/eval/exportEffectEval",getDetailByDrillDownType:"/eval-svc/effect/eval/getDetailByDrillDownType",queryEffectEvalAllCount:"/eval-svc/effect/eval/queryEffectEvalAllCount",gridExport:"/eval-svc/smart/grid/eval/export",gridEval:"/eval-svc/smart/grid/eval/gridEval",exportSmsSendHistory:"/plan-svc/mcd/sms/send/exportSmsSendHistory",querySmsSendHistory:"/plan-svc/mcd/sms/send/querySmsSendHistory",querySmsSendMonitory:"/plan-svc/mcd/sms/send/querySmsSendMonitory",smsSendHistoryTask:"/plan-svc/mcd/sms/send/smsSendHistoryTask",smsSendMonitorTask:"/plan-svc/mcd/sms/send/smsSendMonitorTask",smsSendTaskPause:"/plan-svc/mcd/sms/send/smsSendTaskPause",queryTask:"/plan-svc/mcd-camp-import-task/queryTask",batchImportCamp:"/plan-svc/mcd-camp-import-task/batchImportCamp",successRate:"/eval-svc/eval/home/successRate",sucess:"/eval-svc/eval/home/sucess",total:"/eval-svc/eval/home/total",dw88Camp:"/eval-svc/mcd/onlinel/report/dw88Camp",dwHeigh88City:"/eval-svc/mcd/onlinel/report/dwHeigh88City",getDateTime:"/eval-svc/mcd/onlinel/report/getDateTime",onlineReportDataExport:"/eval-svc/mcd/onlinel/report/onlineReportDataExport",stCamp85CityDm:"/eval-svc/mcd/onlinel/report/stCamp85CityDm",stCamp85HdDm:"/eval-svc/mcd/onlinel/report/stCamp85HdDm",stCamp86CityDm:"/eval-svc/mcd/onlinel/report/stCamp86CityDm",stCamp86HdDm:"/eval-svc/mcd/onlinel/report/stCamp86HdDm",qryTermEval:"/mkt-term-svc/api/qryTermEval"}}},d443:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("input",{ref:"uploadRef",staticStyle:{display:"none"},attrs:{type:"file",accept:e.accept,multiple:e.multiple},on:{change:e.getFile}}),t("el-button",{attrs:{type:"primary",loading:e.uploadLoading},on:{click:e.clickUploadBtn}},[e._v(e._s(e.uploadLoading?"正在上传":"点击上传"))]),e.tip?t("span",{staticClass:"tip",domProps:{innerHTML:e._s(e.tip)}}):e._e(),t("div",{staticClass:"file-content"},[t("transition-group",{staticClass:"file-fade-group",attrs:{name:"fade"}},e._l(e.file_list,(function(a,r){return t("section",{key:a.url+r,staticClass:"file-item",on:{click:function(t){return e.downloadFile(a)}}},[a.imgUrl?t("el-image",{staticStyle:{width:"50",height:"50px"},attrs:{fit:"cover",src:a.imgUrl,"preview-src-list":[a.imgUrl]}},[t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline"})])]):t("img",{attrs:{src:a.icon,width:"50",height:"50"}}),t("el-tooltip",[t("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(a.fileName))]),t("span",{staticClass:"file-name"},[e._v(" "+e._s(a.fileName)+" ")])]),t("div",{staticClass:"close"},[t("i",{staticClass:"el-icon-close",on:{click:function(t){return e.clearFile(t,a)}}})])],1)})),0)],1)],1)},i=[],l=(a("14d9"),a("88a7"),a("271a"),a("5494"),a("0fea")),o=a("5af3"),n=a("fcff"),s=a.n(n),m=a("b1d3"),c=a.n(m),u=a("5414"),d=a.n(u),h=a("56b3"),p=a.n(h),C=a("f26a"),v=a.n(C),f={name:"UploadComponent",props:{accept:{type:String,default:"*"},action:{type:String,default:""},multiple:{type:Boolean,default:!1},limit:{type:Number||void 0,default:void 0},fileList:{type:Array||Object,default:()=>[]},requestKey:{type:String,default:"file"},responseKey:{type:Object,default:()=>({fileName:"fileName",url:"url"})},tip:{type:String||Array,default:""},rules:{type:Object,default:()=>({size:524288e3,type:[],imgSize:[]})}},data(){return{loadList:[],file_list:[],imgTypes:["jpg","jpeg","png","gif","bmp","webp","psd","svg","tiff"]}},computed:{uploadLoading(){return this.loadList.length>0}},watch:{fileList:{handler(e){let t=[];Array.isArray(this.fileList)?t=this.fileList:t.push(this.fileList),t.forEach(e=>{this.handleData(e)})},immediate:!0,deep:!0},file_list:{handler(e){this.$emit("changeFile",e)},deep:!0}},methods:{handleData(e){if(void 0===e.url)return;let t={fileName:e.fileName,url:e.url,icon:this.getFileIconUrl(e.fileName),imgUrl:""};this.imgTypes.includes(e.fileName.substring(e.fileName.lastIndexOf(".")+1))&&Object(o["d"])(e.url).then(e=>{t.imgUrl=e}),this.file_list.push(t)},clickUploadBtn(){this.$refs["uploadRef"].value=null,this.$refs["uploadRef"].click()},getFile({target:e}){if(!this.multiple&&this.file_list.length>0)return void this.$message.error("文件已上传，请先删除后再上传");if(this.multiple&&this.limit&&this.file_list.length+e.files.length>this.limit)return void this.$message.error("文件数量超出限制，请最多上传"+this.limit+"个文件");let t=e.files;for(let a of t)this.validateFile(a).then(e=>{e&&this.uploadFile(a)})},async validateFile(e){let{size:t,type:a,imgSize:r}=this.rules,i=e.name.substring(e.name.lastIndexOf(".")+1);if((null===a||void 0===a?void 0:a.length)>0&&!a.includes(i))return this.$message.error("文件类型不符合要求,请上传"+a.join(",")+"格式文件"),Promise.resolve(!1);if(e.size>t)return this.$message.error("文件大小不符合要求,请上传小于"+t/1024/1024+"M的文件"),Promise.resolve(!1);if((null===r||void 0===r?void 0:r.length)>0){let t=new Image,a=URL.createObjectURL(e);return t.src=a,new Promise((e,a)=>{t.onload=()=>t.width!=r[0]||t.height!=r[1]?(this.$message.error("图片尺寸不符合要求, 请上传"+r[0]+"*"+r[1]+"的图片"),e(!1)):e(!0)})}return Promise.resolve(!0)},async uploadFile(e){this.loadList.push(1);try{let t=new FormData,a="file";t.append(a,e);const r=await Object(l["j"])(this.action,t),i=r[this.responseKey.fileName],o=r[this.responseKey.url];this.handleData({fileName:i,url:o})}catch(t){}finally{this.loadList.pop()}},clearFile(e,t){e.stopPropagation(),this.file_list.splice(this.file_list.indexOf(t),1)},getFileIconUrl(e){const t=e.substring(e.lastIndexOf(".")+1);return"xls"===t||"xlsx"===t?s.a:"pdf"===t?d.a:"txt"===t?p.a:"doc"===t||"docx"===t?v.a:c.a},async downloadFile(e){if(!e.imgUrl)try{const t=await Object(o["d"])(e.url);let a=document.createElement("a");a.style.display="none",a.href=t,a.setAttribute("download",e.fileName),document.body.appendChild(a),a.click(),document.body.removeChild(a)}catch(t){}},clearFileList(){this.file_list=[]}}},b=f,g=(a("8d22"),a("2877")),x=Object(g["a"])(b,r,i,!1,null,"f73081b2",null);t["a"]=x.exports},d4be:function(e,t,a){},d4f7:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPVJREFUOE+lk8ENgkAQRf+ECkzWO1YAHYCVKGXsSTxtGWolaAdQgd7ZxArMmI+uIZhIkDmxmb/vDzszgpkhY/dT15YK2Qj0VNtlOdT/BKSuzRWyE0SF4lE11qwmAvwW0JjOifPaWPNl+LOCxPmrIFrTVfE4NNZ03/34AFJHtxAaKyQT4FRbc2ROAb7DnoraLs9B2QGCAMANQA7gLIj2tV3wHPJZzzlnZcy/AW0JyI1uifMVnfouw7LZGZpQ8xcgcf4gwIWGMwCvX/wX0HVnDuAzE5MreHcsa6wp+LiTAKm7xxyofpcCgDNfjS0W52S4VKPbOAZ9Av0TtRGHhvvtAAAAAElFTkSuQmCC"},d5cd:function(e,t,a){"use strict";a("4873")},d6bd:function(e,t,a){"use strict";a("9d33")},d7d2:function(e,t,a){"use strict";a("866a")},d83e:function(e,t,a){"use strict";var r=function(){var e,t,a,r=this,i=r._self._c;return i("div",{staticStyle:{width:"100%"}},[i("Tips",{attrs:{id:r.id},on:{getChannelDetail:r.getChannelDetail}}),i("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:r.CrmFrom,rules:r.CrmFromRules}},[i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[i("el-radio-group",{model:{value:r.CrmFrom.columnExt1,callback:function(e){r.$set(r.CrmFrom,"columnExt1",e)},expression:"CrmFrom.columnExt1"}},[i("el-radio",{attrs:{label:"1",disabled:!r.CrmFrom.channelFlag}},[r._v("全量推送")]),i("el-radio",{attrs:{label:"0",disabled:!r.CrmFrom.channelFlag}},[r._v("偏好推送")])],1)],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[i("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:r.changeAid},model:{value:r.CrmFrom.adivInfo.adivId,callback:function(e){r.$set(r.CrmFrom.adivInfo,"adivId",e)},expression:"CrmFrom.adivInfo.adivId"}},r._l(r.adivList,(function(e){return i("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"标准化素材：",prop:"columnExt20"}},[i("div",{staticClass:"select-material",on:{click:function(e){return r.selectMaterial(!0)}}},[r._v(r._s(r.CrmFrom.materialName||"请选择"))])])],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"项目层级二：",prop:"columnExt5"}},[i("el-select",{attrs:{placeholder:"请选择项目层级二"},on:{change:r.changeProject},model:{value:r.CrmFrom.columnExt5,callback:function(e){r.$set(r.CrmFrom,"columnExt5",e)},expression:"CrmFrom.columnExt5"}},r._l(r.projectLevelSec,(function(e){return i("el-option",{key:e.id,attrs:{label:e.levelValue,value:e.id}})})),1)],1)],1),i("el-col",{attrs:{span:24}},[null!==(e=r.CrmFrom.adivInfo)&&void 0!==e&&null!==(e=e.adivId)&&void 0!==e&&e.includes("8111")?r._e():i("el-form-item",{attrs:{label:"营销类型：",prop:"saleType"}},[i("el-select",{attrs:{placeholder:"请选择营销类型"},on:{change:r.changeSaleType},model:{value:r.CrmFrom.saleType,callback:function(e){r.$set(r.CrmFrom,"saleType",e)},expression:"CrmFrom.saleType"}},r._l(r.saleList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"项目层级三：",prop:"columnExt6"}},[i("el-select",{attrs:{placeholder:"请选择项目层级三"},on:{change:r.changeProjectTh},model:{value:r.CrmFrom.columnExt6,callback:function(e){r.$set(r.CrmFrom,"columnExt6",e)},expression:"CrmFrom.columnExt6"}},r._l(r.projectLevelTh,(function(e){return i("el-option",{key:e.id,attrs:{label:e.levelValue,value:e.id}})})),1)],1)],1),"1"!==r.CrmFrom.saleType||null!==(t=r.CrmFrom.adivInfo)&&void 0!==t&&null!==(t=t.adivId)&&void 0!==t&&t.includes("8111")?r._e():i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"复杂事件场景：",prop:"CEP_EVENT_ID"}},[i("div",[i("div",{staticStyle:{display:"flex","justify-content":"space-between","max-width":"375px"}},[i("div",{staticClass:"add-botton"},[i("span",{on:{click:function(e){return r.openSceneDilog(!0)}}},[r._v(r._s(r.CrmFrom.sceneParams.eventName||"添加"))]),i("i",{directives:[{name:"show",rawName:"v-show",value:r.CrmFrom.sceneParams.eventName,expression:"CrmFrom.sceneParams.eventName"}],staticClass:"el-icon-close",on:{click:r.removeEvent}})]),i("el-checkbox",{model:{value:r.CrmFrom.checked,callback:function(e){r.$set(r.CrmFrom,"checked",e)},expression:"CrmFrom.checked"}},[r._v("取消推荐规则设置")])],1),"JX0000000001"===r.customGroupId?i("div",{staticStyle:{color:"red","font-size":"12px"}},[r._v("该活动没有限定客群，触发事件即发送，请慎重选择事件！")]):r._e(),r.CrmFrom.checked?i("div",{staticClass:"select"},[i("div",{staticClass:"setRules"},[i("p",[r._v("已选择事件："+r._s(r.CrmFrom.sceneParams.eventName))])]),i("div",[i("span",[r._v("取消推荐时间：")]),i("el-select",{attrs:{placeholder:"请选择执行端口",size:"mini"},model:{value:r.CrmFrom.columnExt4,callback:function(e){r.$set(r.CrmFrom,"columnExt4",e)},expression:"CrmFrom.columnExt4"}},r._l(r.columnExt4List,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]):r._e()])])],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"营销(服务)目标客户及提取规则：",prop:"columnExt9"}},[i("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&r._k(e.keyCode,"enter",13,e.key,"Enter")?null:r.handleTextareaKeydown.apply(null,arguments)}},model:{value:r.CrmFrom.columnExt9,callback:function(e){r.$set(r.CrmFrom,"columnExt9",e)},expression:"CrmFrom.columnExt9"}})],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"任务描述及要求：",prop:"columnExt11","label-width":"148px"}},[i("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&r._k(e.keyCode,"enter",13,e.key,"Enter")?null:r.handleTextareaKeydown.apply(null,arguments)}},model:{value:r.CrmFrom.columnExt11,callback:function(e){r.$set(r.CrmFrom,"columnExt11",e)},expression:"CrmFrom.columnExt11"}})],1)],1),r.showExt18?i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"智能话术："}},[i("el-checkbox",{on:{change:()=>r.CrmFrom.columnExt18=r.checkColumnExt18?"1":"0"},model:{value:r.checkColumnExt18,callback:function(e){r.checkColumnExt18=e},expression:"checkColumnExt18"}},[r._v("启用")]),r.checkColumnExt18?i("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(e){return r.$forceUpdate()}},model:{value:r.CrmFrom.columnExt18,callback:function(e){r.$set(r.CrmFrom,"columnExt18",e)},expression:"CrmFrom.columnExt18"}},[i("el-radio",{attrs:{label:"1"}},[r._v("省端模型")]),i("el-radio",{attrs:{label:"2"}},[r._v("一级IOP模型")])],1):r._e()],1)],1):r._e(),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"营销用语：",prop:"columnExt2"}},[i("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],ref:"wording",attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:r.CrmFrom.columnExt2,callback:function(e){r.$set(r.CrmFrom,"columnExt2",e)},expression:"CrmFrom.columnExt2"}})],1)],1),i("el-col",{attrs:{span:24}},[1==r.custgroupSource?i("el-form-item",{attrs:{label:"营销用语替换变量："}},[i("DNAReplaceVar",{on:{getVar:r.addWord}})],1):i("el-form-item",{attrs:{label:"标签属性：","label-width":"148px"}},[i("div",{staticClass:"label-content"},[i("div",{staticClass:"label"},["variable"==r.lableProp?i("div",{staticClass:"label-item"},r._l(r.labelConfig[r.lableProp],(function(e){return i("span",{key:e.id,on:{click:function(t){return r.addWord(e.attrCol)}}},[r._v(" "+r._s(e.attrColName)+" ")])})),0):i("div",{staticClass:"label-item"},r._l(r.labelConfig[r.lableProp],(function(e){return i("span",{key:e.labelId,class:[r.selectLabelList.some(t=>t.labelId==e.labelId)?"active":""],on:{click:function(t){return r.pushPoint(e)}}},[r._v(r._s(e.labelName)+" ")])})),0)]),i("el-radio-group",{attrs:{size:"mini"},model:{value:r.lableProp,callback:function(e){r.lableProp=e},expression:"lableProp"}},[i("el-radio-button",{attrs:{label:"variable"}},[r._v("营销变量")]),i("el-radio-button",{attrs:{label:"touchPoint"}},[r._v("推送至触点")])],1)],1)])],1),null!==(a=r.CrmFrom.adivInfo)&&void 0!==a&&null!==(a=a.adivId)&&void 0!==a&&a.includes("8111")?i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"外呼需求附件（含需求正文、外呼脚本、客服文档等）：",prop:"columnExt10","label-width":"148px"}},[i("el-upload",{staticClass:"upload-demo",attrs:{action:r.action,"on-remove":r.handleRemove,"before-remove":r.beforeRemove,"on-success":r.handleSuccess,multiple:"",limit:1,"on-exceed":r.handleExceed,headers:{Authorization:r.header},"file-list":r.fileList}},[i("el-button",{attrs:{size:"small",type:"primary"}},[r._v("点击上传")])],1)],1)],1):r._e()],1)],1),i("ComplexScene",{ref:"SceneDialog",on:{addScene:r.addScene}}),i("materialList",{ref:"material",attrs:{adivId:r.CrmFrom.adivInfo.adivId,channelId:r.id},on:{addMaterial:r.addMaterial}})],1)},i=[],l=(a("14d9"),a("0fea")),o=a("5e05"),n=a("a454"),s=(a("0b16"),a("aedd")),m=a("f1ce"),c=a("5ed5"),u=a("6501"),d=a("0557"),h=a("b893");o["a"].common.getSysEnum;const p=o["a"].common.queryAdivInfo;o["a"].common.queryHallInfo;var C={props:["channelNewData","id","deleteSub"],components:{ComplexScene:s["a"],materialList:m["a"],Tips:c["a"],DNAReplaceVar:u["a"]},data(){return{CrmFrom:{adivInfo:{},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",standard:"",CustomerRules:"",marketingWords:"",columnExt2:"",columnExt3:"",columnExt4:"7",columnExt5:"",columnExt6:"",CEP_EVENT_ID:"",CEP_SCENE_NAME:"",sceneParams:{eventName:""},materialName:"",columnExt20:"",saleType:"",columnExt11:"",columnExt10:"",columnExt7:"",columnExt8:"",columnExt12:"",columnExt13:"",columnExt14:"",columnExt15:"",columnExt16:"",columnExt18:"0",IF_HAVE_VAR:"0"},showExt18:!1,checkColumnExt18:!1,fileList:[],CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],columnExt9:[{required:!0,message:"请输入营销(服务)目标客户及提取规则",trigger:"blur"}],columnExt11:[{required:!0,message:"请输入任务描述及要求",trigger:"blur"}],columnExt10:[{required:!0,message:"请上传外呼需求附件",trigger:"blur"}],columnExt2:[{required:!0,message:"请输入营销用语",trigger:"blur"}],columnExt5:[{required:!0,message:"请选择项目层级2",trigger:"blur"}],columnExt6:[{required:!0,message:"请选择任务类型",trigger:"blur"}],CEP_EVENT_ID:[{required:!0,message:"请选择实时事件",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],projectLevelSec:[],projectLevelTh:[],columnExt4List:[{label:"1天",value:"1"},{label:"2天",value:"2"},{label:"3天",value:"3"},{label:"4天",value:"4"},{label:"5天",value:"5"},{label:"6天",value:"6"},{label:"7天",value:"7"}],saleList:[{label:"实时营销",value:"1"},{label:"批量营销",value:"2"}],labelConfig:{variable:[],touchPoint:[{labelName:"可呼时段",labelId:"id123"}],availableLabelIdList:[]},lableProp:"variable",selectLabelList:[]}},computed:{checked(){return this.CrmFrom.checked},customGroupId(){var e;return null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId},header(){return window.sessionStorage.getItem("IOP_TOKEN")},action(){return d["a"].commonConfig.baseURL+"/element-svc/api/jx/file/upload"},saleTypes(){return this.CrmFrom.saleType},custgroupSource(){return this.$store.state.extendData.custgroupSource}},watch:{channelNewData:{handler(){if(this.CrmFrom=Object(h["d"])(this.channelNewData),this.fileList=void 0!==this.CrmFrom.columnExt10?[{name:this.CrmFrom.columnExt10}]:[],this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt2",this.CrmFrom.columnExt2||""),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"columnExt5",this.CrmFrom.columnExt5||""),this.$set(this.CrmFrom,"columnExt6",this.CrmFrom.columnExt6||""),this.$set(this.CrmFrom,"columnExt18",this.CrmFrom.columnExt18||"0"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.$set(this.CrmFrom,"IF_HAVE_VAR",this.channelNewData.IF_HAVE_VAR||"0"),this.checkColumnExt18=this.CrmFrom.columnExt18>0,this.getLabelList(),this.listCustAttr(),this.CrmFrom.adivInfo.adivId){let e={levelType:"iop_projectLevel2_id",parentId:this.CrmFrom.adivInfo.adivId};this.getProject(e);let t={levelType:"iop_projectLevel3_id",parentId:this.CrmFrom.columnExt5};this.getProject(t)}},deep:!0},CrmFrom:{handler(e,t){},deep:!0},checked(e){this.CrmFrom=e?{...this.CrmFrom,columnExt3:"1"}:{...this.CrmFrom,columnExt3:"0"}}},mounted(){if(this.getOptionData(),this.CrmFrom=Object(h["d"])(this.channelNewData),this.fileList=void 0!==this.CrmFrom.columnExt10?[{name:this.CrmFrom.columnExt10}]:[],this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt2",this.CrmFrom.columnExt2||""),this.$set(this.CrmFrom,"columnExt4",this.CrmFrom.columnExt4||"7"),this.$set(this.CrmFrom,"columnExt5",this.CrmFrom.columnExt5||""),this.$set(this.CrmFrom,"columnExt6",this.CrmFrom.columnExt6||""),this.$set(this.CrmFrom,"columnExt7",this.CrmFrom.columnExt7||""),this.$set(this.CrmFrom,"columnExt8",this.CrmFrom.columnExt8||""),this.$set(this.CrmFrom,"columnExt18",this.CrmFrom.columnExt18||"0"),this.$set(this.CrmFrom,"sceneParams",this.CrmFrom.sceneParams||{eventName:""}),this.$set(this.CrmFrom,"IF_HAVE_VAR",this.channelNewData.IF_HAVE_VAR||"0"),this.checkColumnExt18=this.CrmFrom.columnExt18>0,this.getLabelList(),this.listCustAttr(),this.CrmFrom.adivInfo.adivId){let e={levelType:"iop_projectLevel2_id",parentId:this.CrmFrom.adivInfo.adivId};this.getProject(e);let t={levelType:"1"===this.CrmFrom.saleType?"iop_projectLevel3_actual_id":"iop_projectLevel3_id",parentId:this.CrmFrom.columnExt5};this.getProject(t)}},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(p,{channelId:this.id}).then(e=>{this.adivList=e})},changeAid(e){e.includes("8111")&&(this.CrmFrom.CEP_EVENT_ID="",this.CrmFrom.CEP_SCENE_NAME="",this.CrmFrom.sceneParams={eventName:""},this.CrmFrom.checked=!1);var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t});const a={parentId:e,levelType:"iop_projectLevel2_id"};this.getProject(a),this.CrmFrom.columnExt5="",this.CrmFrom.columnExt6="",this.CrmFrom.columnExt7="",this.CrmFrom.columnExt8="",this.CrmFrom.columnExt13="",this.CrmFrom.columnExt14="",this.CrmFrom.columnExt15="",this.CrmFrom.columnExt16=""},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},openSceneDilog(e){this.$refs["SceneDialog"].showDialog(e)},addScene(e){this.CrmFrom={...this.CrmFrom,CEP_EVENT_ID:e.eventId,CEP_SCENE_NAME:e.eventName,sceneParams:e}},removeEvent(){this.CrmFrom.sceneParams={eventName:""},this.CrmFrom.CEP_EVENT_ID="",this.CrmFrom.CEP_SCENE_NAME=""},selectMaterial(e){this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}},handleRemove(e,t){},handleExceed(e,t){this.$message.warning(`当前限制选择 1个文件，本次选择了 ${e.length} 个文件，共选择了 ${e.length+t.length} 个文件`)},beforeRemove(e,t){return this.$confirm(`确定移除 ${e.name}？`)},handleSuccess(e){this.CrmFrom={...this.CrmFrom,columnExt10:e.data.fileName}},onUploadBeforeSend(e){let t=e.name.substring(e.name.lastIndexOf(".")+1);const a="xls"===t,r="xlsx"===t,i="png"===t,l="jpg"===t,o="doc"===t;let n=e.size/1024/1024<5?1:0;0===n&&this.$message({message:"上传文件大小不能超过5MB!",type:"error"}),a||r||i||l||o||this.$message.error("请上传正确的文件格式");let s=a||r||i||l||o;return s},async getProject(e){await Object(l["i"])(o["a"].common.getProject,e).then(t=>{"iop_projectLevel2_id"===e.levelType?this.projectLevelSec=t:this.projectLevelTh=t})},changeProject(e){const t=this.projectLevelSec.find(t=>t.id===e);this.CrmFrom.columnExt7=t.levelValue,this.CrmFrom.columnExt15=t.levelKey;const a={parentId:t.id,levelType:"iop_projectLevel3_id"};this.CrmFrom.columnExt6="",this.CrmFrom.columnExt8="",this.CrmFrom.columnExt13="",this.CrmFrom.columnExt14="",this.CrmFrom.columnExt16="",this.getProject(a)},changeSaleType(e){this.removeEvent(),this.CrmFrom.checked=!1,"2"===e&&(this.CrmFrom={...this.CrmFrom,CEP_SCENE_NAME:"",CEP_EVENT_ID:"",sceneParams:{eventName:""},checked:!1}),this.CrmFrom.columnExt6="",this.CrmFrom.columnExt8="",this.CrmFrom.columnExt13="",this.CrmFrom.columnExt14="",this.CrmFrom.columnExt16="";let t={levelType:"1"===e?"iop_projectLevel3_actual_id":"iop_projectLevel3_id",parentId:this.CrmFrom.columnExt5};this.getProject(t)},changeProjectTh(e){const t=this.projectLevelTh.find(t=>t.id===e);this.CrmFrom={...this.CrmFrom,columnExt8:t.levelValue,columnExt13:t.taskTypeId,columnExt14:t.taskTypeName,columnExt16:t.levelKey}},async listCustAttr(){try{var e;const t=null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId,a=await Object(l["i"])(o["a"].common.listCustAttr+"?custGroupId="+t);this.labelConfig.variable=a}catch(t){}},async getLabelList(){try{var e;const t=await Object(l["i"])(n["a"].custgroup.getLabelByChannelId,{channelId:this.id,customGroupId:null===(e=this.$store.state.MarkPl.SceneNodeData[0][1])||void 0===e||null===(e=e.NodeObj[0])||void 0===e?void 0:e.customGroupId});this.labelConfig.touchPoint=t.allLabelInfoList.filter(e=>t.availableLabelIdList.includes(e.labelId)),this.CrmFrom.columnExt12&&(this.selectLabelList=this.labelConfig.touchPoint.filter(e=>this.CrmFrom.columnExt12.split(",").includes(e.labelId)))}catch(t){this.labelConfig.touchPoint=[]}},addWord(e){let t="$"+e+"$";e=t,this.CrmFrom.IF_HAVE_VAR="1";let a=this.$refs.wording.$el.querySelector(".el-textarea__inner");void 0===this.CrmFrom.columnExt2&&(this.CrmFrom.columnExt2=""),this.CrmFrom.columnExt2+=e,this.$forceUpdate(),a.focus()},pushPoint(e){this.selectLabelList.some(t=>t.labelId==e.labelId)?this.selectLabelList=this.selectLabelList.filter(t=>t.labelId!=e.labelId):this.selectLabelList.push(e),this.CrmFrom.columnExt12=this.selectLabelList.map(e=>e.labelId).join(",")},handleTextareaKeydown(){let e=arguments[0];if("Enter"===e.key||"Enter"===e.code||13==e.keyCode)return e.returnValue=!1,!1}}},v=C,f=(a("7b98"),a("2877")),b=Object(f["a"])(v,r,i,!1,null,"a83cccdc",null);t["a"]=b.exports},dcfa:function(e,t,a){"use strict";a("fd6d")},df2f:function(e,t,a){},df4d:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"CrmFrom",attrs:{"label-width":"100px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"运营位：",prop:"adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivId,callback:function(t){e.$set(e.CrmFrom,"adivId",t)},expression:"CrmFrom.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"物料：",prop:"material"}},[t("el-input",{staticStyle:{width:"60%"},on:{focus:e.preMaterial},model:{value:e.CrmFrom.material,callback:function(t){e.$set(e.CrmFrom,"material",t)},expression:"CrmFrom.material"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.preview}},[e._v(" 预览 ")])],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"产品价格",prop:"proPrice"}},[t("el-input",{staticStyle:{width:"60%"},model:{value:e.CrmFrom.proPrice,callback:function(t){e.$set(e.CrmFrom,"proPrice",t)},expression:"CrmFrom.proPrice"}})],1),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"URL链接：",prop:"urlLink"}},[t("el-input",{staticStyle:{width:"60%"},model:{value:e.CrmFrom.urlLink,callback:function(t){e.$set(e.CrmFrom,"urlLink",t)},expression:"CrmFrom.urlLink"}})],1),t("el-form-item",{attrs:{label:"优先级：",prop:"priorityOrder"}},[t("div",{staticClass:"block"},[t("el-slider",{attrs:{"show-input":""},model:{value:e.CrmFrom.priorityOrder,callback:function(t){e.$set(e.CrmFrom,"priorityOrder",t)},expression:"CrmFrom.priorityOrder"}})],1)]),t("el-form-item",{attrs:{label:"时机选择："}},[t("el-select",{attrs:{placeholder:"请选择"},on:{click:e.changeTime},model:{value:e.CrmFrom.timeId,callback:function(t){e.$set(e.CrmFrom,"timeId",t)},expression:"CrmFrom.timeId"}},e._l(e.timeIdList,(function(e){return t("el-option",{key:e.enumKey,attrs:{label:e.enumValue,value:e.enumKey}})})),1)],1),t("el-form-item",{attrs:{label:"时机描述："}},[t("el-input",{attrs:{type:"textarea",maxlength:"240","show-word-limit":""},model:{value:e.CrmFrom.timeDistindes,callback:function(t){e.$set(e.CrmFrom,"timeDistindes",t)},expression:"CrmFrom.timeDistindes"}})],1),t("el-form-item",[t("el-button",{on:{click:e.SubInstall}},[e._v("保存当前设置")])],1)],1),!0===e.gHandIsShow?t("group-hand-dialog"):e._e()],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("180b");const s=o["a"].common.getSysEnum,m=o["a"].common.queryAdivInfo;var c={props:["channelId","channelData"],components:{GroupHandDialog:n["a"]},data(){return{CrmFrom:{adivId:null,material:null,proPrice:null,urlLink:null,priorityOrder:null,timeId:null,timeDistindes:null},CrmFromRules:{adivId:[{required:!0,message:"请选择运营位",trigger:"blur,change"}],material:[{required:!0,message:"请选择物料",trigger:"blur"}],urlLink:[{required:!0,message:"请输入URL链接",trigger:"blur"}]},timeIdList:[],adivList:[],gHandIsShow:!1}},mounted(){var e;this.CrmFrom=null!==(e=this.channelData)&&void 0!==e?e:this.CrmFrom,this.getOptionData()},methods:{getOptionData(){Object(l["i"])(m,{channelId:this.channelId}).then(e=>{this.adivList=e}),Object(l["i"])(s,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e})},changeAid(){this.adivList.forEach(e=>{(this.CrmFrom.adivId=e.adivId)&&(this.CrmFrom.adivName=e.adivName)})},changeTime(){this.timeIdList.forEach(e=>{e.enumKey===this.CrmFrom.timeId&&(this.CrmFrom.timeName=e.enumValue)})},preMaterial(){this.gHandIsShow=!this.gHandIsShow},preview(){this.$alert("没有可预览的材料",{confirmButtonText:"确定"})},SubInstall(){this.$refs.CrmFrom.validate(e=>{e&&this.$emit("saveChannelData",this.CrmFrom)})}}},u=c,d=a("2877"),h=Object(d["a"])(u,r,i,!1,null,"07b4c493",null);t["a"]=h.exports},e0bf:function(e,t,a){},e404:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"标准化素材：",prop:"columnExt20"}},[t("div",{staticClass:"select-material",on:{click:function(t){return e.selectMaterial(!0)}}},[e._v(e._s(e.CrmFrom.materialName||"请选择"))])])],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"任务类型：",prop:"columnExt4"}},[t("el-select",{attrs:{placeholder:"请选择任务类型"},on:{change:e.changeAlarm},model:{value:e.CrmFrom.columnExt4,callback:function(t){e.$set(e.CrmFrom,"columnExt4",t)},expression:"CrmFrom.columnExt4"}},e._l(e.alarmType,(function(e){return t("el-option",{key:e.typeCode,attrs:{label:e.typeName,value:e.typeCode}})})),1)],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"重点活动：",prop:"columnExt6"}},[t("el-select",{attrs:{placeholder:"是否为重点活动"},model:{value:e.CrmFrom.columnExt6,callback:function(t){e.$set(e.CrmFrom,"columnExt6",t)},expression:"CrmFrom.columnExt6"}},[t("el-option",{attrs:{label:"是",value:"1"}}),t("el-option",{attrs:{label:"否",value:"0"}})],1)],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"加入抢单：",prop:"columnExt7"}},[t("el-select",{attrs:{placeholder:"是否加入抢单"},model:{value:e.CrmFrom.columnExt7,callback:function(t){e.$set(e.CrmFrom,"columnExt7",t)},expression:"CrmFrom.columnExt7"}},[t("el-option",{attrs:{label:"是",value:"1"}}),t("el-option",{attrs:{label:"否",value:"0"}})],1)],1)],1),t("el-col",{attrs:{span:24}},[t("UseScript",{ref:"useScript",attrs:{"label-width":"145px","channel-id":e.channelNewData.channelId,"channel-name":e.channelNewData.channelName,"script-id":e.CrmFrom.columnExt19,CrmFrom:e.CrmFrom},on:{change:e.changeScript}})],1),e.showExt18?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级模型")])],1):e._e()],1)],1):e._e(),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"营销用语：",prop:"columnExt2"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"短信内容：",prop:"columnExt3"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.columnExt3,callback:function(t){e.$set(e.CrmFrom,"columnExt3",t)},expression:"CrmFrom.columnExt3"}})],1)],1)],1)],1),t("materialList",{ref:"material",attrs:{channelId:e.id},on:{addMaterial:e.addMaterial}})],1)},i=[],l=a("0fea"),o=a("5e05"),n=a("f1ce"),s=a("5ed5"),m=a("98d2"),c=a("b893"),u=a("00b8");o["a"].common.getSysEnum;const d=o["a"].common.queryAdivInfo,h=o["a"].common.getAlarmType;o["a"].common.queryHallInfo;var p={props:["channelNewData","id","deleteSub"],components:{materialList:n["a"],Tips:s["a"],UseScript:m["a"]},data(){return{CrmFrom:{adivInfo:{},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",standard:"",CustomerRules:"",marketingWords:"",columnExt2:"",columnExt3:"",columnExt4:"",columnExt20:"",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt18:"0",columnExt19:""},showExt18:!1,checkColumnExt18:!1,CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],columnExt2:[{required:!0,message:"请输入营销用语",trigger:"blur"}],columnExt4:[{required:!0,message:"请选择任务类型",trigger:"blur"}],columnExt6:[{required:!0,message:"请选择是否为重点活动",trigger:"blur"}],columnExt7:[{required:!0,message:"请选择是否加入抢单",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],alarmType:[]}},watch:{channelNewData:{handler(){this.CrmFrom=Object(c["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0},CrmFrom:{handler(e,t){},deep:!0},deleteSub(){}},mounted(){this.getOptionData(),this.CrmFrom=Object(c["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},getOptionData(){Object(l["i"])(d,{channelId:this.id}).then(e=>{this.adivList=e}),Object(l["i"])(h+"?pcode=GWLX").then(e=>{this.alarmType=e})},changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},selectMaterial(e){this.$refs["material"].showDialog(e)},addMaterial(e){this.CrmFrom={...this.CrmFrom,columnExt20:e.materialId,materialName:e.materialName}},changeAlarm(e){this.CrmFrom.columnExt5=this.alarmType.filter(t=>t.typeCode===e)[0].typeName},changeScript(e){this.CrmFrom.columnExt19=e.scriptId,this.CrmFrom=Object(u["a"])(e,this.CrmFrom),this.$forceUpdate()}},created(){}},C=p,v=(a("96d7"),a("2877")),f=Object(v["a"])(C,r,i,!1,null,"50b909cb",null);t["a"]=f.exports},ea45:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("el-dialog",{class:{"title-center":e.titleCenter},attrs:{title:e.title,visible:void 0===e.value?e.visible:e.value,width:e.width,top:e.top,"append-to-body":"","show-close":!1,"close-on-click-modal":!1,"destroy-on-close":e.destroyOnClose},on:{"update:visible":function(t){void 0===e.value?e.visible:e.value=t}}},[t("i",{staticClass:"el-icon-close",on:{click:e.close}}),e._t("default"),t("div",{style:{textAlign:e.footerPosition},attrs:{slot:"footer"},slot:"footer"},[e.showCancelButton?t("el-button",{on:{click:e.close}},[e._v(e._s(e.cancelButtonText))]):e._e(),e._t("footerBtn"),t("el-button",{attrs:{type:"primary",loading:e.confirmLoading},on:{click:e.confirm}},[e._v(e._s(e.confirmButtonText))])],2)],2)},i=[],l={model:{prop:"value",event:"change"},props:{value:{type:void 0|Boolean},visible:{type:void 0|Boolean},titleCenter:{type:Boolean,default:!1},title:{type:String,required:!0},width:{type:String,default:"50%"},top:{type:void 0|String,default:void 0},confirmLoading:{type:Boolean,default:!1},confirmButtonText:{type:String,default:"确 认"},cancelButtonText:{type:String,default:"取 消"},showCancelButton:{type:Boolean,default:!0},footerPosition:{type:String,default:"center"},destroyOnClose:{type:Boolean,default:!0}},methods:{close(){void 0===this.value?this.$emit("close"):this.$emit("change",!1)},confirm(){this.$emit("confirm")}}},o=l,n=(a("b62e"),a("2877")),s=Object(n["a"])(o,r,i,!1,null,"1be2cb38",null);t["a"]=s.exports},eae4:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("transition-group",{attrs:{name:"top-from"}},[e.fileInfo.uploadFileUrl||e.isView?t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:"2",staticClass:"file-container"},[e.isView?e._e():t("i",{staticClass:"el-icon-close",on:{click:e.removeFile}}),t("div",{staticClass:"file-info"},[t("el-row",[t("span",[e._v("名称：")]),t("span",{staticClass:"text"},[e._v(e._s(e.fileInfo.uploadFileName))])]),t("el-row",[t("span",[e._v("尺寸：")]),t("span",[e._v(e._s(e.fileInfo.fileSize))])])],1),t("div",{staticClass:"file-view"},["image"===e.type?t("el-image",{attrs:{src:e.fileInfo.fileSrc,"preview-src-list":[e.fileInfo.fileSrc],fit:"fill"}}):e._e()],1)]):t("div",{key:"1",staticClass:"script-upload"},[t("el-upload",{attrs:{action:"/",accept:e.typeInfo.accept,multiple:e.multiple,"show-file-list":!1,"before-upload":e.beforeUpload,"http-request":e.uploadFile}},[t("div",{staticClass:"upload-content"},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v("点击上传"+e._s(e.typeInfo.typeName))]),t("div",{staticClass:"el-upload__info"},[e._v(e._s(e.typeInfo.tip))])])]),e.showProgress?[t("el-progress",{staticClass:"upload-progress",attrs:{percentage:e.progress,"stroke-width":2,status:e.uploadStatus,"text-inside":""}}),t("span",[e._v(e._s(e.progress+"%"))])]:e._e()],2)])},i=[],l=(a("88a7"),a("271a"),a("5494"),a("0fea")),o=a("d39c"),n={model:{prop:"fileObj",event:"change"},props:{isView:{type:Boolean,default:!1},type:{type:String,validator(e){return-1!==["image","video","audio"].indexOf(e)},default:"image"},action:{type:String,default:"/mkt-term-svc/api/uploadScriptMaterial"},multiple:{type:Boolean,default:!1},fileObj:{type:Object,default:()=>{}}},computed:{typeInfo(){switch(this.type){case"image":return{accept:"image/*",typeName:"图片",size:10485760,tip:"文件大小不能超过10M，支持jpg、jpeg、png格式"};case"video":return{accept:"video/*",typeName:"视频",size:104857600,tip:"文件大小不能超过100M，支持mp4、avi、rmvb格式"};case"audio":return{accept:"audio/*",typeName:"音频",size:10485760,tip:"文件大小不能超过10M，支持mp3、wav格式"}}}},data(){return{loading:!1,fileInfo:{uploadFileName:"",uploadFileUrl:"",fileSrc:"",fileSize:""},showProgress:!1,progress:0,uploadStatus:null}},methods:{handleFile(e){if("image"===this.type){const t=new Image;t.src=window.URL.createObjectURL(e),t.onload=()=>{this.fileInfo.fileSize=`${t.width} × ${t.height}`,this.fileInfo.uploadFileName=e.name,this.fileInfo.fileSrc=window.URL.createObjectURL(e)}}if("video"===this.type||"audio"===this.type){this.fileInfo.uploadFileName=e.name,this.fileInfo.fileSrc=window.URL.createObjectURL(e);const t=document.createElement(this.type);t.preload="metadata",t.onloadedmetadata=()=>{window.URL.revokeObjectURL(t.src),this.fileInfo.fileSize=Math.floor(t.duration)+"s"}}},beforeUpload(e){if(e.size>this.typeInfo.size)return this.$message.error(`${this.typeInfo.typeName}大小不能超过${this.typeInfo.size/1024/1024}M, 请重新选择${this.typeInfo.typeName}`),!1;this.handleFile(e)},async uploadFile(e){try{this.showProgress=!0,this.progress=0,this.uploadStatus=null;const t=new FormData;t.append("file",e.file);const{resourceUrl:a}=await Object(l["j"])(this.action,t,this.uploadProgressEvent);this.fileInfo.uploadFileUrl=a;let r={...this.fileInfo};delete r.fileSrc,this.$emit("change",r),this.showProgress=!1,this.progress=0}catch(t){this.uploadStatus="exception",setTimeout(()=>{this.showProgress=!1},1e3)}},uploadProgressEvent(e){this.progress=Math.floor(100*e.loaded/e.total)},removeFile(){this.fileInfo.uploadFileUrl="",this.fileInfo.uploadFileName="",this.fileInfo.fileSrc="",this.fileInfo.fileSize="",this.$emit("change",this.fileInfo)},async setFileInfo(){try{this.loading=!0;const{data:e}=await Object(l["b"])(o["a"].seapi.downloadChanPromptFile,{fileUrlAndName:this.fileInfo.uploadFileUrl}),t=new Blob([e],{type:e.type});this.fileInfo.fileSrc=URL.createObjectURL(t);const a=new File([t],this.fileInfo.uploadFileName||this.fileInfo.uploadFileName||"",{type:e.type});this.handleFile(a)}catch(e){}finally{this.loading=!1}}},created(){this.fileInfo={...this.fileInfo,...this.fileObj},this.fileInfo.uploadFileUrl&&this.setFileInfo()}},s=n,m=(a("f9b4"),a("2877")),c=Object(m["a"])(s,r,i,!1,null,"73835c26",null);t["a"]=c.exports},eafd:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"切换类型：",prop:"type"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{"visible-change":e.savePreType},model:{value:e.CrmFrom.type,callback:function(t){e.$set(e.CrmFrom,"type",t)},expression:"CrmFrom.type"}},e._l(e.typeList,(function(a){return t("el-option",{key:a.value,attrs:{label:a.label,value:a.value},nativeOn:{click:function(t){return e.clickValidate.apply(null,arguments)}}})})),1)],1)],1),"1"===e.CrmFrom.type?[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"活动标题：",prop:"columnExt2"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{placeholder:"请输入活动标题"},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"活动链接：",prop:"columnExt3"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.columnExt3,callback:function(t){e.$set(e.CrmFrom,"columnExt3",t)},expression:"CrmFrom.columnExt3"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"活动图片：",prop:"columnExt4"}},[t("input",{ref:"uploadRef",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.getFile}}),t("el-button",{attrs:{type:"primary",loading:e.uploadLoading},on:{click:e.clickUploadBtn}},[e._v("点击上传")]),t("span",{staticClass:"upload-tip"},[e._v("图片尺寸 长 * 宽＝"),t("em",[e._v("1020(px)")]),e._v(" * "),t("em",[e._v("462(px)")]),e._v("，仅支持"),t("em",[e._v("JPG")]),e._v("格式，文件小于"),t("em",[e._v("1M")])]),e.imgUrl?t("el-image",{staticStyle:{width:"200px",height:"100px"},attrs:{src:e.imgUrl,"preview-src-list":[e.imgUrl]}}):e._e(),e.imgUrl?t("i",{staticClass:"el-icon-close",staticStyle:{color:"red"},on:{click:e.clearFile}}):e._e()],1)],1)]:"2"===e.CrmFrom.type?[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"活动标题：",prop:"columnExt5"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{placeholder:"请输入活动标题"},model:{value:e.CrmFrom.columnExt5,callback:function(t){e.$set(e.CrmFrom,"columnExt5",t)},expression:"CrmFrom.columnExt5"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"活动内容：",prop:"columnExt6"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"请输入活动内容"},model:{value:e.CrmFrom.columnExt6,callback:function(t){e.$set(e.CrmFrom,"columnExt6",t)},expression:"CrmFrom.columnExt6"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"活动链接：",prop:"columnExt7"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"请输入活动链接"},model:{value:e.CrmFrom.columnExt7,callback:function(t){e.$set(e.CrmFrom,"columnExt7",t)},expression:"CrmFrom.columnExt7"}})],1)],1)]:[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"活动标题：",prop:"columnExt8"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{placeholder:"请输入活动标题"},model:{value:e.CrmFrom.columnExt8,callback:function(t){e.$set(e.CrmFrom,"columnExt8",t)},expression:"CrmFrom.columnExt8"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"活动内容：",prop:"columnExt9"}},[t("el-input",{directives:[{name:"forbidChars",rawName:"v-forbidChars"}],attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"请输入活动内容"},model:{value:e.CrmFrom.columnExt9,callback:function(t){e.$set(e.CrmFrom,"columnExt9",t)},expression:"CrmFrom.columnExt9"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"活动链接：",prop:"columnExt10"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"请输入活动链接"},model:{value:e.CrmFrom.columnExt10,callback:function(t){e.$set(e.CrmFrom,"columnExt10",t)},expression:"CrmFrom.columnExt10"}})],1)],1)]],2)],1)],1)},i=[],l=(a("88a7"),a("271a"),a("5494"),a("0fea")),o=a("5e05"),n=(a("d39c"),a("5af3")),s=a("5ed5"),m=(a("0b16"),a("0557")),c=a("b893");o["a"].common.getSysEnum;const u=o["a"].common.queryAdivInfo;o["a"].common.queryHallInfo;var d={props:["channelNewData","id","deleteSub"],components:{Tips:s["a"]},data(){return{CrmFrom:{adivInfo:{},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",standard:"",CustomerRules:"",marketingWords:"",columnExt2:"",columnExt3:"",columnExt4:"",columnExt5:"",columnExt6:"",columnExt7:"",columnExt8:"",columnExt9:"",columnExt10:"",columnExt11:"",type:"1"},CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],columnExt2:[{required:!0,message:"请输入活动标题",trigger:"blur"}],columnExt3:[{required:!0,message:"请输入活动链接",trigger:"blur"}],columnExt5:[{required:!0,message:"请输入活动标题",trigger:"blur"}],columnExt6:[{required:!0,message:"请输入活动内容",trigger:"blur"}],columnExt4:[{required:!0,message:"请上传活动图片",trigger:"blur"}],columnExt7:[{required:!0,message:"请输入活动链接",trigger:"blur"}],columnExt8:[{required:!0,message:"请输入活动标题",trigger:"blur"}],columnExt9:[{required:!0,message:"请输入活动内容",trigger:"blur"}],columnExt10:[{required:!0,message:"请输入活动链接",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],typeList:[{label:"发现栏目",value:"1"},{label:"金币摇钱盒",value:"2"},{label:"消息推送",value:"3"}],preType:"",fileListIMG:[],imgUrl:"",uploadLoading:!1}},computed:{header(){return window.sessionStorage.getItem("IOP_TOKEN")},action(){return m["a"].commonConfig.baseURL+"/plan-svc/api/action/tactics/tacticsCreate/jx/fileUpload"}},watch:{channelNewData:{handler(){this.CrmFrom={...Object(c["d"])(this.channelNewData),type:"1",adivInfo:{adivId:this.id+"1"}},this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt11",this.CrmFrom.columnExt11||""),this.judgeType(this.CrmFrom)},deep:!0},deleteSub(){}},mounted(){this.getOptionData(),this.CrmFrom={...Object(c["d"])(this.channelNewData),type:"1",adivInfo:{adivId:this.id+"1"}},this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt11",this.CrmFrom.columnExt11||""),this.judgeType(this.CrmFrom)},methods:{judgeType(e){e.columnExt2?(this.CrmFrom.type="1",Object(n["d"])(this.CrmFrom.columnExt11).then(e=>{this.imgUrl=e})):e.columnExt5?this.CrmFrom.type="2":e.columnExt8?this.CrmFrom.type="3":this.CrmFrom.type="1"},async getOptionData(){await Object(l["i"])(u,{channelId:this.id}).then(e=>{this.adivList=e})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},clickUploadBtn(){this.$refs["uploadRef"].value=null,this.$refs["uploadRef"].click()},getFile({target:e}){let t=e.files[0],a=t.name.substring(t.name.lastIndexOf(".")+1);if("jpg"!==a)return this.$refs["uploadRef"].value=null,this.$message.error("图片格式不符合要求,请上传jpg格式图片"),!1;if(t.size>1048576)return this.$refs["uploadRef"].value=null,this.$message.error("图片大小不符合要求,请上传小于1M的图片"),!1;let r=new Image,i=URL.createObjectURL(t);r.src=i,r.onload=()=>{1020!=r.width||462!=r.height?(this.$refs["uploadRef"].value=null,this.$message.error("图片尺寸不符合要求,请上传1020*462的图片")):this.uploadPic(t,i)}},async uploadPic(e){this.uploadLoading=!0;try{let t=new FormData;t.append("file",e);const{fileName:a,url:r}=await Object(l["j"])(this.action,t);this.CrmFrom.columnExt4=a,this.CrmFrom.columnExt11=r,this.imgUrl=await Object(n["d"])(r)}catch(t){this.CrmFrom.columnExt4=null,this.CrmFrom.columnExt11=null}finally{this.uploadLoading=!1}},clearFile(){this.CrmFrom.columnExt4=null,this.CrmFrom.columnExt11=null,this.imgUrl=null},savePreType(e){e&&(this.preType=this.CrmFrom.type)},clickValidate(){if(this.preType!=this.CrmFrom.type){if("1"==this.preType){if(this.CrmFrom.columnExt2||this.CrmFrom.columnExt3||this.CrmFrom.columnExt4){let e=["columnExt2","columnExt3","columnExt4"];this.typeValidate(e)}}else if("2"==this.preType){if(this.CrmFrom.columnExt5||this.CrmFrom.columnExt6||this.CrmFrom.columnExt7){let e=["columnExt5","columnExt6","columnExt7"];this.typeValidate(e)}}else if("3"==this.preType&&(this.CrmFrom.columnExt8||this.CrmFrom.columnExt9||this.CrmFrom.columnExt10)){let e=["columnExt8","columnExt9","columnExt10"];this.typeValidate(e)}this.$refs.CrmFrom.clearValidate()}},typeValidate(e){for(let t=0;t<e.length;t++)if(!this.CrmFrom[e[t]])return this.CrmFrom.type=this.preType,this.$nextTick(()=>{this.$refs.CrmFrom.validate(()=>{}),this.$alert("切换类型前，请先填写必填项，或者清空选项数据！","提示",{confirmButtonText:"确定",callback:e=>{this.$refs.CrmFrom.clearValidate()}})})}},created(){}},h=d,p=(a("c87e"),a("2877")),C=Object(p["a"])(h,r,i,!1,null,"748ba195",null);t["a"]=C.exports},eb28:function(e,t,a){},ecb5:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%"}},[t("Tips",{attrs:{id:e.id},on:{getChannelDetail:e.getChannelDetail}}),t("el-form",{ref:"CrmFrom",staticStyle:{width:"100%"},attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1),t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAid},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),e.showMessage?t("el-form-item",{attrs:{label:"短信模板：",prop:"columnExt2"}},[t("div",{staticClass:"short-message"},e._l(e.radioGroup,(function(a){return t("div",{key:a.typeId,staticClass:"radio-group"},[t("span",[e._v(e._s(a.typeName)+"：")]),e._l(a.templateList,(function(a){return t("el-tooltip",{key:a.templateId,attrs:{placement:"top"}},[t("div",{staticClass:"tool-tip",attrs:{slot:"content"},slot:"content"},[e._v(e._s(a.templateContent))]),t("el-radio",{attrs:{label:a.templateId,border:"",size:"medium"},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}},[e._v(" "+e._s(a.templateId+" | "+a.templateName))])],1)}))],2)})),0)]):e._e(),e.showExt18?t("el-form-item",{attrs:{label:"智能话术："}},[t("el-checkbox",{on:{change:()=>e.CrmFrom.columnExt18=e.checkColumnExt18?"1":"0"},model:{value:e.checkColumnExt18,callback:function(t){e.checkColumnExt18=t},expression:"checkColumnExt18"}},[e._v("启用")]),e.checkColumnExt18?t("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt18,callback:function(t){e.$set(e.CrmFrom,"columnExt18",t)},expression:"CrmFrom.columnExt18"}},[t("el-radio",{attrs:{label:"1"}},[e._v("省端模型")]),t("el-radio",{attrs:{label:"2"}},[e._v("一级IOP模型")])],1):e._e()],1):e._e(),t("el-form-item",{attrs:{label:"推荐用语：",prop:"EXEC_CONTENT"}},[t("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":"",rows:8,placeholder:"您还可以输入300个字"},model:{value:e.CrmFrom.EXEC_CONTENT,callback:function(t){e.$set(e.CrmFrom,"EXEC_CONTENT",t)},expression:"CrmFrom.EXEC_CONTENT"}}),t("div",{staticClass:"button"},[t("div",{staticClass:"sub-otton",on:{click:function(t){return e.openDilog(!0)}}},[e._v("营销用语模板")]),t("div",{staticClass:"sub-otton",on:{click:function(t){return e.openDilog(!1)}}},[e._v("自定义短信用语")])])],1)],1),t("ShortMessageList",{ref:"messageList",attrs:{tableData:e.tableData,cols:e.cols,channelId:e.id},on:{addShortMessage:e.addShortMessage,getSmsContentTemplateList:e.getSmsContentTemplateList}})],1)},i=[],l=a("0fea"),o=a("5e05"),n=(a("0b16"),a("c3eb")),s=a("5ed5"),m=a("b893");const c=o["a"].common.getSysEnum,u=o["a"].common.queryAdivInfo,d=o["a"].common.queryHallInfo;var h={props:["channelNewData","id","deleteSub"],components:{ShortMessageList:n["a"],Tips:s["a"]},data(){return{CrmFrom:{adivInfo:{},channelId:"",channelName:"",attributionInfo:{},columnExt1:"1",standard:"",CustomerRules:"",marketingWords:"",EXEC_CONTENT:"",columnExt2:"",columnExt18:"0"},showExt18:!1,checkColumnExt18:!1,dialogVisible:!1,tableData:[],cols:[{label:"模板编号",props:"id"},{label:"模板内容",props:"content"}],CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],marketingWords:[{required:!0,message:"请输入营销话术",trigger:"blur"}],EXEC_CONTENT:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],columnExt2:[{required:!0,message:"请选择短信模板",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]},channelConf:{execContent:[{required:!0,message:"请输入推荐用语",trigger:"blur"}],smsContent:[{required:!0,message:"请输入短信用语",trigger:"blur"}]}},timeIdList:[],adivList:[],attributionList:[],templateId:"",radioGroup:[],showMessage:!1,sceneParams:{}}},watch:{channelNewData:{handler(){this.CrmFrom=Object(m["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0},deep:!0},CrmFrom:{handler(e,t){},deep:!0},deleteSub(){},async shortMessage(e){await Object(l["i"])(o["a"].common.getShortMessage,{channelId:this.id,adviId:e}).then(e=>{this.radioGroup=e,this.showMessage=!0})}},computed:{shortMessage(){return this.CrmFrom.adivInfo.adivId}},mounted(){this.getOptionData(),this.CrmFrom=Object(m["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.checkColumnExt18=this.CrmFrom.columnExt18>0},methods:{getChannelDetail(e){1==e.smartScript&&(this.showExt18=!0)},async getOptionData(){await Object(l["i"])(c,{enumType:"iop_time_id"}).then(e=>{this.timeIdList=e}),await Object(l["i"])(u,{channelId:this.id}).then(e=>{this.adivList=e}),await Object(l["i"])(d,{}).then(e=>{this.attributionList=e})},async changeAid(e){var t="";this.adivList.forEach(a=>{e===a.adivId&&(t=a.adivName)}),this.CrmFrom.adivInfo=Object.assign({},this.CrmFrom.adivInfo,{adivId:e,adivName:t})},SubInstall(){var e=!0;return this.$refs.CrmFrom.validate(t=>{t||("906"===this.id||"922"===this.id)&&this.CrmFrom.marketingWords&&this.CrmFrom.adivInfo.adivId?(this.$emit("saveChannelData",this.CrmFrom),e=!0):e=!1}),e},openDilog(e){this.$refs["messageList"].showDialog(e)},addShortMessage(e){this.CrmFrom={...this.CrmFrom,EXEC_CONTENT:e.row.content}},async getSmsContentTemplateList(e){await Object(l["i"])(o["a"].common.getSmsContentTemplateList,e).then(e=>{e.width=570,this.tableData=e})}},created(){}},p=h,C=(a("661d"),a("2877")),v=Object(C["a"])(p,r,i,!1,null,"16fdfa08",null);t["a"]=v.exports},f04e:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("el-form",{ref:"CrmFrom",attrs:{"label-width":"145px",model:e.CrmFrom,rules:e.CrmFromRules}},[t("Tips",{attrs:{id:e.id}}),t("el-form-item",{attrs:{label:"推送方式：",prop:"columnExt1"}},[t("el-radio-group",{model:{value:e.CrmFrom.columnExt1,callback:function(t){e.$set(e.CrmFrom,"columnExt1",t)},expression:"CrmFrom.columnExt1"}},[t("el-radio",{attrs:{label:"1",disabled:!e.CrmFrom.channelFlag}},[e._v("全量推送")]),t("el-radio",{attrs:{label:"0",disabled:!e.CrmFrom.channelFlag}},[e._v("偏好推送")])],1)],1),t("el-form-item",{attrs:{label:"运营位：",prop:"adivInfo.adivId"}},[t("el-select",{attrs:{placeholder:"请选择运营位"},on:{change:e.changeAdiv},model:{value:e.CrmFrom.adivInfo.adivId,callback:function(t){e.$set(e.CrmFrom.adivInfo,"adivId",t)},expression:"CrmFrom.adivInfo.adivId"}},e._l(e.adivList,(function(e){return t("el-option",{key:e.adivId,attrs:{label:e.adivName,value:e.adivId}})})),1)],1),t("el-form-item",{attrs:{label:"素材：",prop:"columnExt2"}},[t("el-select",{attrs:{disabled:!e.CrmFrom.adivInfo.adivId,filterable:"",placeholder:"请选择素材"},on:{change:e.changeMater},model:{value:e.CrmFrom.columnExt2,callback:function(t){e.$set(e.CrmFrom,"columnExt2",t)},expression:"CrmFrom.columnExt2"}},e._l(e.materList,(function(e){return t("el-option",{key:e.materialId,attrs:{label:e.materialName,value:e.materialId,disabled:e.disabled}})})),1),t("span",{staticStyle:{"margin-left":"10px",color:"#aaa"}},[e._v("目前仅支持图片素材")]),e.CrmFrom.columnExt2?t("div",{staticClass:"mater-desc"},[t("el-button",{attrs:{type:"text",size:"medium"},on:{click:e.onPreview}},[e._v("预览素材")]),t("span",[e._v("素材ID："+e._s(e.CrmFrom.columnExt2))])],1):e._e(),t("el-image",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"preview",attrs:{src:e.srcList[0],"preview-src-list":e.srcList}})],1),t("el-form-item",{attrs:{label:"链接：",prop:"columnExt6"}},[t("el-input",{attrs:{placeholder:"请输入链接地址"},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt6,callback:function(t){e.$set(e.CrmFrom,"columnExt6",t)},expression:"CrmFrom.columnExt6"}})],1),t("el-form-item",{attrs:{label:"描述：",prop:"columnExt5"}},[t("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入描述"},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.CrmFrom.columnExt5,callback:function(t){e.$set(e.CrmFrom,"columnExt5",t)},expression:"CrmFrom.columnExt5"}})],1)],1)},i=[],l=(a("14d9"),a("0fea")),o=a("5e05"),n=a("5af3"),s=a("b893"),m=a("f9ae"),c=a("5ed5"),u={props:["channelNewData","id"],components:{Tips:c["a"]},data(){return{CrmFrom:{adivInfo:{adivId:"",adivName:""},channelId:"",channelName:"",columnExt1:"1",columnExt2:"",columnExt3:"",columnExt4:"",columnExt5:"",columnExt6:""},CrmFromRules:{columnExt1:[{required:!0,message:"请选择推送方式",trigger:"blur"}],columnExt2:[{required:!0,message:"请选择素材",trigger:"blur"}],adivInfo:{adivId:[{required:!0,message:"请选择运营位",trigger:"change"}]}},adivList:[],materList:[],srcList:[]}},computed:{SceneNodeData(){return this.$store.state.MarkPl.SceneNodeData},materIdList(){if(!this.isWave)return[];const e=[];for(let r=0;r<this.SceneNodeData.length;r++)for(let i=0;i<this.SceneNodeData[r].length;i++){const l=this.SceneNodeData[r][i];var t,a;if("channelDialog"===l.assembly)if("968"===(null===(t=l.NodeObj[0])||void 0===t?void 0:t.channelId))(l.NodeObj[0].columnExt2||null!==(a=l.NodeObj[0].channelConf)&&void 0!==a&&null!==(a=a.channelExtConf)&&void 0!==a&&a.columnExt2)&&e.push(l.NodeObj[0].columnExt2||l.NodeObj[0].channelConf.channelExtConf.columnExt2)}return e},isWave(){return"3"==this.$store.state.MarkPl.ProcessData.example_type}},watch:{channelNewData:{handler(){var e;this.CrmFrom=Object(s["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt2",this.channelNewData.columnExt2||(null===(e=this.channelNewData.channelConf)||void 0===e||null===(e=e.channelExtConf)||void 0===e?void 0:e.columnExt2)||"")},deep:!0}},methods:{getAdivList(){Object(l["i"])(o["a"].common.queryAdivInfo,{channelId:this.id}).then(e=>{this.adivList=e})},disabledMater(e,t){if(this.isWave&&this.materIdList.length)for(const a of this.materIdList){const r=e.find(e=>e.materialId===a);r&&r.materialId!==t&&(r.disabled=!0)}return e},getMater(){Object(l["i"])(o["a"].common.getMater,{channelId:this.id,positionId:this.CrmFrom.adivInfo.adivId}).then(e=>{if(this.CrmFrom.columnExt2){const t={materialId:this.CrmFrom.columnExt2,materialName:this.CrmFrom.columnExt3,resourceUrl:this.CrmFrom.columnExt4,description:this.CrmFrom.columnExt5,targetUrl:this.CrmFrom.columnExt6};e.some(e=>e.materialId===t.materialId)||e.push(t)}this.materList=this.disabledMater(e,this.CrmFrom.columnExt2)})},changeAdiv(e){const t=this.adivList.find(t=>t.adivId===e);this.CrmFrom.adivInfo=t||{},this.CrmFrom.columnExt2="",this.CrmFrom.columnExt3="",this.CrmFrom.columnExt4="",this.getMater()},changeMater(e){this.srcList=[];const t=this.materList.find(t=>t.materialId===e);this.CrmFrom.columnExt3=t.materialName,this.CrmFrom.columnExt4=t.resourceUrl,this.CrmFrom.columnExt5=t.description,this.CrmFrom.columnExt6=t.targetUrl},async onPreview(){if(this.srcList.length)this.$refs.preview.clickHandler();else try{const e=await Object(n["d"])(this.CrmFrom.columnExt4);this.srcList=[e],this.$nextTick(()=>{this.$refs.preview.clickHandler()})}catch(e){}},SubInstall(){let e=!0;return this.$refs.CrmFrom.validate(t=>{if(t){if(this.CrmFrom.columnExt6&&!Object(m["e"])(this.CrmFrom.columnExt6))return setTimeout(()=>{this.$alert("链接格式不正确","提示",{confirmButtonText:"确定",customClass:"errorPrompt"})},200),e=!1,e;this.$emit("saveChannelData",this.CrmFrom),e=!0}else e=!1}),e}},created(){var e;this.getAdivList(),this.CrmFrom=Object(s["d"])(this.channelNewData),this.$set(this.CrmFrom,"columnExt1",this.channelNewData.columnExt1||"1"),this.$set(this.CrmFrom,"columnExt2",this.channelNewData.columnExt2||(null===(e=this.channelNewData.channelConf)||void 0===e||null===(e=e.channelExtConf)||void 0===e?void 0:e.columnExt2)||""),this.CrmFrom.adivInfo.adivId&&this.getMater()}},d=u,h=(a("c98a"),a("2877")),p=Object(h["a"])(d,r,i,!1,null,"330b0784",null);t["a"]=p.exports},f1ce:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"标准化素材",visible:e.dialogVisible,modal:!1,width:"760px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"search"},[t("el-form",{ref:"queryForm",staticStyle:{width:"100%"},attrs:{"label-width":"90px",model:e.queryForm}},[t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"创建人：",prop:"creator"}},[t("el-input",{attrs:{placeholder:"请输入创建人"},model:{value:e.queryForm.creator,callback:function(t){e.$set(e.queryForm,"creator",t)},expression:"queryForm.creator"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"素材名称：",prop:"materialName"}},[t("el-input",{attrs:{placeholder:"请输入素材名称"},model:{value:e.queryForm.materialName,callback:function(t){e.$set(e.queryForm,"materialName",t)},expression:"queryForm.materialName"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"素材类型：",prop:"materialName"}},[t("el-select",{attrs:{placeholder:"请选择类型",disabled:""},model:{value:e.queryForm.value,callback:function(t){e.$set(e.queryForm,"value",t)},expression:"queryForm.value"}},e._l(e.requirement,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("div",{staticClass:"bottpn"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getMaterialList()}}},[e._v("搜索")])],1)],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","highlight-current-row":""},on:{"row-click":e.singleElection}},[t("el-table-column",{attrs:{align:"center",width:"55",label:"选择",fixed:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-radio",{staticClass:"radio",attrs:{label:a.row.materialId},model:{value:e.templateSelection,callback:function(t){e.templateSelection=t},expression:"templateSelection"}},[e._v(" ")])]}}])}),t("el-table-column",{attrs:{prop:"materialName",label:"素材名称","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"materialType",label:"类型"}}),t("el-table-column",{attrs:{prop:"planName",label:"产品名称","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"planId",label:"产品编号"}}),t("el-table-column",{attrs:{prop:"targetUrl",label:"链接","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"creator",label:"创建人"}}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间","show-overflow-tooltip":!0}})],1),t("div",{staticClass:"pager"},[t("el-pagination",{attrs:{"current-page":e.queryForm.current,"page-size":e.queryForm.size,layout:"total, prev, pager, next, jumper",total:e.queryForm.total},on:{"current-change":e.handleCurrentChange}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)],1)},i=[],l=a("0fea"),o=a("5e05"),n={props:["channelId","adivId"],data(){return{dialogVisible:!1,tableData:[],templateSelection:"",checkList:[],queryForm:{creator:"",materialName:"",size:10,current:1,positionId:"",channelId:"",total:10,value:"1"},requirement:[{label:"文字",value:"1"}]}},mounted(){this.getMaterialList()},computed:{planId(){return this.$store.state.MarkPl.SceneNodeData[0][0].NodeObj.filter(e=>"product"===e.flag)[0].planId}},methods:{async getMaterialList(){const e={creator:this.queryForm.creator,materialName:this.queryForm.materialName,positionId:this.adivId,channelId:this.channelId,planId:this.planId,size:this.queryForm.size,current:this.queryForm.current};let t=await Object(l["i"])(o["a"].common.getMaterialList,e);this.queryForm={...this.queryForm,total:t.total},this.tableData=t.records.map(e=>("0"===e.materialType?e.materialType="图片":"0"===e.materialType?e.materialType="文字":e.materialType="视频",e))},showDialog(e){this.dialogVisible=e},singleElection(e){this.templateSelection=e.materialId,this.checkList=this.tableData.filter(t=>t.materialId===e.materialId),this.$emit("addMaterial",e)},handleCurrentChange(e){this.queryForm.current=e}}},s=n,m=(a("bc05"),a("2877")),c=Object(m["a"])(s,r,i,!1,null,"375d7c70",null);t["a"]=c.exports},f26a:function(e,t,a){e.exports=a.p+"img/word.6dc42442.png"},f3ba:function(e,t,a){"use strict";const r="/plan-svc/api/home/";t["a"]={home:{queryPlanCount:r+"queryPlanCount",querySaleSituation:r+"jx/querySaleSituation",tacticsOverallAll:"/plan-svc/tacticOverview",queryTacticsByUserId:"/plan-svc/api/home/jx/queryTacticsByUserId",queryGoodAcitive:r+"",queryIopTemplate:"/plan-svc/action/iop/excellentTemplateManager/queryIopTemplate",excellentRecomCamp:"/plan-svc/api/home/jx/excellentRecomCamp"}}},f7b7:function(e,t,a){},f9b4:function(e,t,a){"use strict";a("75c8")},fcff:function(e,t,a){e.exports=a.p+"img/excel.2485de68.png"},fd6d:function(e,t,a){}}]);