(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c4c2448"],{"31b1":function(e,t,a){"use strict";const i="/plan-svc/api/action",l="/plan-svc/action",n="/approve-svc/",s="/element-svc/";t["a"]={channel:{queryIopTemplate:i+"/tactics/tacticsCreate/queryIopTemplate",queryTopics:i+"/topic/queryTopics",getTemplateData:n+"jx/cmpApprovalProcessConf/getApproveConfig",getApproveConfig:n+"cmpApprovalProcessConf/getApproveConfig",getNextApprovers:n+"jx/cmpApproveProcessInstance/getNodeApprover",saveChannel:i+"/tactics/tacticsCreate/save",deleteCustom:i+"/custgroup/custGroupManager/deleteCustom",getMoreMyCustom:i+"/custgroup/custGroupManager/getMoreMyCustom",viewCustGroupDetail:i+"/custgroup/custGroupManager/viewCustGroupDetail",queryMmsTemplates:l+"/mmsTemplates/queryMmsTemplates",deleteMmsTemplateLists:l+"/mmsTemplates/createTactics/deleteMmsTemplateLists",updateMmsTemplate:l+"/mmsTemplates/updateMmsTemplate",smsContentBatchDel:i+"/smsTemplates/smsContentBatchDel",smsContentDel:i+"/smsTemplates/smsContentDel",smsContentEdit:i+"/smsTemplates/smsContentEdit",smsContentSaveOrUpdate:i+"/smsTemplates/smsContentSaveOrUpdate",smsTemplateOffline:i+"/smsTemplates/smsTemplateOffline",smsTemplates:i+"/smsTemplates/smsTemplates",smsTemplateSaveOrUpdate:i+"/smsTemplates/smsTemplateSaveOrUpdate",delPlanExclusivity:s+"mcd-plan-exclusivity/delPlanExclusivity",exportPlanExcluTemplate:s+"mcd-plan-exclusivity/exportPlanExcluTemplate",getPlanExclusivityInfo:s+"mcd-plan-exclusivity/getPlanExclusivityInfo",getPlanExclusivityList:s+"mcd-plan-exclusivity/getPlanExclusivityList",queryPlanDefList:s+"mcd-plan-exclusivity/queryPlanDefList",queryPlanExclusivity:s+"mcd-plan-exclusivity/queryPlanExclusivity",saveOrUpdatePlanExclusivity:s+"mcd-plan-exclusivity/saveOrUpdatePlanExclusivity",savePlanExclusivity:s+"mcd-plan-exclusivity/savePlanExclusivity",updatePlanExclusivity:s+"mcd-plan-exclusivity/updatePlanExclusivity",uploadPlanExcluFile:s+"mcd-plan-exclusivity/uploadPlanExcluFile",approveRecord:s+"api/mcdDimMaterialApprove/jx/approveRecord",getMaterialApprover:s+"api/mcdDimMaterialApprove/jx/getMaterialApprover",commitProcess:"/approve-svc/cmpApproveProcessInstance/commitProcess",subMaterialApprove:s+"api/mcdDimMaterialApprove/jx/subMaterialApprove",queryCommunicationUsers:"/plan-svc/api/channelMaterial/jx/queryCommunicationUsers",queryCommunicationTask:"/approve-svc/jx/cmpApproveProcessInstance/queryCommunicationTask",addCommunicationTask:"/approve-svc/jx/cmpApproveProcessInstance/addCommunicationTask",addCommunicationTaskBatch:"/approve-svc/jx/cmpApproveProcessInstance/addCommunicationTaskBatch",communicationAppTask:"/approve-svc/jx/cmpApproveProcessInstance/communicationAppTask",queryChannelExecInfo:"/plan-svc/mcd/camp/channelExec/queryChannelExecInfo",queryChannelExecList:"/plan-svc/mcd/camp/channelExec/queryChannelExecList",deleteChannelPrompt:"/plan-svc/mcd/chan/prompt/deleteChannelPrompt",queryChannelPrompt:"/plan-svc/mcd/chan/prompt/queryChannelPrompt",saveOrUpdateChannelPrompt:"/plan-svc/mcd/chan/prompt/saveOrUpdateChannelPrompt",uploaChanPromptFile:"/plan-svc/mcd/chan/prompt/uploaChanPromptFile",chanAndPlanMarketingHistory:"/plan-svc/mcd/marketing/history/chanAndPlanMarketingHistory",custContactNumMarketingHistory:"/plan-svc/mcd/marketing/history/custContactNumMarketingHistory",custSuccessRateMarketingHistory:"/plan-svc/mcd/marketing/history/custSuccessRateMarketingHistory",planMarketingHistory:"/plan-svc/mcd/marketing/history/planMarketingHistory",caculateContactUserNum:"/pec-timing/mcd/user/contact/caculateContactUserNum",caculateOrderUserNum:"/pec-timing/mcd/user/contact/caculateOrderUserNum",queryCampScene:"/plan-svc/api/action/tactics/tacticsCreate/jx/queryCampScene"}}},5310:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("el-select",{attrs:{multiple:"",size:e.size||void 0},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},e._l(e.sceneOptions,(function(a){return t("el-option-group",{key:a.label,attrs:{label:a.label}},e._l(a.data,(function(e){return t("el-option",{key:e.CAMP_BUSINESS_TYPE,attrs:{label:e.CAMP_BUSINESS_TYPE,value:e.CAMP_BUSINESS_TYPE,disabled:e.disabled}})})),1)})),1)},l=[],n=a("0fea"),s=a("31b1"),c={props:{baseForm:{type:Object,required:!0},size:{type:void 0|String,default:void 0},initialData:{type:Object,default:()=>({})}},data(){return{selected:[],sceneOptions:[{label:"存量",data:[]},{label:"产品",data:[]},{label:"其他",data:[]}],allSceneList:[]}},watch:{baseForm:{handler(e,t){var a;(null===e||void 0===e?void 0:e.campScene)!==(null===t||void 0===t?void 0:t.campScene)&&(this.selected=(null===(a=this.baseForm.campScene)||void 0===a?void 0:a.split(";"))||[],this.selected=this.selected.filter(e=>e))},deep:!0,immediate:!0},selected:{handler(e,t){if(0===this.allSceneList.length)return this.baseForm.campScene="",void this.$emit("change",this.baseForm.campScene);if(e.length===t.length)return;if(e.length<t.length){const a=t.find(t=>!e.includes(t)),i=this.allSceneList.find(e=>e.CAMP_BUSINESS_TYPE===a);return"其他"===i.type&&(this.allSceneList.forEach(e=>{e.disabled=!1}),this.$forceUpdate()),this.baseForm.campScene=this.selected.join(";"),void this.$emit("change",this.baseForm.campScene)}const a=e[e.length-1],i=this.allSceneList.find(e=>e.CAMP_BUSINESS_TYPE===a),l=this.selected.filter(e=>{const t=this.allSceneList.find(t=>t.CAMP_BUSINESS_TYPE===e);return t.type===i.type}),n=l.map(e=>this.allSceneList.find(t=>t.CAMP_BUSINESS_TYPE===e));switch(i.type){case"存量":if(l.length>1){const e=this.selected.filter(e=>{if(!l.includes(e))return!0;const t=n.find(t=>t.CAMP_BUSINESS_TYPE===e);return(null===t||void 0===t?void 0:t.CAMP_BUSINESS_TYPE)===a});this.selected=e}break;case"产品":if(l.length>1){const e=this.selected.filter(e=>{if(!l.includes(e))return!0;const t=n.find(t=>t.CAMP_BUSINESS_TYPE===e);return(null===t||void 0===t?void 0:t.CAMP_BUSINESS_TYPE)===a});this.selected=e}break;case"其他":this.selected.length>1&&(this.selected=[a]),this.allSceneList.forEach(e=>{"其他"!==e.type&&(e.disabled=!0)}),this.$forceUpdate();break}this.baseForm.campScene=this.selected.join(";"),this.$emit("change",this.baseForm.campScene)},deep:!0}},methods:{querySceneList(){Object(n["i"])(s["a"].channel.queryCampScene).then(e=>{this.sceneOptions.forEach(t=>{t.data=e[t.label]||[],t.data.forEach(e=>{e.type=t.label,e.disabled=!1}),this.allSceneList=this.allSceneList.concat(t.data)})})}},created(){0===Object.keys(this.initialData).length?this.querySceneList():this.sceneOptions.forEach(e=>{e.data=this.initialData[e.label]||[],e.data.forEach(t=>{t.type=e.label,t.disabled=!1}),this.allSceneList=this.allSceneList.concat(e.data)})}},r=c,o=a("2877"),p=Object(o["a"])(r,i,l,!1,null,"fa9c6be6",null);t["a"]=p.exports},"7a48":function(e,t,a){},9512:function(e,t,a){},"9a0e":function(e,t,a){"use strict";a("9512")},afd9:function(e,t,a){"use strict";t["a"]={search0:"/plan-svc/api/intellpushprism/column/search0",valuePage:"/plan-svc/api/intellpushprism/column/valuePage",getTargetUserCount:"/plan-svc/api/intellpushprism/column/getTargetUserCount",batchImportProduct:"/plan-svc/api/intellpushprism/batchImportProduct",batchImpPlanTmpDownload:"/plan-svc/api/intellpushprism/batchImpPlanTmpDownload",saveScene:"/plan-svc/api/intellpushprism/saveScene",batchImportCust:"/plan-svc/api/intellpushprism/batchImportCust",batchImpCustTmpDownload:"/plan-svc/api/intellpushprism/batchImpCustTmpDownload",batchImportLabel:"/plan-svc/api/intellpushprism/batchImportLabel",batchImpLabelTmpDownload:"/plan-svc/api/intellpushprism/batchImpLabelTmpDownload",queryScoreRangeBatch:"/plan-svc/api/intellpushprism/ai/queryScoreRangeBatch",downloadChanPromptFile:"/plan-svc/mcd/chan/prompt/downloadChanPromptFile",getInferenceResByAI:"/plan-svc/api/intellpushprism/ai/getInferenceResByAI",queryScoreRange:"/plan-svc/api/intellpushprism/ai/queryScoreRange",queryAICustLoseWeightRes:"/plan-svc/api/intellpushprism/ai/queryAICustLoseWeightRes",OperationWorkshop:{queryMyAttentionPlan:"/plan-svc/api/intellpushprism/ai/queryMyAttentionPlan",addMyAttentionPlan:"/plan-svc/api/intellpushprism/ai/addMyAttentionPlan",getCampEvalTop5ByPlan:"/plan-svc/api/intellpushprism/ai/getCampEvalTop5ByPlan",getAITagTop10ByPlan:"/plan-svc/api/intellpushprism/ai/getAITagTop10ByPlan",removeMyAttentionPlan:"/plan-svc/api/intellpushprism/ai/removeMyAttentionPlan"}}},b233:function(e,t,a){"use strict";a("7a48")},d39c:function(e,t,a){"use strict";const i="/element-svc/api",l="/preview-svc",n="/mcd-web/action";t["a"]={seapi:{querylistEnumValue:"/element-svc/mcd-plan-label/queryLabelByKey",loadImage:i+"/mcdDimMaterial/loadImage",queryTableList:"/element-svc/api/jx/mcdPlanDef/queryPlanDefPageList",saveStatus:i+"/mcdPlanDef/updatePlanDefStatus",queryDetail:"/element-svc/api/jx/mcdPlanDef/getPlanDetailById",mcdChannelList:i+"/mcdDimMaterial/queryChannel",mcdContList:i+"/mcdDimMaterial/queryContact",mcdPositList:i+"/mcdDimMaterial/queryPosition",getChannels:i+"/mcdDimChannel/pagelistDimChannel",queryContactByChannelId:i+"/iop/operatingPositionManager/queryContactByChannelId.do",queryPosition:i+"/iop/template/queryPosition",getOnlineChannels:i+"/mcdDimChannel/listDimChannel  ",getOnlineChannelsByUser:i+"/mcdDimChannel/jx/listDimChannel",getSysDics:"/plan-svc/action/iop/common/getSysDics",queryDigitalProductContents:i+"/iopDigitalProduct/queryDigitalProductPageList",queryConentDetailById:i+"/iopDigitalProduct/getDigitalProduct",updateDigitalProuctStatus:i+"/iopDigitalProduct/updateDigitalProductStatus",queryMaterialInfo:i+"/mcdDimMaterial/queryMaterialPageList",deleteMaterById:i+"/mcdDimMaterial/deleteMaterial",queryMaterialById:i+"/mcdDimMaterial/getMaterial",saveOrUpdateMaterial:i+"/mcdDimMaterial/saveOrUpdateMaterial",uploadMaterImg:i+"/mcdDimMaterial/uploadMaterialPicture",uploadMaterVideo:i+"/mcdDimMaterial/uploadMaterialVideo",uploadMaterFile:i+"/mcdDimMaterial/uploadMaterialsFile",queryIopContactList:i+"/jx/mcdDimContact/pagelistMcdDimContact",queryContactDetailById:i+"/jx/mcdDimContact/getDimContactDetail",listAllChannelName:i+"/mcdDimChannel/listAllChannelNameAndId",deleteContactById:i+"/mcdDimContact/removeContact",saveOrUpdateContact:i+"/jx/mcdDimContact/saveOrUpdateContact",validateContactName:i+"/mcdDimContact/getValidateContactName",displayChannelList:"/element-svc/api/mcdDimChannel/jx/pagelistDimChannel",validateChannelName:i+"/mcdDimChannel/getValidateChannelName",saveOrUpdateChannel:"/element-svc/api/mcdDimChannel/jx/saveOrUpdateDimChannel",deleteChannelById:i+"/mcdDimChannel/removeDimChannel",channelDetail:i+"/mcdDimChannel/getDimChannel",customerLike:"/preview-svc/jx/chnPre/queryPreData",channelDetail:"/element-svc/mcd-dim-channel-desc/query",uploaChanPromptFile:"/element-svc/api/mcdDimChannel/jx/uploaChanPromptFile",downloadChanPromptFile:"/plan-svc/mcd/chan/prompt/downloadChanPromptFile",queryDimChannelInfo:"/element-svc/api/mcdDimChannel/jx/queryDimChannelInfo",queryChannelEValData:"/groupmarket/enterprise/queryChannelEValData",queryIopOperatingPosition:i+"/mcdDimAdivInfo/pagelistAdivInfo",deleteOperatingPositionById:i+"/mcdDimAdivInfo/removeAdivInfo",queryOperPositionDetail:i+"/mcdDimAdivInfo/getAdivInfo",queryOpelistData:i+"/mcdDimAdivInfo/listChannelInfoAndContactInfo",queryCampsegInfoWithThisPosId:i+"/mcdDimAdivInfo/listpageCampsegInfoWithThisAdivId",getConfigList:i+"/mcdDimAttrConf/queryConfigList",validateOperationName:i+"/mcdDimAdivInfo/getValidateAdivInfoName",getValidateAdivInfoId:i+"/jx/mcdDimAdivInfo/getValidateAdivInfoId",saveOrUpdateOperPosition:i+"/mcdDimAdivInfo/saveOrUpdateAdivInfo",getChannelScheduleList:n+"/channelview/getChannelScheduleList",querySensitiveCust:l+"/mcd-channel-sensitive-cust-conf/querySensitiveCust",saveSensitiveCust:l+"/mcd-channel-sensitive-cust-conf/saveSensitiveCust",deleteSensitiveCust:l+"/mcd-channel-sensitive-cust-conf/deleteSensitiveCust",batchDeleteSensitiveCust:l+"/mcd-channel-sensitive-cust-conf/batchDeleteSensitiveCust",pagelistApproveMaterial:i+"/mcdDimMaterialApprove/pagelistApproveMaterial",approveRecord:i+"/mcdDimMaterialApprove/approveRecord",pagelistMyMaterial:i+"/mcdDimMaterialTemplate/pagelistMyMaterial",pagelistExcellentMaterial:i+"/mcdDimMaterialTemplate/pagelistExcellentMaterial",pagelistHotSpotMaterial:i+"/mcdDimMaterialTemplate/pagelistHotSpotMaterial",updateMaterialStatus:i+"/mcdDimMaterial/updateMaterialStatus",getMaterialApprover:i+"/mcdDimMaterialApprove/getMaterialApprover",getCmpApprovalProcess:i+"/mcdDimMaterialApprove/getCmpApprovalProcess",subMaterialApprove:i+"/mcdDimMaterialApprove/subMaterialApprove",addExcellentMaterialLibrary:i+"/mcdDimMaterialTemplate/addExcellentMaterialLibrary",removeExcellentMaterialLibrary:i+"/mcdDimMaterialTemplate/removeExcellentMaterialLibrary",createExcellentMaterial:i+"/mcdDimMaterialTemplate/createExcellentMaterial",createHotSpotMaterial:i+"/mcdDimMaterialTemplate/createHotSpotMaterial",removeMyMaterial:i+"/mcdDimMaterialTemplate/removeMyMaterial",getIntell:i+"/mcdDimMaterial/getIntelligentMatchingMaterialList"}}},db27:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"scene-table"},[t("el-table",{ref:"multipleTable",attrs:{border:"","row-key":"channelNodeId",data:e.sceneList},on:{"selection-change":e.onSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"center",width:"45"}}),e._l(e.columnList,(function(a){return t("el-table-column",{key:a.prop,attrs:{prop:a.prop,label:a.label,"header-align":"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t[a.prop]||"-")+" ")]}}],null,!0)})}))],2)],1)},l=[],n=(a("14d9"),a("3623")),s=a("2ef0"),c={data(){return{channelLines:[],sceneList:[],columnList:new Array(n["c"]).fill(null).map((e,t)=>({label:0===t?"主场景":n["b"][t]+"级子场景",prop:0===t?"mainScene":"subScene"+t})),selectedList:[]}},methods:{getChannelLine(){const e=$graph.findAll("node",e=>"Channel"===e.getModel().type),t=e.map(e=>e.getModel()),a=[];t.forEach(e=>{const{nodeLines:t}=e,i=t.filter(e=>"Root"!==e.nodeType),l={},n=[];i.forEach((e,t)=>{const a=$graph.findDataById(e.nodeId);if(n.push(a),l["channelNodeId"]=a.id,"Scene"===a.type){const e=0===t?"mainScene":"subScene"+t;l[e]=a.businessData.sceneName,l["lastScene"]=a.businessData}}),a.push(n),this.sceneList.push(l)}),this.channelLines=Object(s["cloneDeep"])(a),this.$emit("getChannelLines",this.channelLines)},onSelectionChange(e){this.selectedList=e,this.$emit("changeSelection",e)},selectAll(){this.$refs.multipleTable.toggleAllSelection(),this.selectedList=this.sceneList,this.$emit("changeSelection",this.selectedList)}},created(){this.getChannelLine()},mounted(){this.selectAll()}},r=c,o=(a("9a0e"),a("2877")),p=Object(o["a"])(r,i,l,!1,null,"7299b5fa",null);t["a"]=p.exports},ddd1:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"submit-preview-layout"},[t("header",{staticClass:"title"},[e._v("提交预览")]),t("main",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.channelLoading,expression:"channelLoading"}],attrs:{border:"",data:e.tableData,height:"100%"}},[t("el-table-column",{attrs:{"class-name":"required-column",label:"策略名称",align:"center",width:"200",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-input",{attrs:{size:"mini"},on:{blur:function(t){return e.validateField(a,"campsegName","策略名称")}},model:{value:a.campsegName,callback:function(t){e.$set(a,"campsegName",t)},expression:"row.campsegName"}})]}}])}),t("el-table-column",{attrs:{"class-name":"required-column",label:"投放周期",align:"center",width:"230"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{size:"mini",type:"daterange","value-format":"yyyy-MM-dd",format:"yyyy-MM-dd","range-separator":"至","picker-options":e.pickerOptions,clearable:!1},on:{change:function(t){return e.changeDate(t,e.$index,a)}},model:{value:a.dateList,callback:function(t){e.$set(a,"dateList",t)},expression:"row.dateList"}})]}}])}),t("el-table-column",{attrs:{"class-name":"required-column",label:"执行周期",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[a.isCoc?t("el-select",{attrs:{size:"mini",disabled:"",placeholder:"请选择"},model:{value:a.cocUpdateCycle,callback:function(t){e.$set(a,"cocUpdateCycle",t)},expression:"row.cocUpdateCycle"}},e._l(e.dnaUpdateCycleList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):t("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:a.dnaUpdateCycle,callback:function(t){e.$set(a,"dnaUpdateCycle",t)},expression:"row.dnaUpdateCycle"}},e._l(e.dnaUpdateCycleList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}])}),t("el-table-column",{attrs:{"class-name":"required-column",label:"策略类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-select",{attrs:{size:"mini",placeholder:"请选择策略类型"},model:{value:a.campsegTypeId,callback:function(t){e.$set(a,"campsegTypeId",t)},expression:"row.campsegTypeId"}},e._l(e.campsegTypeList,(function(e){return t("el-option",{key:e.enumKey,attrs:{label:e.enumValue,value:e.enumKey}})})),1)]}}])}),t("el-table-column",{attrs:{"class-name":"required-column",label:"策略描述",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-input",{attrs:{size:"mini"},on:{blur:function(t){return e.validateField(a,"campsegDesc","策略描述")}},model:{value:a.campsegDesc,callback:function(t){e.$set(a,"campsegDesc",t)},expression:"row.campsegDesc"}})]}}])}),t("el-table-column",{attrs:{label:"专题",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:a.topicId,callback:function(t){e.$set(a,"topicId",t)},expression:"row.topicId"}},e._l(e.topicList,(function(e){return t("el-option",{key:e.enumValue,attrs:{label:e.enumName,value:e.enumValue}})})),1)]}}])}),t("el-table-column",{attrs:{"class-name":"required-column",label:"场景",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("SceneSelect",{attrs:{size:"mini",initialData:e.campSceneData||{},baseForm:a},on:{change:function(t){return e.validateField(a,"campScene","场景")}}})]}}])}),t("el-table-column",{attrs:{label:"营销模板",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:a.activityTemplateId,callback:function(t){e.$set(a,"activityTemplateId",t)},expression:"row.activityTemplateId"}},e._l(e.activityTemplateList,(function(e){return t("el-option",{key:e.ACTIVITY_TEMPLATE_ID,attrs:{label:e.ACTIVITY_NAME,value:e.ACTIVITY_TEMPLATE_ID}})})),1)]}}])}),t("el-table-column",{attrs:{"class-name":"required-column",label:"活动类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:a.activityType,callback:function(t){e.$set(a,"activityType",t)},expression:"row.activityType"}},e._l(e.activityTypeList,(function(e){return t("el-option",{key:e.enumValue,attrs:{label:e.enumValue,value:e.enumKey}})})),1)]}}])}),t("el-table-column",{attrs:{"class-name":"required-column",label:"活动目的",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:a.activityObjective,callback:function(t){e.$set(a,"activityObjective",t)},expression:"row.activityObjective"}},e._l(e.activityObjectiveList,(function(e){return t("el-option",{key:e.enumValue,attrs:{label:e.enumValue,value:e.enumKey}})})),1)]}}])}),0==e.isSubmit?t("el-table-column",{attrs:{"class-name":"required-column",label:"策略预演",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:a.previewCamp,callback:function(t){e.$set(a,"previewCamp",t)},expression:"row.previewCamp"}},e._l(e.previewCampList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}],null,!1,4079622364)}):e._e(),t("el-table-column",{attrs:{label:"敏感客户群",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("el-select",{attrs:{size:"mini",placeholder:"请选择",multiple:"","collapse-tags":"",filterable:"",clearable:""},on:{change:function(t){return e.changeSensitiveCust(t,a)}},model:{value:a.sensitiveCustIdList,callback:function(t){e.$set(a,"sensitiveCustIdList",t)},expression:"row.sensitiveCustIdList"}},e._l(e.sensitiveCustList,(function(e){return t("el-option",{key:e.enumValue,attrs:{label:e.enumName,value:e.enumValue}})})),1)]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function({row:a,$index:i}){return[t("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"mini",disabled:1===e.tableData.length},on:{click:function(t){return e.remove(i)}}},[e._v("移除")])]}}])})],1)],1),t("footer",[t("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.$emit("cancel")}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",size:"medium",loading:e.loading},on:{click:function(t){return e.submit(0)}}},[e._v("提交")]),t("el-button",{attrs:{type:"primary",size:"medium",loading:e.loading2},on:{click:function(t){return e.submit(1)}}},[e._v("提交并保存为模板")])],1)])},l=[],n=(a("14d9"),a("0fea")),s=a("afd9"),c=a("d39c"),r=a("2ef0"),o=a("bdad"),p=a("db27"),m=a("5310"),u={components:{SceneList:p["a"],SceneSelect:m["a"]},props:{isSubmit:{type:Number,default:0},submitCacheData:{type:Object,default:()=>({})}},data(){return{loading:!1,loading2:!1,cacheData:null,tableData:[],pickerOptions:{disabledDate(e){return e.getTime()<Date.now()-864e5}},validateFieldFlag:new Map,channelLoading:!1,channelDetailList:[],campsegTypeList:[],dnaUpdateCycleList:[{label:"一次性",value:1},{label:"日周期",value:3},{label:"月周期",value:2}],topicList:[],campSceneList:[],campSceneData:{},activityTypeList:[],activityObjectiveList:[],activityTemplateList:[],sensitiveCustList:[],sensitiveCustIdList:[],previewCampList:[{value:"1",label:"预演"},{value:"2",label:"批量预演"},{value:"0",label:"不预演"}]}},methods:{getCacheData(){this.cacheData=this.submitCacheData,this.tableData=this.submitCacheData.params.campInfo.map((e,t)=>e.baseCampInfo),this.campsegTypeList=this.submitCacheData.campsegTypeList,this.topicList=this.submitCacheData.topicList,this.campSceneData=this.submitCacheData.campSceneData,this.activityTypeList=this.submitCacheData.activityTypeList,this.activityObjectiveList=this.submitCacheData.activityObjectiveList,this.activityTemplateList=this.submitCacheData.activityTemplateList,this.sensitiveCustList=this.submitCacheData.sensitiveCustList},async getChannelDetailList(){let e=this.submitCacheData.allChannelList.map(e=>e.channelId);e=[...new Set(e)];try{if(this.channelLoading=!0,0!=this.isSubmit)return;let t=e.map(e=>Object(n["i"])(c["a"].seapi.queryDimChannelInfo,{channelId:e})),a=await Promise.all(t);this.channelDetailList=a}catch(t){}finally{this.channelLoading=!1,this.getCacheData()}},validateField(e,t,a){let i=this.validateFieldFlag.get(e)||{};if(""===e[t])return i={...i,[t]:!1},this.validateFieldFlag.set(e,i),void this.$message.error(a+"不能为空！");i={...i,[t]:!0},this.validateFieldFlag.set(e,i)},changeDate(e,t,a){const i=this.cacheData.params.campInfo[t].campInfo.map(e=>{const t=e.product[0].planEndDate;return t?new Date(t).getTime():null}).filter(e=>e),l=Math.min(...i);new Date(e[1])>l&&this.$message.error("活动结束日期大于产品失效日期，请修改活动结束日期"),a.startDate=e[0]+" 00:00:00",a.endDate=e[1]+" 23:59:59"},changeSensitiveCust(e,t){e.length>0?t.sensitiveCustIds=e.join(","):t.sensitiveCustIds=""},previewValidate(e,t){if(t.previewFlag=!0,0!=this.isSubmit)return void(t.previewCamp="");const a=this.cacheData.params.campInfo[e].campSchemes[0].channels;let i=a;if(this.channelDetailList.length>0&&(i=this.channelDetailList.filter(e=>a.some(t=>t.channelId==e.channelId))),a.some(e=>"933"===e.channelId)){t.campsegName.length>50&&(t.campsegName=t.campsegName.slice(0,50),this.$message({message:`第 ${e+1} 列策略包含企业微信渠道，策略名称不得超过50个字！`,type:"error",duration:4e3}));const i=a.find(e=>"933"===e.channelId)||{};"9330102"===i.adivInfo.adivId&&t.campsegName.length>20&&(t.campsegName=t.campsegName.slice(0,20),this.$message({message:`第 ${e+1} 列策略包含星火推荐营销运营位，策略名称不能超过20个字！`,type:"error",duration:4e3}))}if(1==i.length&&"957"==[0].channelId){var l,n;let e=null===(l=this.activityTypeList.find(e=>e.enumKey==t.activityType))||void 0===l?void 0:l.enumValue,a=null===(n=this.activityObjectiveList.find(e=>e.enumKey==t.activityObjective))||void 0===n?void 0:n.enumValue;return"非营销类"==e&&"非营销类"==a||"9"==t.activityType&&"8"==t.activityObjective?void(t.previewFlag=!0):(t.previewFlag=!1,void(t.previewCamp="1"))}const s=["802","811"];return i.every(e=>s.includes(e.channelId))&&"1"==t.campsegTypeId||i.some(e=>3==e.previewStatus)?(t.previewFlag=!1,void(t.previewCamp="1")):i.some(e=>s.includes(e.channelId))?"1"==t.campsegTypeId?(t.previewFlag=!1,void(t.previewCamp="1")):void(t.previewFlag=!0):i.every(e=>2==e.previewStatus)?(t.previewFlag=!1,void(t.previewCamp="0")):void 0},remove(e){this.tableData.splice(e,1),this.cacheData.params.campInfo.splice(e,1),this.cacheData.params.sceneBaseInfo.splice(e,1),this.validateFieldFlag.delete(this.tableData[e])},submit(e){const t=this.validateFieldFlag.values();for(let l of t)if(Object.values(l).some(e=>!e))return void this.$message.error("请填写必填字段");this.cacheData.params.campInfo=this.tableData.map((e,t)=>({...this.cacheData.params.campInfo[t],baseCampInfo:e}));let a=Object(r["cloneDeep"])($graph.save());if("0"===this.$route.query.type){const e=this.tableData.map(e=>e.lastSceneId);a=Object(o["a"])(e,a)}const i={...this.cacheData.params,isCreateTemplate:e,themeBaseInfo:{...this.cacheData.params.themeBaseInfo,themeContent:JSON.stringify(a)}};e?this.loading2=!0:this.loading=!0,Object(n["i"])(s["a"].saveScene,i,void 0,6e4).then(t=>{let a=e?"提交并保存为模板":"保存";(null===t||void 0===t?void 0:t.length)>0?(this.$message.success(a+"成功"),this.$alert(a+"成功","提示",{confirmButtonText:"确定",type:"success",callback:e=>{this.$router.push({name:"MarketingMP",params:{tab:5}})}})):this.$message.error(a+"失败")}).catch(e=>{}).finally(()=>{this.loading=!1,this.loading2=!1})}},created(){this.getCacheData()}},d=u,h=(a("b233"),a("2877")),v=Object(h["a"])(d,i,l,!1,null,"2166b844",null);t["default"]=v.exports}}]);