(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-658785f2"],{"61b5":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"chat"},[e("div",{ref:"dialogRef",staticClass:"dialog-content"},t._l(t.dialog.dialogs,(function(s,i){return e("div",{key:s.content+i,staticClass:"dialog-item",class:{left:"AI"===s.role,right:"USER"===s.role,disabled:!!s.disabled}},[e("el-avatar",{attrs:{size:50,src:"https://img.yzcdn.cn/vant/cat.jpeg"}}),e("div",{staticClass:"dialog-item-content"},[e("div",{staticClass:"content-text"},[t._v(t._s(s.content))]),s.selectOptions||s.analysis?e("div",{staticClass:"component"},[e("Select",{attrs:{multiple:"multiple"===s.selectType,list:s.selectOptions,page:s.page},on:{change:t.selectItem,"load-more":function(e){return t.loadMore(i)}}})],1):t._e(),s.tip?e("div",{staticClass:"tip"},[e("p",[t._v("tips：")]),t._l(s.tip.split("|"),(function(s){return e("p",{key:s},[t._v(t._s(s))])}))],2):t._e(),s.confirm?e("div",{staticClass:"confirm"},[e("span",{staticClass:"confirm-btn",on:{click:t.confirm}},[t._v(t._s(s.confirmText||"确认，进入下一步"))])]):t._e()])],1)})),0),e("div",{staticClass:"dialog-footer"},[e("DialogSend",{on:{sendSubmit:t.send}})],1)])},o=[],a=(s("14d9"),s("bc3a")),n=s("0fea"),l=s("d370");const r=(t,e)=>{let s=a["CancelToken"].source(),i=Object(n["i"])(t,e,s.token,5e3);return{promise:i,source:s}};function c(t,e=1){const{promise:s,source:i}=r(l["a"].mpapi.queryTableList,{keyWords:t,current:e,isSupportAi:1,size:5}),o=t=>t&&t.records?t.records.map(t=>({...t,label:t.planName,key:t.planId})):[];return{promise:s,source:i,handle:o}}function d(t,e=1){const{promise:s,source:i}=r(l["a"].mpapi.getMoreMyCustomNew,{keyWords:t,current:e,outCallUse:0,size:5}),o=t=>t&&t.records?t.records.map(t=>({...t,label:t.customGroupName,key:t.customGroupId})):[];return{promise:s,source:i,handle:o}}var u={props:{dialog:{type:Object,default:()=>({})}},components:{DialogSend:()=>s.e("chunk-731d155e").then(s.bind(null,"bc67")),Select:()=>s.e("chunk-1d6e3168").then(s.bind(null,"fe43"))},data(){return{searchLoading:!1,request:null}},methods:{async requestByType(t){this.searchLoading&&this.request.source.cancel();const{key:e,selectType:s}=this.dialog.currentOption;switch(e){case"product":this.request=c(t);break;case"customer":this.request=d(t);break;default:this.request=null;break}if(!this.request)return;const{promise:i,handle:o}=this.request;try{this.searchLoading=!0;const e=await i;this.searchLoading=!1;const a=o(e);a.length?this.dialog.response(`根据“${t}”为您匹配到以下${a.length}个结果：`,{tip:`1、支持${"single"==s?"单选":"多选"}，点击选中，再次点击取消选择；|\n\t\t\t\t\t\t\t\t\t2、如未匹配到符合您要求的结果，可继续输入关键字匹配。`,selectOptions:a,page:{keywords:t,total:e.total,current:1,loading:!1}}):this.dialog.response("未查询到相关数据")}catch(a){this.searchLoading=!1,this.dialog.response("未查询到相关数据")}finally{for(let t=0;t<this.dialog.dialogs.length;t++)"loading"===this.dialog.dialogs[t].type&&(this.dialog.dialogs.splice(t,1),t--)}},async loadMore(t){const{page:e}=this.dialog.dialogs[t];if(e.loading)return;this.$set(e,"loading",!0);const{key:s}=this.dialog.currentOption;switch(s){case"product":this.request=c(e.keywords,e.current+1);break;case"customer":this.request=d(e.keywords,e.current+1);break;default:this.request=null;break}if(!this.request)return;const{promise:i,handle:o}=this.request;try{const s=await i;e.current++;const a=o(s);a.length&&this.dialog.dialogs[t].selectOptions.push(...a)}catch(a){}finally{this.$set(e,"loading",!1)}},selectItem(t){let e="";e=t.length?"已选择 "+t.map(t=>t.label).join("；"):"未选择任何选项",this.dialog.select(e,t),this.$forceUpdate(),this.scrollToBottom()},confirm(){const t=this.dialog.currentOption.next;t&&(this.dialog.next(),this.scrollToBottom())},send(t){this.dialog.ask(t),this.dialog.response("计算中，请稍等...",{type:"loading",tip:null}),this.requestByType(t),this.scrollToBottom()},scrollToBottom(){this.$nextTick(()=>{this.$refs.dialogRef.scrollTop=this.$refs.dialogRef.scrollHeight})}}},h=u,p=(s("7b3a"),s("2877")),g=Object(p["a"])(h,i,o,!1,null,"0e7d4e38",null);e["default"]=g.exports},"7b3a":function(t,e,s){"use strict";s("85e8")},"85e8":function(t,e,s){}}]);