(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6bdac1d5"],{3800:function(e,a,t){},"394c":function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e._self._c;return a("div",{staticClass:"template-wrap-content"},[a("div",{staticClass:"bg"},[a("div",{staticClass:"top-edit-part"},[a("div",{staticClass:"search-input"},[a("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],attrs:{placeholder:"请输入事件编码/名称"},model:{value:e.searchParams.keyWords,callback:function(a){e.$set(e.searchParams,"keyWords","string"===typeof a?a.trim():a)},expression:"searchParams.keyWords"}},[a("i",{staticClass:"el-input__icon el-icon-search cursor-pointer",attrs:{slot:"suffix"},on:{click:e.searchTable},slot:"suffix"})])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tTable",staticClass:"template-table customTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",height:600}},[a("el-table-column",{attrs:{type:"index",label:"序号","header-align":"center",align:"center",width:"45"}}),a("el-table-column",{attrs:{prop:"eventId",label:"事件编码","header-align":"center",align:"center"}}),a("el-table-column",{attrs:{prop:"eventName",label:"事件名称","header-align":"center",align:"center"}}),a("el-table-column",{attrs:{prop:"firstClassName",label:"一级分类","header-align":"center",align:"center"}}),a("el-table-column",{attrs:{prop:"secondClassName",label:"二级分类","header-align":"center",align:"center"}}),a("el-table-column",{attrs:{prop:"createUserName",label:"创建人","header-align":"center",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间","header-align":"center",align:"center",width:"132"}}),a("el-table-column",{attrs:{prop:"callingNum",label:"操作","header-align":"center",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.openDialog(t.row)}}},[e._v("共享")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.query.current,"page-sizes":[10,20,30,40],"page-size":e.query.size,"pager-count":5,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e.dialogVisible?a("EditDialog",{attrs:{id:e.currentRow.eventId,dialogVisible:e.dialogVisible},on:{"update:dialogVisible":function(a){e.dialogVisible=a},"update:dialog-visible":function(a){e.dialogVisible=a},refresh:e.searchTable}}):e._e()],1)])},s=[],i=t("0fea"),o=t("72ae"),n=function(){var e=this,a=e._self._c;return a("el-dialog",{attrs:{width:"50%",title:e.dialogTitle,visible:e.dialogVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(a){e.dialogVisible=a}}},[a("el-form",{ref:"ruleForm",class:{forbidden:!e.isEdit},attrs:{model:e.form,rules:e.rules,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"共享人类型：",prop:"shareType"}},[a("el-select",{attrs:{placeholder:"请选择共享人类型"},on:{change:function(a){e.form.shareId=""}},model:{value:e.form.shareType,callback:function(a){e.$set(e.form,"shareType",a)},expression:"form.shareType"}},[a("el-option",{attrs:{value:1,label:"角色"}}),a("el-option",{attrs:{value:2,label:"人员"}})],1)],1),a("el-form-item",{attrs:{label:"共享人：",prop:"shareId"}},[1===e.form.shareType?a("el-select",{attrs:{placeholder:"请选择共享角色",filterable:"",disabled:!e.form.shareType},on:{change:e.pushList},model:{value:e.form.shareId,callback:function(a){e.$set(e.form,"shareId",a)},expression:"form.shareId"}},e._l(e.roleList,(function(t){return a("el-option",{key:t.roleId,attrs:{value:t.roleId,label:t.roleName,disabled:e.shareList.some(e=>e.shareId===t.roleId)}})})),1):a("el-select",{attrs:{placeholder:"请选择共享人",filterable:"",disabled:!e.form.shareType},on:{change:e.pushList},model:{value:e.form.shareId,callback:function(a){e.$set(e.form,"shareId",a)},expression:"form.shareId"}},e._l(e.personList,(function(t){return a("el-option",{key:t.userId,attrs:{value:t.userId,label:t.userName,disabled:e.shareList.some(e=>e.shareId===t.userId)}})})),1)],1)],1),a("hr"),a("div",{staticClass:"list-content"},[a("label",[e._v("已共享角色：")]),a("div",e._l(e.SharedRoleList,(function(t){return a("el-tag",{key:t.shareId,attrs:{closable:"",size:"medium",type:"primary",effect:"dark"},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t.shareName)+" ")])})),1)]),a("div",{staticClass:"list-content"},[a("label",[e._v("已共享人员：")]),a("div",e._l(e.SharedPersonList,(function(t){return a("el-tag",{key:t.shareId,attrs:{closable:"",size:"medium",type:"primary",effect:"dark"},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t.shareName)+" ")])})),1)]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(a){return e.$emit("update:dialogVisible",!1)}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.updateLoading},on:{click:e.submitForm}},[e._v("确 定")])],1)],1)},l=[],c=(t("14d9"),t("a454")),d={props:{dialogVisible:{type:Boolean,default:!1},id:{type:String,default:""},isEdit:{type:Boolean,default:!0}},data(){return{dialogTitle:"事件共享",form:{shareType:"",shareId:""},rules:{},roleList:[],personList:[],shareList:[],updateLoading:!1}},computed:{SharedRoleList(){return this.shareList.filter(e=>1==e.shareType)},SharedPersonList(){return this.shareList.filter(e=>2==e.shareType)}},methods:{async getShareInfo(){try{const e=await Object(i["i"])(o["a"].ecapi.queryShareById,{eventId:this.id});this.shareList=e}catch(e){}},async getRoleList(){try{const e=await Object(i["i"])(c["a"].role.getSelectRoleData);this.roleList=e}catch(e){}},async getPersonList(){try{const e=await Object(i["i"])(c["a"].user.userIDList);this.personList=e}catch(e){}},pushList(e){let a="";a=1==this.form.shareType?this.roleList.find(a=>a.roleId==e).roleName:this.personList.find(a=>a.userId==e).userName,this.shareList.push({eventId:this.id,shareId:e,shareType:this.form.shareType,shareName:a})},handleClose(e){this.shareList.splice(this.shareList.indexOf(e),1)},submitForm(){this.$refs["ruleForm"].validate(async e=>{if(!e)return Promise.reject(!1);try{this.updateLoading=!0;const e=await Object(i["i"])(o["a"].ecapi.saveOrUpdate,this.shareList);!0===e?this.$emit("update:dialogVisible",!1):this.$message.error("修改失败！")}catch(a){}finally{this.updateLoading=!1}})}},mounted(){this.getShareInfo(),this.getPersonList(),this.getRoleList()}},p=d,u=(t("9d06"),t("2877")),h=Object(u["a"])(p,n,l,!1,null,"6f39b12a",null),g=h.exports,y={components:{EditDialog:g},data(){return{loading:!1,exportLoading:!1,searchParams:{keyWords:""},query:{current:1,size:10},total:0,tableData:[],dialogVisible:!1,currentRow:{}}},methods:{searchTable(){this.query.current=1,this.query={...this.query,...this.searchParams},this.getTableData()},async getTableData(){try{this.loading=!0;const{records:e,total:a}=await Object(i["i"])(o["a"].ecapi.queryEventsByUserId,this.query);this.tableData=e,this.total=a}catch(e){}finally{this.loading=!1}},handleSizeChange(e){this.query.current=1,this.query.size=e,this.getTableData()},handleCurrentChange(e){this.query.current=e,this.getTableData()},openDialog(e){this.currentRow=e,this.dialogVisible=!0}},mounted(){this.searchTable()}},m=y,v=(t("e470"),Object(u["a"])(m,r,s,!1,null,"ecc5102e",null));a["default"]=v.exports},"72ae":function(e,a,t){"use strict";const r="/mcd-cep-web/action",s="/evt-svc/api";a["a"]={ecapi:{queryEventClass:r+"/cep/rule/nx/queryEventClass.do",queryEventDictByDictCode:r+"/cep/rule/nx/queryEventDictByDictCode.do",queryParentDictByDictCode:r+"/cep/rule/nx/queryParentDictByDictCode.do",queryConfigDict:r+"/cep/rule/nx/queryConfigDict.do",queryEventClassLevel:r+"/cep/rule/queryEventClass.do",queryCepRuleNum:r+"/cep/rule/queryCepRuleNum.do",createRule:r+"/cep/rule/nx/createRule.do",manageList:s+"/event/list",manageUpdateStatus:s+"/event/updateStatus",manageDelete:s+"/event",manageListByParent:s+"/businessCategory/listByParent",manageListByLevel:s+"/businessCategory/listByLevel",manageCategoryList:s+"/businessCategory/list",manageGetDetail:s+"/event",eventSave:s+"/event/save",eventListByLevel:s+"/category/listByLevel",eventListByParent:s+"/category/listByParent",areaList:s+"/area/list",areaGetDetail:s+"/area",areaDelete:s+"/area",areaSave:s+"/area/save",areaStationList:s+"/area/stationList",stationList:s+"/station/list",listByCategory:s+"/categoryValue/listByCategory",queryEventsByUserId:"/plan-svc/api/action/cep/event/eventManager/queryEventsByUserId",queryShareById:"/plan-svc/cepRuleShare/queryShareById",saveOrUpdate:"/plan-svc/cepRuleShare/saveOrUpdate",delCampCoordinationTaskList:"/plan-svc/mcd/strategic/coordination/delCampCoordinationTaskList",exportExampleFile:"/plan-svc/mcd/strategic/coordination/exportExampleFile",pushCampCoordinationFile:"/plan-svc/mcd/strategic/coordination/pushCampCoordinationFile",queryCampCoordinationTask:"/plan-svc/mcd/strategic/coordination/queryCampCoordinationTask",queryStrategicCoordination:"/plan-svc/mcd/strategic/coordination/queryStrategicCoordination",saveStrategicCoordinationTask:"/plan-svc/mcd/strategic/coordination/saveStrategicCoordinationTask",selectAllStrategicCoordination:"/plan-svc/mcd/strategic/coordination/selectAllStrategicCoordination",recountCampTask:"/plan-svc/mcd/strategic/coordination/recountCampTask",queryCampCoordinationTaskDetail:"/plan-svc/mcd/strategic/coordination/queryCampCoordinationTaskDetail",childTaskRecord:"/plan-svc/mcd/strategic/coordination/childTaskRecord",approveTaskRecord:"/plan-svc/api/campCoordinate/taskApprove/approveTaskRecord",approveChildTaskRecord:"/plan-svc/api/campCoordinate/taskApprove/approveChildTaskRecord",subTaskApprove:"/plan-svc/api/campCoordinate/taskApprove/subTaskApprove",updateTaskStatus:"/plan-svc/api/campCoordinate/taskApprove/updateTaskStatus",queryAppTypeList:"/approve-svc/jx/cmpApprovalProcessConf/queryAppTypeList",getApproveConfig:"/approve-svc/jx/cmpApprovalProcessConf/getApproveConfig?systemId=",getNodeApprover:"/approve-svc/jx/cmpApproveProcessInstance/getNodeApprover",submitProcess:"/approve-svc/jx/cmpApproveProcessInstance/submitProcess",delPlanConfList:"/plan-svc/mcd/strategic/coordination/delPlanConfList",qryNotCfgPlanTypeAndPri:"/plan-svc/mcd/strategic/coordination/qryNotCfgPlanTypeAndPri",qryPlanConfList:"/plan-svc/mcd/strategic/coordination/qryPlanConfList",qryPlanConfListByPlanTypeOnSave:"/plan-svc/mcd/strategic/coordination/qryPlanConfListByPlanTypeOnSave",qryPlanConfListByPlanTypeOnUpdate:"/plan-svc/mcd/strategic/coordination/qryPlanConfListByPlanTypeOnUpdate",qryPlanTypeList:"/plan-svc/mcd/strategic/coordination/qryPlanTypeList",savePlanConf:"/plan-svc/mcd/strategic/coordination/savePlanConf",updatePriority:"/plan-svc/mcd/strategic/coordination/updatePriority",getSysDics:"/plan-svc/action/iop/common/getSysDics",delTagConfig:"/plan-svc/orchestrate/tag/delTagConfig",queryAccessLabel:"/plan-svc/orchestrate/tag/queryAccessLabel",queryTag:"/plan-svc/orchestrate/tag/queryTag",queryTagType:"/plan-svc/orchestrate/tag/queryTagType",saveTag:"/plan-svc/orchestrate/tag/saveTag",updateTagOrderBy:"/plan-svc/orchestrate/tag/updateTagOrderBy",queryAllTag:"/plan-svc/orchestrate/tag/queryAllTag"}}},"9d06":function(e,a,t){"use strict";t("3800")},de2a:function(e,a,t){},e470:function(e,a,t){"use strict";t("de2a")}}]);