(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f23cfb5"],{"0fb4":function(e,t,a){"use strict";a("777f")},"777f":function(e,t,a){},"8c8e":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"MaterHome"},[t("div",{staticClass:"query-from-cell"},[t("el-form",{ref:"queryFromRef",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.queryFrom,size:"small","label-width":"70px"}},[t("el-form-item",{attrs:{label:"应用号：",prop:"strategyType"}},[t("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"请选择应用号",clearable:""},on:{change:e.changeApplication},model:{value:e.queryFrom.applicationNum,callback:function(t){e.$set(e.queryFrom,"applicationNum",t)},expression:"queryFrom.applicationNum"}},e._l(e.applicationList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.applicationName,value:e.id}})})),1)],1),t("el-form-item",{attrs:{prop:"strategyType"}},[t("div",{staticClass:"search_box"},[t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticClass:"input-search",attrs:{placeholder:"请输入关键字"},model:{value:e.queryFrom.keyWords,callback:function(t){e.$set(e.queryFrom,"keyWords","string"===typeof t?t.trim():t)},expression:"queryFrom.keyWords"}},[t("i",{staticClass:"el-input__icon el-icon-search cursor-pointer",attrs:{slot:"suffix"},on:{click:function(t){return e.queryList()}},slot:"suffix"})])],1)]),t("el-form-item",{staticClass:"right"},[t("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.resetQueryForm}},[e._v("重置")]),t("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:e.addKeywords}},[e._v("新建")])],1)],1)],1),t("div",{staticClass:"Table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{type:"index",label:"序号"}}),t("el-table-column",{attrs:{prop:"applicationNum",label:"应用号"}}),t("el-table-column",{attrs:{prop:"keywordsId",label:"关键词ID"}}),t("el-table-column",{attrs:{prop:"keywordsName",label:"关键词名称"}}),t("el-table-column",{attrs:{prop:"templateId",label:"模板ID"}}),t("el-table-column",{attrs:{prop:"templateName",label:"模板名称"}}),t("el-table-column",{attrs:{prop:"createUser",label:"创建人"}}),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{slot:"reference"},on:{click:function(t){return e.update(a.row)}},slot:"reference"},[e._v("编辑")]),t("el-popconfirm",{attrs:{title:"删除后无法恢复，确认删除吗?"},on:{confirm:function(t){return e.deleteList(a.row)}}},[t("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v("删除")])],1)]}}])})],1)],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.queryFrom.pageNum,layout:"total, prev, pager, next, jumper",total:e.Total},on:{"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:e.title,visible:e.dialogTableVisible,modal:!1,width:"1015px"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[t("div",{staticClass:"selech-panel"},[t("el-form",{ref:"logForm",staticStyle:{display:"flex","flex-wrap":"wrap"},attrs:{model:e.logForm,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"模板类型：","label-width":"120px"}},[t("el-select",{staticStyle:{width:"187px"},attrs:{placeholder:"请选择"},on:{change:e.changeTemplateType},model:{value:e.logForm.templateType,callback:function(t){e.$set(e.logForm,"templateType",t)},expression:"logForm.templateType"}},e._l(e.templateTypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"模板内容类型：","label-width":"120px"}},[t("el-select",{staticStyle:{width:"187px"},attrs:{placeholder:"请选择"},on:{change:e.changeContentType},model:{value:e.logForm.contentType,callback:function(t){e.$set(e.logForm,"contentType",t)},expression:"logForm.contentType"}},e._l(e.contentTypeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"审核结果：","label-width":"120px"}},[t("el-select",{staticStyle:{width:"187px"},attrs:{placeholder:"请选择"},on:{change:e.changeResult},model:{value:e.logForm.result,callback:function(t){e.$set(e.logForm,"result",t)},expression:"logForm.result"}},e._l(e.resultList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"应用号：","label-width":"120px"}},[t("el-input",{staticStyle:{width:"187px"},attrs:{placeholder:"请输入应用号",disabled:""},model:{value:e.logForm.applicationNum,callback:function(t){e.$set(e.logForm,"applicationNum",t)},expression:"logForm.applicationNum"}})],1),t("el-form-item",{attrs:{label:"关键词：","label-width":"120px",prop:"keywordsName"}},[t("el-input",{staticStyle:{width:"187px"},attrs:{placeholder:"请输入关键词",disabled:"修改关键词"===e.title},model:{value:e.logForm.keywordsName,callback:function(t){e.$set(e.logForm,"keywordsName",t)},expression:"logForm.keywordsName"}})],1),t("el-form-item",{attrs:{label:"已选择模板：","label-width":"120px",prop:"templateName"}},[t("el-input",{staticStyle:{width:"187px"},attrs:{placeholder:"请选择模板",disabled:""},model:{value:e.logForm.templateName,callback:function(t){e.$set(e.logForm,"templateName",t)},expression:"logForm.templateName"}})],1)],1)],1),t("el-table",{attrs:{data:e.gridData}},[t("el-table-column",{attrs:{type:"index",prop:"index",label:"序号"}}),t("el-table-column",{attrs:{property:"templateID",label:"模板编号"}}),t("el-table-column",{attrs:{property:"templateTypeChn",label:"模板类型"}}),t("el-table-column",{attrs:{property:"contentTypeChn",label:"模板内容类型"}}),t("el-table-column",{attrs:{property:"templateName",label:"模板名称"}}),t("el-table-column",{attrs:{label:"模板内容"},scopedSlots:e._u([{key:"default",fn:function(a){return[1===a.row.contentType||4===a.row.contentType?t("span",[e._v(e._s(a.row.contents))]):t("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:a.row.contents,fit:"contain"}})]}}])}),t("el-table-column",{attrs:{property:"createTime",label:"创建时间"}}),t("el-table-column",{attrs:{property:"until",label:"有效期"}}),t("el-table-column",{attrs:{property:"statusChn",label:"状态"}}),t("el-table-column",{attrs:{property:"resultChn",label:"审核结果"}}),t("el-table-column",{attrs:{property:"address",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.choose(a.row)}}},[e._v("添加")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.logForm.pageNum,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChangeTemplate}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit("logForm")}}},[e._v("确 定")])],1)],1)],1)},s=[],r=a("0fea"),o=a("5e05"),i=a("cf74");const n=o["a"].common.getApplication;var p={data(){return{queryFrom:{pageNum:1,size:10,keyWords:"",applicationNum:""},keyWords:"",tableData:[],Total:0,applicationList:[],dialogTableVisible:!1,gridData:[],logForm:{templateType:"",contentType:"",result:"",activityId:"",pageNum:1,size:10,applicationNum:"",keywordsName:"",templateName:"",keywordsId:"",createTime:""},rules:{templateName:[{required:!0,message:"请选择模板",trigger:"change"}],keywordsName:[{required:!0,message:"请输入关键词",trigger:"change"}]},total:0,templateTypeList:[{label:"全部",value:""},{label:"静态",value:1},{label:"交互动态",value:2},{label:"主动动态",value:3},{label:"空白",value:4}],contentTypeList:[{label:"全部",value:""},{label:"文本",value:1},{label:"多媒体",value:2},{label:"卡片",value:3},{label:"组合",value:4}],resultList:[{label:"全部",value:""},{label:"未提交审核",value:-1},{label:"审核通过",value:0},{label:"审核不通过",value:1},{label:"审核中",value:999}],applicationParams:{},templateParams:{},title:""}},created(){this.getApplicationNum().then(()=>{this.queryList()})},methods:{async getApplicationNum(){await Object(r["i"])(n,{channelId:"960"}).then(e=>{this.applicationList=e,this.queryFrom.applicationNum=e[0].applicationName,this.applicationParams=e[0]})},async queryList(){const e={current:this.queryFrom.pageNum,size:this.queryFrom.size,applicationNum:this.queryFrom.applicationNum,keyWords:this.queryFrom.keyWords};await Object(r["i"])(i["a"].temapi.queryFiveKeywords,e).then(e=>{this.tableData=e.records,this.Total=e.total})},changeApplication(e){const t=this.applicationList.filter(t=>t.id===e);this.applicationParams=t[0],this.queryFrom.applicationNum=t[0].applicationName,this.queryList()},async platformList(){const e={pageNum:this.logForm.pageNum,size:this.logForm.size,chatbotId:this.applicationParams.id,appId:this.applicationParams.applicationId,appSecret:this.applicationParams.appSecret,templateType:this.logForm.templateType,contentType:this.logForm.contentType,result:this.logForm.result};await Object(r["i"])(o["a"].common.getPlaformList,e).then(e=>{this.formatList(JSON.parse(e).list),this.total=JSON.parse(e).total})},formatList(e){const t="https://rcs.10086.cn/5g-csp/csp-manage";this.gridData=e.map(e=>{if(1===e.templateType?e.templateTypeChn="静态":2===e.templateType?e.templateTypeChn="交互动态":3===e.templateType?e.templateTypeChn="主动动态":e.templateTypeChn="空白",1===e.contentType)e.contentTypeChn="文本",e.contents=e.bodyTextTemplate.contents[0].text;else if(2===e.contentType)e.contentTypeChn="多媒体",e.contents=t+e.bodyTextTemplate.contents[0].file.thumbInfo.url;else if(3===e.contentType){e.contentTypeChn="卡片";var a="generalPurposeCardCarousel",l=e.bodyTextTemplate.contents[0].message;for(var s in l)e.contents=s===a?t+e.bodyTextTemplate.contents[0].message.generalPurposeCardCarousel.content[0].media.thumbnailUrl:t+e.bodyTextTemplate.contents[0].message.generalPurposeCard.content.media.thumbnailUrl}else 4===e.contentType&&(e.contents=e.bodyTextTemplate.contents[0].text,e.contentTypeChn="组合");return-1===e.result?e.resultChn="未提交审核":0===e.result?e.resultChn="审核通过":1===e.result?e.resultChn="审核不通过":e.resultChn="审核中",1===e.status?e.statusChn="正常":2===e.status?e.statusChn="下线":3===e.status&&(e.statusChn="删除"),e})},changeTemplateType(e){this.logForm.templateType=this.templateTypeList.filter(t=>t.value===e)[0].value,this.platformList()},changeContentType(e){this.logForm.contentType=this.contentTypeList.filter(t=>t.value===e)[0].value,this.platformList()},changeResult(e){this.logForm.result=this.resultList.filter(t=>t.value===e)[0].value,this.platformList()},addKeywords(){this.title="新增关键词",this.dialogTableVisible=!0,this.logForm.applicationNum=this.queryFrom.applicationNum,this.platformList()},handleSizeChange(e){},handleCurrentChange(e){this.queryFrom.pageNum=e,this.queryList()},handleCurrentChangeTemplate(e){this.logForm.pageNum=e,this.platformList()},resetQueryForm(){this.$refs.queryFromRef.resetFields(),this.queryFrom={...this.queryFrom,keyWords:""}},choose(e){this.logForm={...this.logForm,templateName:e.templateName},this.templateParams={...e,fallBackType:this.sureChoose(e)}},sureChoose(e){let t=[];if(Object.prototype.hasOwnProperty.call(e,"aimSmsTemplate")){var a=e.aimSmsTemplate;Object.prototype.hasOwnProperty.call(a,"state")&&"1"===a.state&&(t=[{fallBackType:"短小2.0回落",key:"2"}])}return Object.prototype.hasOwnProperty.call(e,"smsTemplate")&&(t=[{fallBackType:"文本回落",key:"0"}]),Object.prototype.hasOwnProperty.call(e,"mmsTemplate")&&(t=[{fallBackType:"视频回落",key:"1"}]),t.length&&t[0].key?t[0].key:"-1"},submit(e){this.$refs[e].validate(e=>{if(!e)return!1;this.addFiveKeywords().then(()=>{this.queryList()}),this.logForm={templateType:"",contentType:"",result:"",activityId:"",pageNum:1,size:10,applicationNum:"",keywordsName:"",templateName:"",keywordsId:"",createTime:""},this.templateParams={},this.$refs.logForm.clearValidate(),this.$refs.logForm.resetFields(),this.dialogTableVisible=!1})},async addFiveKeywords(e){const t=sessionStorage.getItem("userNameCn"),a={applicationNum:this.queryFrom.applicationNum,createTime:""!==this.logForm.createTime?this.logForm.createTime:this.getData((new Date).getTime()),createUser:t,fallBackType:this.templateParams.fallBackType,keywordsId:this.logForm.keywordsId,keywordsName:this.logForm.keywordsName,templateId:this.templateParams.templateID,templateName:this.templateParams.templateName,templateType:this.templateParams.templateType};await Object(r["i"])(i["a"].temapi.addFiveKeywords,a).then(e=>{})},update(e){this.title="修改关键词",this.templateParams={...this.templateParams,templateID:e.templateId,templateName:e.templateName,templateType:e.templateType,fallBackType:e.fallBackType},this.logForm={...this.logForm,keywordsId:e.keywordsId,keywordsName:e.keywordsName,createTime:e.createTime,templateName:e.templateName,applicationNum:e.applicationNum},this.platformList(),this.dialogTableVisible=!0},async deleteList(e){await Object(r["i"])(i["a"].temapi.delFiveKeywords,{keywordsId:e.keywordsId}).then(e=>{this.queryList()})},getData(e){return e=new Date(e),e.toLocaleDateString().replace(/\//g,"-")+" "+e.toTimeString().substr(0,8)}}},m=p,c=(a("0fb4"),a("2877")),u=Object(c["a"])(m,l,s,!1,null,"2bbeb89e",null);t["default"]=u.exports},cf74:function(e,t,a){"use strict";const l="/msg5g-svc";t["a"]={temapi:{add:l+"/MsgTemplate/add",approve:l+"/MsgTemplate/approve",check:l+"/MsgTemplate/check",checkBatch:l+"/MsgTemplate/checkBatch",commit:l+"/MsgTemplate/commit",delete:l+"/MsgTemplate/delete",deleteBatch:l+"/MsgTemplate/deleteBatch",eles:l+"/MsgTemplate/eles",detail:l+"/MsgTemplate/detail",list:l+"/MsgTemplate/list",query5GTemplates:l+"/MsgTemplate/query5GTemplates",refresh:l+"/MsgTemplate/refresh",refreshBatch:l+"/MsgTemplate/refreshBatch",test:l+"/MsgTemplate/test",update:l+"/MsgTemplate/update",templateDetail:l+"/MsgTemplate/getTemplateDetail",eleAdd:l+"/MsgElement/add",eleCheck:l+"/MsgElement/check",eleCheckBatch:l+"/MsgElement/checkBatch",eleDelete:l+"/MsgElement/delete",eleDeleteBatch:l+"/MsgElement/deleteBatch",eleList:l+"/MsgElement/list",eleRefresh:l+"/MsgElement/refresh",eleRefreshBatch:l+"/MsgElement/refreshBatch",rename:l+"/MsgElement/rename",upload:l+"/MsgElement/upload",uploadBatch:l+"/MsgElement/uploadBatch",send:l+"/MsgSend/send",MenuCommit:l+"/MsgMenu/commit",MenuDelete:l+"/MsgMenu/delete",get:l+"/MsgMenu/get",query:l+"/MsgMenu/query",queryTemp:l+"/MsgMenu/queryTemp",save:l+"/MsgMenu/save",status:l+"/MsgMenu/getMenuStatus",all:l+"/MsgMenu/getMenuAll",cfgList:l+"/cfg/list",queryFiveKeywords:"/plan-svc/action/jx/msg5g_keywords/getFiveGKeywordsInfo",addFiveKeywords:"/plan-svc/action/jx/msg5g_keywords/updateFiveGKeywordsInfo",delFiveKeywords:"/plan-svc/action/jx/msg5g_keywords/deleteFiveGKeywordsInfo"}}}}]);