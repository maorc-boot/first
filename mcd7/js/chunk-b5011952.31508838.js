(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b5011952","chunk-67a56326","chunk-15a5ac08"],{"08cc":function(e,t,a){"use strict";var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mailTable-layer",class:e.showByRow?"fs12":""},[t("div",{staticClass:"mailTable",style:e.styleObject},e._l(e.rowCount,(function(a,l){return t("el-row",{key:l},[e.isAarray(a)?t("el-row",{staticClass:"ArrayMailTable"},e._l(a,(function(a,l){return t("el-col",{key:l,staticClass:"ArrayMailTable-row",attrs:{span:12}},[t("el-col",{staticClass:"key",attrs:{span:8}},[e._v(e._s(a.key))]),t("el-col",{staticClass:"value",attrs:{span:16}},[e._v(e._s(e.DetailsFrom[a.value]))])],1)})),1):t("el-row",[t("el-col",{staticClass:"ArrayMailTable",attrs:{span:24}},[t("el-col",{staticClass:"key",attrs:{span:4}},[e._v(e._s(a.key))]),t("el-col",{staticClass:"value1",attrs:{span:20}},[e._v(e._s(e.DetailsFrom[a.value]))])],1)],1)],1)})),1)])},i=[],s=(a("14d9"),{data(){return{styleObject:{},s_showByRow:!0}},props:["tableData","tableStyle","showByRow","DetailsFrom"],computed:{isAarray:function(){return e=>Array.isArray(e)},rowCount:function(){let e=[],t=[...this.tableData];for(let a=0;a<t.length;a++){let l=[];t[a].iscolspan||(l.push(t[a]),a+1<t.length&&!t[a+1].iscolspan&&(l.push(t[a+1]),a++)),0!==l.length?(l.length<2&&l.push([]),e.push(l)):e.push(t[a])}return e}},created(){this.styleObject=this.tableStyle,void 0!==this.showByRow&&(this.s_showByRow=this.showByRow)}}),o=s,r=(a("5976"),a("2877")),n=Object(r["a"])(o,l,i,!1,null,"2becbdfc",null);t["a"]=n.exports},1173:function(e,t,a){},"121a":function(e,t,a){"use strict";var l=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"productContent"},[t("span",[e._v(e._s(e.DetailForm.PLAN_NAME||""))])]),e._m(0),t("vertical-table",{attrs:{tableData:e.tableData,DetailsFrom:e.DetailForm,tableStyle:{width:"100%"}}})],1)},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"tableTitle"},[t("h3",[e._v("基础信息")])])}],s=a("08cc"),o=a("0fea"),r=a("d370"),n={props:{planId:{type:String,default:()=>""}},components:{VerticalTable:s["a"]},data(){return{tableData:[{key:"单产品编码：",value:"planId"},{key:"单产品名称：",value:"planName"},{key:"生效时间：",value:"planStartDate"},{key:"失效时间：",value:"planEndDate"},{key:"状态：",value:"status"},{key:"产品类型：",value:"planSrvType"},{key:"资费：",value:"productCharges"},{key:"商品类型：",value:"offerType"},{key:"产商品类型：",value:"itemType"},{key:"产品业务分类：",value:"prodClassBusi"},{key:"描述：",value:"planDesc",iscolspan:!0},{key:"推荐用语：",value:"planComment",iscolspan:!0}],AdaptiveChannel:[],DetailForm:{}}},mounted(){this.getqueryDetail()},methods:{async getqueryDetail(){await Object(o["i"])(r["a"].mpapi.queryDetail,{planId:this.planId}).then(e=>{e.planName=e.planName.length>=15?e.planName.slice(0,12)+"...":e.planName,this.DetailForm=e})}}},d=n,c=(a("1cce"),a("2877")),u=Object(c["a"])(d,l,i,!1,null,"5bea6e90",null);t["a"]=u.exports},"1cce":function(e,t,a){"use strict";a("7d49")},2419:function(e,t,a){"use strict";a("bd45")},"271a":function(e,t,a){"use strict";var l=a("cb2d"),i=a("e330"),s=a("577e"),o=a("d6d6"),r=URLSearchParams,n=r.prototype,d=i(n.getAll),c=i(n.has),u=new r("a=1");!u.has("a",2)&&u.has("a",void 0)||l(n,"has",(function(e){var t=arguments.length,a=t<2?void 0:arguments[1];if(t&&void 0===a)return c(this,e);var l=d(this,e);o(t,1);var i=s(a),r=0;while(r<l.length)if(l[r++]===i)return!0;return!1}),{enumerable:!0,unsafe:!0})},3599:function(e,t,a){"use strict";var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"product_tab_box"},[t("div",{staticClass:"selected_product"},[t("select-view",{attrs:{title:"已选产品",list:e.multipleSelection,option:e.selectKeyMap},on:{"update:list":e.updateSelectList}})],1),e.showUpload?t("batch-import-product",{staticClass:"batch_import_btn",on:{uploadSuccess:e.uploadSuccess}}):e._e(),t("query-condition",{on:{conditionChange:e.conditionChange}}),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"productTable",staticClass:"Mp-table",staticStyle:{width:"100%"},attrs:{height:"355",data:e.tableData}},[t("el-table-column",{attrs:{label:"操作",width:"50"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"check_box_warper"},[t("el-checkbox",{attrs:{value:e.isExist(a.row)>=0,disabled:a.row.disabled}}),t("div",{staticClass:"check_box_masker",on:{click:function(t){return e.rowCheckChange(a.row)}}})],1)]}}])}),t("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),t("el-table-column",{attrs:{label:"产品编号及名称","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"productName",on:{click:function(t){return e.showDetail(a.row)}}},[t("p",[e._v(e._s(a.row.planName))]),t("p",[e._v(e._s(a.row.planId))])])]}}])}),t("el-table-column",{attrs:{label:"产品类型",prop:"itemType"}}),t("el-table-column",{attrs:{label:"业务分类",prop:"prodClassBusi"}}),t("el-table-column",{attrs:{label:"生效时间",prop:"planStartDate","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{label:"失效时间",prop:"planEndDate","show-overflow-tooltip":!0}})],1),t("div",{staticClass:"pager"},[t("el-pagination",{attrs:{"current-page":e.pageData.currentPage,"page-sizes":e.pageData.pageSizeList,"page-size":e.pageData.pageSize,"pager-count":e.pageData.pagerCount,total:e.pageData.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{width:"800px",title:"产品详情",visible:e.showProductDetail,"before-close":e.dialogRetrun,"append-to-body":!0}},[t("div",{staticClass:"product_detail_content"},[e.showProductDetail?t("product-content",{attrs:{planId:e.planId}}):e._e()],1)])],1)},i=[],s=(a("14d9"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"query_condition_box"},[t("div",{staticClass:"search"},[t("div",{staticClass:"search_box",staticStyle:{width:"auto"}},[t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],staticClass:"input-search",attrs:{placeholder:"请输入产品编号/名称"},model:{value:e.ConditionFrom.keyWords,callback:function(t){e.$set(e.ConditionFrom,"keyWords","string"===typeof t?t.trim():t)},expression:"ConditionFrom.keyWords"}},[t("i",{staticClass:"el-input__icon el-icon-search cursor-pointer",attrs:{slot:"suffix"},on:{click:e.getProductList},slot:"suffix"})])],1),t("div",{staticClass:"screen",on:{click:function(t){e.showMoreQueryCondition=!e.showMoreQueryCondition}}},[t("span",[e._v("更多筛选")]),t("i",{staticClass:"el-icon-arrow-down"})])]),t("el-collapse-transition",[e.showMoreQueryCondition?t("div",{staticClass:"ScreenLabel"},[t("div",{staticClass:"category"},[t("query-form-cell",{attrs:{list:e.QueryFormCell,defaultSizeForm:e.sizeForm,labelWidth:e.labelWidth},on:{queryForm:e.QuerySelect}})],1)]):e._e()])],1)}),o=[],r=a("4e3f"),n=a("0fea"),d=a("d370");let c;var u={components:{QueryFormCell:r["a"]},data(){return{labelWidth:"110px",Label:[],QueryFormCell:[{label:"产品业务分类",values:[{label:"不限",value:""}],isDate:!1},{label:"产商品类型",values:[{label:"不限",value:""}],isDate:!1},{label:"商品类型",values:[{label:"不限",value:""}],isDate:!1}],sizeForm:{radioModel:["",""]},ConditionFrom:{keyWords:"",prodClassBusi:"",itemType:"",offerType:""},showMoreQueryCondition:!1}},created(){this.queryPlanTypes()},methods:{queryPlanTypes(){c||(c=Promise.all([Object(n["g"])(d["a"].mpapi.querylistEnumValue,{labelKey:"PROD_CLASS_BUSI"}),Object(n["g"])(d["a"].mpapi.querylistEnumValue,{labelKey:"OFFER_TYPE"}),Object(n["g"])(d["a"].mpapi.querylistEnumValue,{labelKey:"ITEM_TYPE"})])),c.then(e=>{e.forEach((e,t)=>{e.map(e=>{this.QueryFormCell[t].values.push({label:e.labelValue,value:e.labelValue})})})})},getProductList(){this.$emit("conditionChange",this.ConditionFrom)},QuerySelect(e){this.ConditionFrom.prodClassBusi=e.form.radioModel[0],this.ConditionFrom.offerType=e.form.radioModel[2],this.ConditionFrom.itemType=e.form.radioModel[1],this.getProductList()}}},p=u,h=(a("9c1f"),a("2877")),m=Object(h["a"])(p,s,o,!1,null,"0cf18324",null),y=m.exports,b=a("dec5"),f=a("121a"),v=a("b573"),g={components:{SelectView:b["default"],QueryCondition:y,ProductContent:f["a"],BatchImportProduct:v["default"]},props:{tabName:{type:String,required:!0},showUpload:{type:Boolean,default:()=>!1},multiple:{type:Boolean,default:()=>!0},excluedList:{type:Array,default:()=>[]},initialSelection:{type:Array,default:()=>[]}},computed:{table(){return this.$refs.productTable}},data(){return{loading:!1,selectKeyMap:{label:"planName",value:"planId"},queryParams:{channelId:"",isEliminateRule:"",current:1,planIsOptimization:"",keyWords:"",prodClassBusi:"",itemType:"",offerType:""},pageData:{pagerCount:5,currentPage:1,pageSize:5,pageSizeList:[5,10,15,20],total:0},tableData:[],multipleSelection:[],showProductDetail:!1,planId:"",updateUi:Date.now()}},created(){this.initMultipleSelection(),this.getProductList()},methods:{uploadSuccess(e){this.updateSelectList(e),this.$emit("selectionChange",this.tabName,this.multipleSelection)},checkHasSelected(e){for(let t=0;t<this.excluedList.length;t++){const a=this.excluedList[t];if(a.value===this.tabName)continue;const l=a.multipleSelection.some(t=>t.planId===e);if(l)return!0}return!1},rowCheckChange(e){if(e.disabled)return;const{id:t,...a}=e,l=this.isExist(e);if(l>=0)this.multipleSelection.splice(l,1);else{const t=this.checkHasSelected(e.planId);if(t)return void this.$message.error("您已经添加过该商品，请勿重复添加");this.multiple?this.multipleSelection.push(a):this.multipleSelection=[a]}this.$emit("selectionChange",this.tabName,this.multipleSelection)},isExist(e){return this.multipleSelection.findIndex(t=>t.planId===e.planId)},dialogRetrun(){this.showProductDetail=!1,this.visible=!0},initMultipleSelection(){this.multipleSelection=this.initialSelection},doLayout(){this.table&&this.table.doLayout()},showDetail({planId:e}){this.planId=e,this.showProductDetail=!0},updateSelectList(e=[]){this.multipleSelection=e},handleSizeChange(e){this.pageData.pageSize=e,this.getProductList()},handleCurrentChange(e){this.pageData.currentPage=e,this.getProductList()},conditionChange(e){this.pageData.currentPage=1,this.queryParams={...this.queryParams,...e},this.getProductList()},getProductList(){this.loading=!0,Object(n["i"])(d["a"].mpapi.queryTableList,{...this.queryParams,isSupportAi:"1"==this.$route.query.type?1:0,current:this.pageData.currentPage,size:this.pageData.pageSize},void 0,this.$retryDelay).then(e=>{const t=this.$moment().set({hour:23,minute:59,second:59,millisecond:999});e.records.forEach(e=>{e.disabled=!e.planEndDate||this.$moment(e.planEndDate)<t}),this.tableData=e.records,this.pageData.total=e.total}).finally(()=>{this.loading=!1})}}},C=g,w=(a("5aed"),Object(h["a"])(C,l,i,!1,null,"8b8872e2",null));t["a"]=w.exports},"4e3f":function(e,t,a){"use strict";var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"query-form-cell-wrap"},[t("el-form",{ref:"form",attrs:{model:e.sizeForm,"label-width":e.labelWidth,"label-position":e.labelPosition,size:"mini"}},e._l(e.list,(function(a,l){return t("el-form-item",{key:l+"list",class:{disabled:a.disabled},attrs:{"label-width":a.labelWidth||e.labelWidth,label:a.label+"："}},[Array.isArray(a.values)?t("div",{staticClass:"fe-d-flex"},[t("div",{staticClass:"radio-box"},[a.dateType?e._e():t("el-radio-group",{attrs:{size:"mini",disabled:a.disabled},on:{change:function(t){return e.radioChange(e.sizeForm.radioModel[l],l)}},model:{value:e.sizeForm.radioModel[l],callback:function(t){e.$set(e.sizeForm.radioModel,l,t)},expression:"sizeForm.radioModel[index]"}},e._l(a.values,(function(a,l){return t("el-radio-button",{key:l+"listValues",attrs:{label:a.value}},[e._v(e._s(a.label)+" ")])})),1)],1),t("div",{staticClass:"date-box"},["date"===a.dateType?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd",clearable:!1},on:{change:e.dateChange},model:{value:e.sizeForm.dateModel[l],callback:function(t){e.$set(e.sizeForm.dateModel,l,t)},expression:"sizeForm.dateModel[index]"}}):e._e(),"month"===a.dateType?t("el-date-picker",{attrs:{type:"month",placeholder:"选择月","value-format":"yyyy-MM",clearable:!1},on:{change:e.dateChange},model:{value:e.sizeForm.dateModel[l],callback:function(t){e.$set(e.sizeForm.dateModel,l,t)},expression:"sizeForm.dateModel[index]"}}):e._e(),"daterange"===a.dateType?t("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:!0},on:{change:e.dateChange},model:{value:e.sizeForm.dateModel[l],callback:function(t){e.$set(e.sizeForm.dateModel,l,t)},expression:"sizeForm.dateModel[index]"}}):e._e(),"datetimerange"===a.dateType?t("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:!1},on:{change:e.dateChange},model:{value:e.sizeForm.dateModel[l],callback:function(t){e.$set(e.sizeForm.dateModel,l,t)},expression:"sizeForm.dateModel[index]"}}):e._e()],1)]):t("div",{staticClass:"input-box"},[t("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],attrs:{placeholder:"请输入内容"},on:{change:e.inputChange},model:{value:e.sizeForm.radioModel[l],callback:function(t){e.$set(e.sizeForm.radioModel,l,t)},expression:"sizeForm.radioModel[index]"}})],1)])})),1)],1)},i=[],s={name:"QueryFormCell",props:{labelWidth:{type:String,default:()=>"82px"},labelPosition:{type:String,default:()=>"right"},defaultSizeForm:{type:Object,default:()=>({})},list:{type:Array,default:()=>[{label:"数据时间",values:[{label:"不限",value:"1"}],isDate:!0,dateType:"date"},{label:"接口类型",values:[{label:"不限",value:"不限"},{label:"文件接口",value:"文件接口"}],isDate:!1}]}},data(){return{sizeForm:{dateModel:["2021-05-08","",""],radioModel:["自定义","不限","不限","不限"]}}},watch:{defaultSizeForm:{handler:function(e){this.sizeForm=e},deep:!0,immediate:!0}},methods:{radioChange(e,t){this.sizeForm.dateModel&&this.$set(this.sizeForm.dateModel,t,"date"===this.list[t].dateType?"":["",""]),this.$emit("queryForm",{index:t,value:e,form:this.sizeForm})},dateChange(e){e?(this.$set(this.sizeForm.dateModel,0,e),this.$emit("queryForm",{value:e,form:this.sizeForm})):this.$emit("emptyFrom",this.sizeForm)},inputChange(e){e&&this.$emit("queryForm",{value:e,form:this.sizeForm})}}},o=s,r=(a("a28d"),a("2877")),n=Object(r["a"])(o,l,i,!1,null,null,null);t["a"]=n.exports},5494:function(e,t,a){"use strict";var l=a("83ab"),i=a("e330"),s=a("edd0"),o=URLSearchParams.prototype,r=i(o.forEach);l&&!("size"in o)&&s(o,"size",{get:function(){var e=0;return r(this,(function(){e++})),e},configurable:!0,enumerable:!0})},5558:function(e,t,a){},5976:function(e,t,a){"use strict";a("1173")},"5aed":function(e,t,a){"use strict";a("e87a")},"6bcd":function(e,t,a){},"7d49":function(e,t,a){},"88a7":function(e,t,a){"use strict";var l=a("cb2d"),i=a("e330"),s=a("577e"),o=a("d6d6"),r=URLSearchParams,n=r.prototype,d=i(n.append),c=i(n["delete"]),u=i(n.forEach),p=i([].push),h=new r("a=1&a=2&b=3");h["delete"]("a",1),h["delete"]("b",void 0),h+""!=="a=2"&&l(n,"delete",(function(e){var t=arguments.length,a=t<2?void 0:arguments[1];if(t&&void 0===a)return c(this,e);var l=[];u(this,(function(e,t){p(l,{key:t,value:e})})),o(t,1);var i,r=s(e),n=s(a),h=0,m=0,y=!1,b=l.length;while(h<b)i=l[h++],y||i.key===r?(y=!0,c(this,i.key)):m++;while(m<b)i=l[m++],i.key===r&&i.value===n||d(this,i.key,i.value)}),{enumerable:!0,unsafe:!0})},"9c1f":function(e,t,a){"use strict";a("5558")},a28d:function(e,t,a){"use strict";a("cddb")},b573:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"upload_product_box"},[t("el-button",{staticClass:"btn",attrs:{plain:"",type:"primary",loading:e.uploadLoading,icon:"el-icon-plus"},on:{click:e.uploadProduct}},[e._v(e._s(e.uploadLoading?"正在上传":e.requestInfo.btnText))]),t("el-button",{staticClass:"btn",attrs:{plain:"",type:"primary",loading:e.downLoading,icon:"el-icon-download"},on:{click:e.downloadTemplateFile}},[e._v(e._s(e.downLoading?"正在下载":"模板下载"))]),t("input",{ref:"inputFile",staticClass:"input_file",attrs:{type:"file",accept:".xlsx,.xls"}})],1)},i=[],s=(a("88a7"),a("271a"),a("5494"),a("0fea")),o=a("afd9"),r={props:{type:{type:String,default:"product"}},data(){return{downLoading:!1,uploadLoading:!1,requestTypes:{product:{dowloadUrl:o["a"].batchImpPlanTmpDownload,importUrl:o["a"].batchImportProduct,fileName:"批量产品导入模板",btnText:"批量导入产品"},customer:{dowloadUrl:o["a"].batchImpCustTmpDownload,importUrl:o["a"].batchImportCust,fileName:"批量导入客群模板",btnText:"批量导入客群"},label:{dowloadUrl:o["a"].batchImpLabelTmpDownload,importUrl:o["a"].batchImportLabel,fileName:"批量导入标签模板",btnText:"批量导入标签"}}}},computed:{requestInfo(){return this.requestTypes[this.type]||this.requestInfo.product}},methods:{downloadTemplateFile(){this.downLoading=!0,Object(s["b"])(this.requestInfo.dowloadUrl).then(e=>e).then(({data:e,headers:t})=>{const a=t["content-disposition"]||"",l=a.split(".")[1]||"xls",i=new Blob([e],{type:e.type}),s=`${this.requestInfo.fileName}.${l}`,o=document.createElement("a");o.download=s,o.style.display="none",o.href=URL.createObjectURL(i),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o)}).finally(()=>{this.downLoading=!1})},uploadProduct(){if(this.uploadLoading)return;const e=this.$refs.inputFile;e.click(),e.onchange=async()=>{let t=e.files[0],a=new FormData;a.append("multipartFile",t);try{this.uploadLoading=!0;const t=await Object(s["j"])(this.requestInfo.importUrl,a);Array.isArray(t)&&t.length?this.$emit("uploadSuccess",t.map(({id:e,...t})=>t)):this.$message.error(t.message)}catch(l){}finally{this.uploadLoading=!1,e.value=""}}}}},n=r,d=(a("2419"),a("2877")),c=Object(d["a"])(n,l,i,!1,null,"0fa212fd",null);t["default"]=c.exports},bd45:function(e,t,a){},cddb:function(e,t,a){},d208:function(e,t,a){"use strict";a("6bcd")},d6d6:function(e,t,a){"use strict";var l=TypeError;e.exports=function(e,t){if(e<t)throw new l("Not enough arguments");return e}},dec5:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"select-view"},[t("i",{staticClass:"iconfont icongonggongtubiao-huitiaoliangcedianzhui"}),t("div",{staticClass:"title"},[e._v(e._s(e.title))]),t("div",{staticClass:"label"},e._l(e.list,(function(a){return t("el-tag",{key:a[e.option.value],staticClass:"tag",attrs:{type:"primary",size:"medium",closable:""},on:{close:function(t){return e.handleClose(a)}}},[e._v(" "+e._s(a[e.option.label])+" ")])})),1)])},i=[],s={props:{title:{type:String,default:""},list:{type:Array,default:()=>[]},option:{type:Object,default:()=>({label:"label",value:"value"})}},data(){return{}},methods:{handleClose(e){this.list.splice(this.list.indexOf(e),1),this.$emit("update:list",this.list)}}},o=s,r=(a("d208"),a("2877")),n=Object(r["a"])(o,l,i,!1,null,"3c6119b1",null);t["default"]=n.exports},e87a:function(e,t,a){},edd0:function(e,t,a){"use strict";var l=a("13d2"),i=a("9bf2");e.exports=function(e,t,a){return a.get&&l(a.get,t,{getter:!0}),a.set&&l(a.set,t,{setter:!0}),i.f(e,t,a)}}}]);