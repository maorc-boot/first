(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dedf9e82"],{"004ef":function(e,a,t){"use strict";t("4bc4")},"271a":function(e,a,t){"use strict";var s=t("cb2d"),l=t("e330"),r=t("577e"),n=t("d6d6"),i=URLSearchParams,c=i.prototype,o=l(c.getAll),p=l(c.has),d=new i("a=1");!d.has("a",2)&&d.has("a",void 0)||s(c,"has",(function(e){var a=arguments.length,t=a<2?void 0:arguments[1];if(a&&void 0===t)return p(this,e);var s=o(this,e);n(a,1);var l=r(t),i=0;while(i<s.length)if(s[i++]===l)return!0;return!1}),{enumerable:!0,unsafe:!0})},"4bc4":function(e,a,t){},5494:function(e,a,t){"use strict";var s=t("83ab"),l=t("e330"),r=t("edd0"),n=URLSearchParams.prototype,i=l(n.forEach);s&&!("size"in n)&&r(n,"size",{get:function(){var e=0;return i(this,(function(){e++})),e},configurable:!0,enumerable:!0})},"66c3":function(e,a,t){"use strict";t("eb14")},7953:function(e,a,t){},"88a7":function(e,a,t){"use strict";var s=t("cb2d"),l=t("e330"),r=t("577e"),n=t("d6d6"),i=URLSearchParams,c=i.prototype,o=l(c.append),p=l(c["delete"]),d=l(c.forEach),m=l([].push),u=new i("a=1&a=2&b=3");u["delete"]("a",1),u["delete"]("b",void 0),u+""!=="a=2"&&s(c,"delete",(function(e){var a=arguments.length,t=a<2?void 0:arguments[1];if(a&&void 0===t)return p(this,e);var s=[];d(this,(function(e,a){m(s,{key:a,value:e})})),n(a,1);var l,i=r(e),c=r(t),u=0,h=0,g=!1,f=s.length;while(u<f)l=s[u++],g||l.key===i?(g=!0,p(this,l.key)):h++;while(h<f)l=s[h++],l.key===i&&l.value===c||o(this,l.key,l.value)}),{enumerable:!0,unsafe:!0})},"89ff":function(e,a,t){"use strict";a["a"]={bigSrceenConfig:{queryFrontSecondScreens:"/plan-svc/mcd/front/secondScreen/queryFrontSecondScreens",updateFrontSecondScreens:"/plan-svc/mcd/front/secondScreen/updateFrontSecondScreens"},blackList:{deleBlackList:"/plan-svc/customer/black/list/deleBlackList",downloadImpOrDelBlacklistTemplate:"/plan-svc/customer/black/list/downloadImpOrDelBlacklistTemplate",impOrDelBlacklistFile:"/plan-svc/customer/black/list/impOrDelBlacklistFile",queryBlackList:"/plan-svc/customer/black/list/queryBlackList",queryAllCitys:"/plan-svc/customer/black/list/queryAllCitys",createOrUpdate:"/plan-svc/mcd-hmh5-blacklist-task/createOrUpdate",delete:"/plan-svc/mcd-hmh5-blacklist-task/delete",listTask:"/plan-svc/mcd-hmh5-blacklist-task/listTask",getTaskDetailByTaskId:"/plan-svc/mcd-hmh5-blacklist-task/getTaskDetailByTaskId",submitBlacklist:"/plan-svc/mcd-hmh5-blacklist-task/submitBlacklist",getBlacklistApprover:"/plan-svc/mcd-hmh5-blacklist-task/getBlacklistApprover",approveBlacklistRecord:"/plan-svc/mcd-hmh5-blacklist-task/approveBlacklistRecord"},careRelation:{queryChannelByCityAndCounty:"/plan-svc/mcd/front/guardList/queryChannelByCityAndCounty",exportGuardUserList:"/plan-svc/mcd/front/guardList/exportGuardUserList",queryGuardUserList:"/plan-svc/mcd/front/guardList/queryGuardUserList"},messageTemplate:{approveSmsTemplateRecord:"/plan-svc/sms/template/approveSmsTemplateRecord",delCareSmsTemplate:"/plan-svc/sms/template/delCareSmsTemplate",deleteTemplateLabel:"/plan-svc/sms/template/deleteTemplateLabel",getCareSmsTemplate:"/plan-svc/sms/template/getCareSmsTemplate",getCareSmsTemplateApprover:"/plan-svc/sms/template/getCareSmsTemplateApprover",getCareSmsTemplateDetail:"/plan-svc/sms/template/getCareSmsTemplateDetail",getCustGroupVars:"/plan-svc/sms/template/getCustGroupVars",getLabelListDaiwei:"/plan-svc/sms/template/getLabelListDaiwei",getRelaLabels:"/plan-svc/sms/template/getRelaLabels",saveCareSmsTemplate:"/plan-svc/sms/template/saveCareSmsTemplate",saveOrUpdateRela:"/plan-svc/sms/template/saveOrUpdateRela",subCareSmsTemplateApprove:"/plan-svc/sms/template/subCareSmsTemplateApprove"},labelConfig:{mcdCustomLabelDefGet:"/plan-svc/mcdCustomLabelDef",mcdCustomLabelDefPut:"/plan-svc/mcdCustomLabelDef",commitProcess:"/plan-svc/mcdCustomLabelDef/commitProcess",getNodeApprover:"/plan-svc/mcdCustomLabelDef/getNodeApprover",modifySelfDefinedLabelConf:"/plan-svc/mcdCustomLabelDef/modifySelfDefinedLabelConf",selectSelfDefinedLabelConf:"/plan-svc/mcdCustomLabelDef/selectSelfDefinedLabelConf",selectSelfDefinedLabelConfDetail:"/plan-svc/mcdCustomLabelDef/selectSelfDefinedLabelConfDetail",mcdCustomLabelDef:"/plan-svc/mcdCustomLabelDef"},warningConfig:{mcdAppAlarmInfoGet:"/plan-svc/mcdAppAlarmInfo",mcdAppAlarmInfoPost:"/plan-svc/mcdAppAlarmInfo",mcdAppAlarmInfoPut:"/plan-svc/mcdAppAlarmInfo",mcdAppAlarmInfoDelete:"/plan-svc/mcdAppAlarmInfo",batchImportAutoClearAlarm:"/plan-svc/mcdAppAlarmInfo/batchImportAutoClearAlarm",commitProcess:"/plan-svc/mcdAppAlarmInfo/commitProcess",getNodeApprover:"/plan-svc/mcdAppAlarmInfo/getNodeApprover",queryDataSourceList:"/plan-svc/mcdAppAlarmInfo/queryDataSourceList",queryDataTableList:"/plan-svc/mcdAppAlarmInfo/queryDataTableList",querySourceTable:"/plan-svc/mcdAppAlarmInfo/querySourceTable",selectAlarmDetailById:"/plan-svc/mcdAppAlarmInfo/selectAlarmDetailById",selectAlarmType:"/plan-svc/mcdAppAlarmInfo/selectAlarmType",terminateAlarm:"/plan-svc/mcdAppAlarmInfo/terminateAlarm",queryHasRole:"/plan-svc/mcdAppAlarmInfo/queryHasRole",updateAlarmThreshold:"/plan-svc/mcdAppAlarmInfo/updateAlarmThreshold",queryAllCitys:"/plan-svc/mcdAppAlarmInfo/queryAllCitys"},customerCommunicationUseCondition:{exportCampsegHandleDetail:"/plan-svc/action/jx/onlinelChannel/exportCampsegHandleDetail",exportCampsegHandleSummary:"/plan-svc/action/jx/onlinelChannel/exportCampsegHandleSummary",exportChannelUsageList:"/plan-svc/action/jx/onlinelChannel/exportChannelUsageList",exportCityUsageList:"/plan-svc/action/jx/onlinelChannel/exportCityUsageList",exportCountyUsageList:"/plan-svc/action/jx/onlinelChannel/exportCountyUsageList",exportGridUsageList:"/plan-svc/action/jx/onlinelChannel/exportGridUsageList",exportOppoCampCityHandle:"/plan-svc/action/jx/onlinelChannel/exportOppoCampCityHandle",queryCampsegHandleDetail:"/plan-svc/action/jx/onlinelChannel/queryCampsegHandleDetail",queryCampsegHandleSummary:"/plan-svc/action/jx/onlinelChannel/queryCampsegHandleSummary",queryChannelUsageList:"/plan-svc/action/jx/onlinelChannel/queryChannelUsageList",queryCityUsageList:"/plan-svc/action/jx/onlinelChannel/queryCityUsageList",queryCountyUsageList:"/plan-svc/action/jx/onlinelChannel/queryCountyUsageList",queryGridUsageList:"/plan-svc/action/jx/onlinelChannel/queryGridUsageList",queryOppoCampCityHandle:"/plan-svc/action/jx/onlinelChannel/queryOppoCampCityHandle"},customerContactMaintainCondition:{reportSmsMessage:"/plan-svc/reportSmsMessage",export:"/plan-svc/reportSmsMessage/export"},customerCommunicationWarningCondition:{reportYjCityDetailNew:"/plan-svc/reportYjCityDetailNew",reportYjCityDetailNewExport:"/plan-svc/reportYjCityDetailNew/export",reportYjCountyDetailNew:"/plan-svc/reportYjCountyDetailNew",reportYjCountyDetailNewExport:"/plan-svc/reportYjCountyDetailNew/export",reportYjDetailInfo:"/plan-svc/reportYjDetailInfo",reportYjDetailInfoExport:"/plan-svc/reportYjDetailInfo/export",reportYjGridDetailNew:"/plan-svc/reportYjGridDetailNew",reportYjGridDetailNewExport:"/plan-svc/reportYjGridDetailNew/export",reportYjStaffDetailNew:"/plan-svc/reportYjStaffDetailNew",reportYjStaffDetailNewExport:"/plan-svc/reportYjStaffDetailNew/export"},jobNoQuery:{queryFrontStafferList:"/plan-svc/mcd/front/staffer/queryFrontStafferList"},problemFeedback:{addNewReply:"/plan-svc/mcdFeedbackQa/addNewReply",addNewReplyPicture:"/plan-svc/mcdFeedbackQa/addNewReplyPicture",downloadImage:"/plan-svc/mcdFeedbackQa/downloadImage",getAllRepliesByBusinessId:"/plan-svc/mcdFeedbackQa/getAllRepliesByBusinessId",getRecentlyReplyFeedback:"/plan-svc/mcdFeedbackQa/getRecentlyReplyFeedback",mcdManagerFeedback:"/plan-svc/mcdManagerFeedback"},proxyCustomerLabel:{mcdFrontCareSmsLabelGet:"/plan-svc/mcdFrontCareSmsLabel",mcdFrontCareSmsLabelPost:"/plan-svc/mcdFrontCareSmsLabel",mcdFrontCareSmsLabelPut:"/plan-svc/mcdFrontCareSmsLabel",mcdFrontCareSmsLabelDelete:"/plan-svc/mcdFrontCareSmsLabel"},noticeBoard:{mcdBulletinBoardGet:"/plan-svc/mcdBulletinBoard",mcdBulletinBoardPost:"/plan-svc/mcdBulletinBoard",mcdBulletinBoardPut:"/plan-svc/mcdBulletinBoard",mcdBulletinBoardDelete:"/plan-svc/mcdBulletinBoard",deleteImage:"/plan-svc/mcdBulletinBoard/deleteImage",downloadImage:"/plan-svc/mcdBulletinBoard/downloadImage",modifyBulletinStatus:"/plan-svc/mcdBulletinBoard/modifyBulletinStatus",uploadBulletinPictures:"/plan-svc/mcdBulletinBoard/uploadBulletinPictures"},mainPackageConfig:{queryFrontMainOffers:"/plan-svc/mcd/front/mainOfferInfo/queryFrontMainOffers",deleteMainOfferInfo:"/plan-svc/mcd/front/mainOfferInfo/deleteMainOfferInfo",getMainOfferInfoDetail:"/plan-svc/mcd/front/mainOfferInfo/getMainOfferInfoDetail",saveOrUpdateMainOffer:"/plan-svc/mcd/front/mainOfferInfo/saveOrUpdateMainOffer",updateMainOfferInfoStatus:"/plan-svc/mcd/front/mainOfferInfo/updateMainOfferInfoStatus"},keyMonitoring:{queryFrontKeyMonitors:"/plan-svc/mcd/front/keyMonitor/queryFrontKeyMonitors"}}},"8d32":function(e,a,t){"use strict";t("7953")},"9de2":function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e._self._c;return a("div",{staticClass:"clientele-content"},[a("el-tabs",{attrs:{type:"card"},model:{value:e.tabActive,callback:function(a){e.tabActive=a},expression:"tabActive"}},[a("el-tab-pane",{attrs:{label:"问题反馈",name:"ProblemFeedback",lazy:!0}},[a("ProblemFeedback")],1)],1)],1)},l=[],r=function(){var e=this,a=e._self._c;return a("div",{staticClass:"template-wrap-content"},[a("div",{staticClass:"top-edit-part"},[a("div",{staticClass:"search-input"},[a("label",[e._v("用户姓名：")]),a("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],attrs:{placeholder:"请输入用户名称",clearable:""},model:{value:e.searchParams.staffName,callback:function(a){e.$set(e.searchParams,"staffName","string"===typeof a?a.trim():a)},expression:"searchParams.staffName"}})],1),a("div",{staticClass:"search-input"},[a("label",[e._v("手机号码：")]),a("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],attrs:{placeholder:"请输入手机号码",clearable:""},on:{input:e.toNum},model:{value:e.searchParams.managerProductNo,callback:function(a){e.$set(e.searchParams,"managerProductNo","string"===typeof a?a.trim():a)},expression:"searchParams.managerProductNo"}})],1),a("div",{staticClass:"search-input"},[a("label",[e._v("工号：")]),a("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],attrs:{placeholder:"请输入工号",clearable:""},model:{value:e.searchParams.managerId,callback:function(a){e.$set(e.searchParams,"managerId","string"===typeof a?a.trim():a)},expression:"searchParams.managerId"}})],1),a("div",{staticClass:"search-input"},[a("label",[e._v("业务编号：")]),a("el-input",{directives:[{name:"clear-emoij",rawName:"v-clear-emoij"}],attrs:{placeholder:"请输入业务编号",clearable:""},model:{value:e.searchParams.businessId,callback:function(a){e.$set(e.searchParams,"businessId","string"===typeof a?a.trim():a)},expression:"searchParams.businessId"}})],1)]),a("div",{staticClass:"top-edit-part"},[a("div",{staticClass:"search-input"},[a("label",[e._v("反馈类型：")]),a("el-select",{attrs:{clearable:""},model:{value:e.searchParams.feedbackType,callback:function(a){e.$set(e.searchParams,"feedbackType",a)},expression:"searchParams.feedbackType"}},[a("el-option",{attrs:{label:"其他",value:"0"}}),a("el-option",{attrs:{label:"功能异常",value:"1"}}),a("el-option",{attrs:{label:"产品建议",value:"2"}})],1)],1),a("div",{staticClass:"search-input"},[a("label",[e._v("创建时间：")]),a("el-date-picker",{staticStyle:{width:"215px"},attrs:{type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd"},on:{change:e.getDatesCreate},model:{value:e.queryTime1,callback:function(a){e.queryTime1=a},expression:"queryTime1"}})],1),a("div",{staticClass:"search-input"},[a("label",{staticStyle:{width:"100px","margin-left":"16px"}},[e._v("最新回复时间：")]),a("el-date-picker",{staticStyle:{width:"215px"},attrs:{type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd"},on:{change:e.getDatesNew},model:{value:e.queryTime2,callback:function(a){e.queryTime2=a},expression:"queryTime2"}})],1),a("div",{staticClass:"btn-search"},[a("el-button",{attrs:{type:"primary"},on:{click:e.searchTable}},[e._v("查询")]),a("el-button",{attrs:{type:"success"},on:{click:e.resetQuery}},[e._v("重置")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tTable",staticClass:"template-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",height:600}},[a("el-table-column",{attrs:{type:"index",label:"序号","header-align":"center",align:"center",width:"45"}}),a("el-table-column",{attrs:{prop:"businessId",label:"业务编号","header-align":"center",align:"center"}}),a("el-table-column",{attrs:{prop:"staffName",label:"用户名","header-align":"center",align:"center"}}),a("el-table-column",{attrs:{prop:"managerProductNo",label:"手机号","header-align":"center",align:"center"}}),a("el-table-column",{attrs:{prop:"managerId",label:"工号","header-align":"center",align:"center"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间","header-align":"center",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"feedbackType",label:"问题类型","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.feedbackType?a("span",[e._v("其他")]):e._e(),1==t.row.feedbackType?a("span",[e._v("功能异常")]):e._e(),2==t.row.feedbackType?a("span",[e._v("产品建议")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"feedbackDescription",label:"问题内容","header-align":"center",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"qaContent",label:"最新回复","header-align":"center",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"answerTime",label:"最新回复时间","header-align":"center",align:"center","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"操作","header-align":"center",align:"center",width:"60",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.openDialog(t.row)}}},[e._v(" 回复 ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.query.pageNum,"page-sizes":[10,20,30,40],"page-size":e.query.pageSize,"pager-count":5,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e.dialogVisible?a("el-dialog",{attrs:{title:"问题反馈",top:"3vh",visible:e.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(a){e.dialogVisible=a}}},[a("ChatFrame",{attrs:{businessId:e.currentRow.businessId},on:{refresh:e.updateReply}})],1):e._e()],1)},n=[],i=t("0fea"),c=t("89ff"),o=function(){var e=this,a=e._self._c;return a("section",{staticClass:"chat-wrap-container"},[a("main",{directives:[{name:"scroll-bottom",rawName:"v-scroll-bottom"}]},[a("div",{staticClass:"top-question"},[a("span",[e._v("反馈内容：")]),a("span",[e._v(e._s(e.questionInfo.feedbackDescription))]),a("br"),e._l(e.questionInfo.imgList,(function(e){return a("span",[a("el-image",{staticStyle:{width:"100px",height:"100px",margin:"10px"},attrs:{src:e.imgUrl,"preview-src-list":[e.imgUrl],fit:"fill"}})],1)}))],2),a("hr"),e._l(e.answerList,(function(t){return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading&&0==e.answerList.length,expression:"loading && answerList.length == 0"}],staticClass:"question-item",class:t.createBy==e.userName?"answer-item":""},[a("el-avatar",{attrs:{size:"medium",src:e.circleUrl}}),a("div",{staticClass:"question-content"},[a("div",{class:0==t.qaMsgType?"text":"img"},[t.sendStatus?a("span",{staticClass:"status"},["sending"===t.sendStatus?a("i",{staticClass:"el-icon-loading"}):e._e(),"fail"===t.sendStatus?a("i",{staticClass:"el-icon-warning",attrs:{title:"发送失败，点击重发"},on:{click:function(a){return e.sendMsg(t)}}}):e._e()]):e._e(),0==t.qaMsgType?a("span",[e._v(e._s(t.qaContent))]):a("el-image",{attrs:{src:t.imgUrl,"preview-src-list":[t.imgUrl]}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])])],1),a("div",{staticClass:"time"},[e.userName!=t.createBy?a("span",{staticClass:"createBy"},[e._v(e._s(t.createUsername))]):e._e(),e._v(e._s(t.createTime)+" ")])])],1)})),e.answerList.length<e.total&&e.showMore?a("div",{staticClass:"load-more",on:{click:e.loadMore}},[a("span",[e._v("加载更多")]),e.loading?a("i",{staticClass:"el-icon-loading"}):a("i",{staticClass:"el-icon-arrow-down"})]):e._e()],2),a("footer",[a("el-input",{attrs:{type:"textarea",size:"small",resize:"none",placeholder:"请输入...",autosize:{maxRows:4}},nativeOn:{"!paste":function(a){return a.preventDefault(),e.pasting.apply(null,arguments)}},model:{value:e.textMsg,callback:function(a){e.textMsg=a},expression:"textMsg"}}),a("div",{staticClass:"btn"},[a("input",{ref:"uploadLink",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.sendImg}}),a("i",{staticClass:"el-icon-picture",on:{click:e.importFile_}}),a("el-button",{attrs:{type:"primary",disabled:!e.textMsg.length},on:{click:e.sendMsg}},[e._v("发送")])],1)],1)])},p=[],d=(t("88a7"),t("271a"),t("5494"),t("14d9"),{name:"ChartFrame",props:["businessId"],data(){return{userName:sessionStorage.getItem("userId"),loading:!1,circleUrl:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",textMsg:"",page:{pageNum:1,pageSize:10},questionInfo:{},answerList:[],total:0,showMore:!0}},directives:{"scroll-bottom":{inserted(e){e.scrollHeight>e.clientHeight&&(e.scrollTop=e.scrollHeight-e.clientHeight)},componentUpdated(e){e.scrollHeight>e.clientHeight&&(e.scrollTop=e.scrollHeight-e.clientHeight)}}},methods:{async getQuestion(){try{const e=await Object(i["g"])(c["a"].problemFeedback.mcdManagerFeedback,{businessId:this.businessId});let a=JSON.parse(e.pictireInfo)||[],t=a.map(e=>({imgName:e.picFileName,imgUrl:""}));this.questionInfo={...e,imgList:t},t.length&&t.forEach(e=>{Object(i["d"])(c["a"].problemFeedback.downloadImage+"/"+e.imgName).then(({data:a})=>{const t=window.URL.createObjectURL(new Blob([a]));this.$nextTick(()=>{e.imgUrl=t,this.$forceUpdate()})}).catch(()=>{})})}catch(e){}},async getApply(){try{this.loading=!0;const{records:e,total:a}=await Object(i["g"])(c["a"].problemFeedback.getAllRepliesByBusinessId,{...this.page,businessId:this.businessId});e.forEach(e=>{this.answerList.push({...e,id:Math.random()+e.createTime}),1==e.qaMsgType&&this.showImg(e.qaContent,this.answerList.length-1)}),this.total=a}catch(e){}finally{this.loading=!1}},showImg(e,a){Object(i["d"])(c["a"].problemFeedback.downloadImage+"/"+e).then(({data:e})=>{const t=window.URL.createObjectURL(new Blob([e]));this.$nextTick(()=>{this.$set(this.answerList[a],"imgUrl",t)})}).catch(e=>{})},loadMore(){this.page.pageNum++,this.getApply()},async sendMsg(e){let a,t;if(this.showMore=!1,e&&e.id)e.sendStatus="sending",e.createTime=this.$dateFormat(new Date),this.answerList.splice(this.answerList.indexOf(e),1),this.answerList.push(e);else{if(!this.textMsg)return;a=this.textMsg,this.textMsg="",t=(new Date).getTime()+Math.random(),this.answerList.push({id:t,createBy:this.userName,createTime:this.$dateFormat(new Date),sendStatus:"sending",qaMsgType:"0",qaContent:a})}try{await Object(i["i"])(c["a"].problemFeedback.addNewReply,{businessId:this.businessId,qaContent:a,qaMsgType:"0"});let e=this.answerList.find(e=>e.id==t);e.sendStatus="success",this.$emit("refresh",{answerTime:this.$dateFormat(new Date),qaContent:a})}catch(s){let e=this.answerList.find(e=>e.id==t);e&&(e.sendStatus="fail")}},importFile_(){this.$refs.uploadLink.files.length>0&&(this.$refs.uploadLink.value=null),this.$refs.uploadLink.click()},async sendImg(e){let a=e.target.files[0];if(!a)return;if(!/image\/\w+/.test(a.type))return void this.$message.error("请选择图片");if(!/(png|jpg|jpeg)$/.test(a.name))return void this.$message.error("请选择png、jpg、jpeg格式的图片");let t=(new Date).getTime()+Math.random(),s=new FileReader;s.readAsDataURL(a),s.onload=e=>{this.answerList.push({id:t,createTime:this.$dateFormat(new Date),createBy:this.userName,imgUrl:e.target.result,type:"answer",sendStatus:"sending",qaMsgType:"1"})};try{let e=new FormData;e.append("pictureFile",a);await Object(i["i"])(c["a"].problemFeedback.addNewReplyPicture+"?businessId="+this.businessId,e);let s=this.answerList.find(e=>e.id==t);s.sendStatus="success",this.$emit("refresh",{answerTime:this.$dateFormat(new Date),qaContent:a.name})}catch(l){let e=this.answerList.find(e=>e.id==t);e&&(e.sendStatus="fail")}finally{this.$refs.uploadLink.value=null}},pasting(e){let a=e.clipboardData.getData("Text");"string"==typeof a&&(this.textMsg+=a);let t=null;const s=(e.clipboardData||window.clipboardData).items;if(s.length)for(let l=0;l<s.length;l++)if(-1!==s[l].type.indexOf("image")){t=s[l].getAsFile();let e=new FileReader;e.readAsDataURL(t),e.onload=e=>{this.sendImg({target:{files:[t]}})};break}}},created(){this.getQuestion(),this.getApply()}}),m=d,u=(t("004ef"),t("2877")),h=Object(u["a"])(m,o,p,!1,null,"60f1c2da",null),g=h.exports,f={components:{ChatFrame:g},data(){return{loading:!1,exportLoading:!1,uploadLoading:!1,searchParams:{createTimeStart:"",createTimeEnd:"",answerTimeStart:"",answerTimeEnd:"",staffName:"",managerProductNo:"",managerId:"",businessId:"",feedbackType:""},query:{pageNum:1,pageSize:10},queryTime1:null,queryTime2:null,total:0,tableData:[],dialogVisible:!1,currentRow:{}}},methods:{getDatesCreate(){this.queryTime1?(this.searchParams.createTimeStart=this.queryTime1[0]+" 00:00:00",this.searchParams.createTimeEnd=this.queryTime1[1]+" 23:59:59"):(this.searchParams.createTimeStart="",this.searchParams.createTimeEnd="")},getDatesNew(){this.queryTime2?(this.searchParams.answerTimeStart=this.queryTime2[0]+" 00:00:00",this.searchParams.answerTimeEnd=this.queryTime2[1]+" 23:59:59"):(this.searchParams.answerTimeStart="",this.searchParams.answerTimeEnd="")},toNum(e){if(this.searchParams.managerProductNo=e.replace(/^(0+)|[^\d]+/g,""),11===this.searchParams.managerProductNo.length&&!/^1[3456789]\d{9}$/.test(this.searchParams.managerProductNo))return this.$message.error("请输入正确手机号"),!1;this.searchParams.managerProductNo.length>11&&(this.searchParams.managerProductNo=this.searchParams.managerProductNo.slice(0,11))},resetQuery(){this.query={pageNum:1,pageSize:10},this.queryTime1=null,this.queryTime2=null,this.searchParams={createTimeStart:"",createTimeEnd:"",answerTimeStart:"",answerTimeEnd:"",staffName:"",managerProductNo:"",managerId:"",businessId:"",feedbackType:"0"},this.getTableData()},searchTable(){this.query={...this.query,...this.searchParams},this.query.pageNum=1,this.getTableData()},async getTableData(){try{this.loading=!0;const{records:e,total:a}=await Object(i["g"])(c["a"].problemFeedback.getRecentlyReplyFeedback,this.query);this.tableData=e,this.total=a}catch(e){}finally{this.loading=!1}},handleSizeChange(e){this.query.pageNum=1,this.query.pageSize=e,this.getTableData()},handleCurrentChange(e){this.query.pageNum=e,this.getTableData()},openDialog(e){this.currentRow=e,this.dialogVisible=!0},updateReply(e){this.$set(this.currentRow,"qaContent",e.qaContent),this.$set(this.currentRow,"answerTime",e.answerTime)}},created(){this.searchTable()}},b=f,v=(t("8d32"),Object(u["a"])(b,r,n,!1,null,"36d9a914",null)),y=v.exports,C={components:{ProblemFeedback:y},data(){return{tabActive:"ProblemFeedback"}}},w=C,k=(t("66c3"),Object(u["a"])(w,s,l,!1,null,"12d824c6",null));a["default"]=k.exports},d6d6:function(e,a,t){"use strict";var s=TypeError;e.exports=function(e,a){if(e<a)throw new s("Not enough arguments");return e}},eb14:function(e,a,t){},edd0:function(e,a,t){"use strict";var s=t("13d2"),l=t("9bf2");e.exports=function(e,a,t){return t.get&&s(t.get,a,{getter:!0}),t.set&&s(t.set,a,{setter:!0}),l.f(e,a,t)}}}]);